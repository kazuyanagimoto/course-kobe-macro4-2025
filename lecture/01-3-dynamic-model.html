<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.26">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="柳本和春">
<meta name="dcterms.date" content="2025-10-20">

<title>動学モデルの基礎 – Family Macroeconomics</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js" integrity="sha384-ZvpUoO/+PpLXR1lu4jmpXWu80pZlYUAfxl5NsBMWOEPSjUn/6Z/hRTt8+pR6L4N2" crossorigin="anonymous"></script><script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../static/img/logo.drawio.svg" rel="icon" type="image/svg+xml">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-d1f10ae5b1bd2fcd88626ad4c33800b6.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark-a5387b16c79744f55f942101f6586ee8.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-d1f10ae5b1bd2fcd88626ad4c33800b6.css" rel="stylesheet" class="quarto-color-scheme-extra" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-29a9cb4b6e38590d1988549b314d426b.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark-2481093b93c3456eab0eea680925ecdf.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-29a9cb4b6e38590d1988549b314d426b.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme-extra" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdn.jsdelivr.net/npm/requirejs@2.3.6/require.min.js" integrity="sha384-c9c+LnTbwQ3aujuU7ULEPVvgLs+Fn6fJUvIGTsuu1ZcCf11fiEubah0ttpca4ntM sha384-6V1/AdqZRWk1KAlWbKBlGhN7VG4iE/yAZcO6NZPMF8od0vukrvr0tg4qY6NSrItx" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<meta property="og:title" content="動学モデルの基礎 – Family Macroeconomics">
<meta property="og:description" content="">
<meta property="og:image" content="https://kazuyanagimoto.github.io/course-kobe-macro4-2025/lecture/static/img/sns-card.drawio.png">
<meta property="og:site_name" content="Family Macroeconomics">
<meta property="og:locale" content="ja_JP">
<meta name="twitter:title" content="動学モデルの基礎 – Family Macroeconomics">
<meta name="twitter:description" content="">
<meta name="twitter:image" content="https://kazuyanagimoto.github.io/course-kobe-macro4-2025/lecture/static/img/sns-card.drawio.png">
<meta name="twitter:creator" content="@kazuyanagimoto">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Family Macroeconomics</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../lecture.html"> 
<span class="menu-text">Materials</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/kazuyanagimoto/course-kobe-macro4-2025"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#グリッドと補完" id="toc-グリッドと補完" class="nav-link active" data-scroll-target="#グリッドと補完">グリッドと補完</a></li>
  <li><a href="#ベルマン方程式の数値解法" id="toc-ベルマン方程式の数値解法" class="nav-link" data-scroll-target="#ベルマン方程式の数値解法">ベルマン方程式の数値解法</a>
  <ul class="collapse">
  <li><a href="#value-function-iteration" id="toc-value-function-iteration" class="nav-link" data-scroll-target="#value-function-iteration">Value Function Iteration</a></li>
  <li><a href="#policy-function-iteration" id="toc-policy-function-iteration" class="nav-link" data-scroll-target="#policy-function-iteration">Policy Function Iteration</a></li>
  </ul></li>
  <li><a href="#確率的動学モデル" id="toc-確率的動学モデル" class="nav-link" data-scroll-target="#確率的動学モデル">確率的動学モデル</a>
  <ul class="collapse">
  <li><a href="#tauchen-method" id="toc-tauchen-method" class="nav-link" data-scroll-target="#tauchen-method">Tauchen Method</a></li>
  <li><a href="#value-function-iteration-2" id="toc-value-function-iteration-2" class="nav-link" data-scroll-target="#value-function-iteration-2">Value Function Iteration</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">動学モデルの基礎</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>


<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Author</div>
  <div class="quarto-title-meta-heading">Affiliation</div>
  
    <div class="quarto-title-meta-contents">
    <p class="author">柳本和春 <a href="mailto:yanagimoto@econ.kobe-u.ac.jp" class="quarto-title-author-email"><i class="bi bi-envelope"></i></a> <a href="https://orcid.org/0009-0007-1967-8304" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a></p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            神戸大学
          </p>
      </div>
  </div>

<div class="quarto-title-meta">

      
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">October 20, 2025</p>
    </div>
  </div>
  
    <div>
    <div class="quarto-title-meta-heading">Modified</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">January 16, 2026</p>
    </div>
  </div>
    
  </div>
  


</header>


<div id="setup" class="cell" data-execution_count="1">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Plots</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">LaTeXStrings</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Distributions</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> <span class="bu">Random</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Roots</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Optim</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">LinearAlgebra</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Interpolations</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">SpecialFunctions</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">default</span>(size<span class="op">=</span>(<span class="fl">500</span>, <span class="fl">309</span>), titlefontsize<span class="op">=</span><span class="fl">10</span>, fmt<span class="op">=:</span>svg)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<section id="グリッドと補完" class="level2">
<h2 class="anchored" data-anchor-id="グリッドと補完">グリッドと補完</h2>
<p>未知なる関数 <span class="math inline">\(f(x)\)</span> の一般形が分からないが, 具体的な <span class="math inline">\(x\)</span> に関しては <span class="math inline">\(f(x)\)</span> の値が計算できる状況というのがよくあります. ちょっと極端な例を考えてみましょう. 次の効用最大化問題を考えます.</p>
<p><span class="math display">\[
\max_{n} \log c - \Phi(n) \text{ s.t.　}　c = w n.
\]</span></p>
<p>ここで, 労働供給の不効用 <span class="math inline">\(\Phi(n) = \phi \log (n!)\)</span> とします. この時の最適な <span class="math inline">\(n^*\)</span> を求めてみましょう.</p>
<div id="define-profit-integer" class="cell" data-execution_count="1">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Φ</span>(n<span class="op">::</span><span class="dt">Int</span>; ϕ<span class="op">=</span><span class="fl">0.1</span>) <span class="op">=</span> ϕ <span class="op">*</span> <span class="fu">sum</span>(<span class="fu">log</span>(i) <span class="cf">for</span> i <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span>n)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">u</span>(n<span class="op">::</span><span class="dt">Int</span>; w<span class="op">=</span><span class="fl">1</span>.) <span class="op">=</span> <span class="fu">log</span>(n) <span class="op">-</span> <span class="fu">Φ</span>(n)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p><strong>Grid Search</strong></p>
<p>最も単純な方法は, <span class="math inline">\(n = 1, \dots, 10\)</span> ぐらいまで試してみて, 最も効用 <span class="math inline">\(u(c, n)\)</span> が大きくなる <span class="math inline">\(n\)</span> を選ぶ方法です. これをグリッドサーチと呼びます.</p>
<div id="cell-fig-grid-search" class="cell" data-execution_count="1">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">scatter</span>(<span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, u, label<span class="op">=</span><span class="cn">false</span>, xlabel<span class="op">=</span>L<span class="st">"n"</span>, ylabel<span class="op">=</span>L<span class="st">"u(c, n)"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div id="fig-grid-search" class="cell-output cell-output-display quarto-float quarto-figure quarto-figure-center anchored" data-execution_count="1">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-grid-search-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<!--?xml version="1.0" encoding="utf-8"?-->
<svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" width="500" height="309" viewbox="0 0 2000 1236">
<defs>
  <clippath id="clip840">
    <rect x="0" y="0" width="2000" height="1236"></rect>
  </clippath>
</defs>
<path clip-path="url(#clip840)" d="M0 1236 L2000 1236 L2000 1.24345e-14 L0 1.24345e-14  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<defs>
  <clippath id="clip841">
    <rect x="400" y="0" width="1401" height="1236"></rect>
  </clippath>
</defs>
<path clip-path="url(#clip840)" d="M242.073 1068.81 L1952.76 1068.81 L1952.76 47.2441 L242.073 47.2441  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<defs>
  <clippath id="clip842">
    <rect x="242" y="47" width="1712" height="1023"></rect>
  </clippath>
</defs>
<polyline clip-path="url(#clip842)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="469.805,1068.81 469.805,47.2441 "></polyline>
<polyline clip-path="url(#clip842)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="828.439,1068.81 828.439,47.2441 "></polyline>
<polyline clip-path="url(#clip842)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1187.07,1068.81 1187.07,47.2441 "></polyline>
<polyline clip-path="url(#clip842)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1545.71,1068.81 1545.71,47.2441 "></polyline>
<polyline clip-path="url(#clip842)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1904.34,1068.81 1904.34,47.2441 "></polyline>
<polyline clip-path="url(#clip842)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="242.073,1039.9 1952.76,1039.9 "></polyline>
<polyline clip-path="url(#clip842)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="242.073,827.403 1952.76,827.403 "></polyline>
<polyline clip-path="url(#clip842)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="242.073,614.907 1952.76,614.907 "></polyline>
<polyline clip-path="url(#clip842)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="242.073,402.41 1952.76,402.41 "></polyline>
<polyline clip-path="url(#clip842)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="242.073,189.914 1952.76,189.914 "></polyline>
<polyline clip-path="url(#clip840)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="242.073,1068.81 1952.76,1068.81 "></polyline>
<polyline clip-path="url(#clip840)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="469.805,1068.81 469.805,1049.91 "></polyline>
<polyline clip-path="url(#clip840)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="828.439,1068.81 828.439,1049.91 "></polyline>
<polyline clip-path="url(#clip840)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1187.07,1068.81 1187.07,1049.91 "></polyline>
<polyline clip-path="url(#clip840)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1545.71,1068.81 1545.71,1049.91 "></polyline>
<polyline clip-path="url(#clip840)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1904.34,1068.81 1904.34,1049.91 "></polyline>
<path clip-path="url(#clip840)" d="M464.458 1124.08 L480.778 1124.08 L480.778 1128.01 L458.833 1128.01 L458.833 1124.08 Q461.495 1121.32 466.079 1116.69 Q470.685 1112.04 471.866 1110.7 Q474.111 1108.17 474.991 1106.44 Q475.893 1104.68 475.893 1102.99 Q475.893 1100.23 473.949 1098.5 Q472.028 1096.76 468.926 1096.76 Q466.727 1096.76 464.273 1097.53 Q461.843 1098.29 459.065 1099.84 L459.065 1095.12 Q461.889 1093.98 464.343 1093.41 Q466.796 1092.83 468.833 1092.83 Q474.204 1092.83 477.398 1095.51 Q480.592 1098.2 480.592 1102.69 Q480.592 1104.82 479.782 1106.74 Q478.995 1108.64 476.889 1111.23 Q476.31 1111.9 473.208 1115.12 Q470.106 1118.31 464.458 1124.08 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip840)" d="M831.448 1097.53 L819.643 1115.97 L831.448 1115.97 L831.448 1097.53 M830.222 1093.45 L836.101 1093.45 L836.101 1115.97 L841.032 1115.97 L841.032 1119.86 L836.101 1119.86 L836.101 1128.01 L831.448 1128.01 L831.448 1119.86 L815.847 1119.86 L815.847 1115.35 L830.222 1093.45 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip840)" d="M1187.48 1108.87 Q1184.33 1108.87 1182.48 1111.02 Q1180.65 1113.17 1180.65 1116.92 Q1180.65 1120.65 1182.48 1122.83 Q1184.33 1124.98 1187.48 1124.98 Q1190.63 1124.98 1192.45 1122.83 Q1194.31 1120.65 1194.31 1116.92 Q1194.31 1113.17 1192.45 1111.02 Q1190.63 1108.87 1187.48 1108.87 M1196.76 1094.22 L1196.76 1098.47 Q1195 1097.64 1193.2 1097.2 Q1191.41 1096.76 1189.65 1096.76 Q1185.02 1096.76 1182.57 1099.89 Q1180.14 1103.01 1179.79 1109.33 Q1181.16 1107.32 1183.22 1106.25 Q1185.28 1105.16 1187.76 1105.16 Q1192.96 1105.16 1195.97 1108.34 Q1199.01 1111.48 1199.01 1116.92 Q1199.01 1122.25 1195.86 1125.47 Q1192.71 1128.68 1187.48 1128.68 Q1181.48 1128.68 1178.31 1124.1 Q1175.14 1119.49 1175.14 1110.77 Q1175.14 1102.57 1179.03 1097.71 Q1182.92 1092.83 1189.47 1092.83 Q1191.23 1092.83 1193.01 1093.17 Q1194.82 1093.52 1196.76 1094.22 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip840)" d="M1545.71 1111.6 Q1542.37 1111.6 1540.45 1113.38 Q1538.55 1115.16 1538.55 1118.29 Q1538.55 1121.41 1540.45 1123.2 Q1542.37 1124.98 1545.71 1124.98 Q1549.04 1124.98 1550.96 1123.2 Q1552.88 1121.39 1552.88 1118.29 Q1552.88 1115.16 1550.96 1113.38 Q1549.06 1111.6 1545.71 1111.6 M1541.03 1109.61 Q1538.02 1108.87 1536.33 1106.81 Q1534.67 1104.75 1534.67 1101.78 Q1534.67 1097.64 1537.6 1095.23 Q1540.57 1092.83 1545.71 1092.83 Q1550.87 1092.83 1553.81 1095.23 Q1556.75 1097.64 1556.75 1101.78 Q1556.75 1104.75 1555.06 1106.81 Q1553.39 1108.87 1550.41 1109.61 Q1553.79 1110.4 1555.66 1112.69 Q1557.56 1114.98 1557.56 1118.29 Q1557.56 1123.31 1554.48 1126 Q1551.42 1128.68 1545.71 1128.68 Q1539.99 1128.68 1536.91 1126 Q1533.85 1123.31 1533.85 1118.29 Q1533.85 1114.98 1535.75 1112.69 Q1537.65 1110.4 1541.03 1109.61 M1539.32 1102.22 Q1539.32 1104.91 1540.98 1106.41 Q1542.67 1107.92 1545.71 1107.92 Q1548.72 1107.92 1550.41 1106.41 Q1552.12 1104.91 1552.12 1102.22 Q1552.12 1099.54 1550.41 1098.03 Q1548.72 1096.53 1545.71 1096.53 Q1542.67 1096.53 1540.98 1098.03 Q1539.32 1099.54 1539.32 1102.22 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip840)" d="M1879.03 1124.08 L1886.67 1124.08 L1886.67 1097.71 L1878.36 1099.38 L1878.36 1095.12 L1886.62 1093.45 L1891.3 1093.45 L1891.3 1124.08 L1898.94 1124.08 L1898.94 1128.01 L1879.03 1128.01 L1879.03 1124.08 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip840)" d="M1918.38 1096.53 Q1914.77 1096.53 1912.94 1100.1 Q1911.13 1103.64 1911.13 1110.77 Q1911.13 1117.87 1912.94 1121.44 Q1914.77 1124.98 1918.38 1124.98 Q1922.01 1124.98 1923.82 1121.44 Q1925.65 1117.87 1925.65 1110.77 Q1925.65 1103.64 1923.82 1100.1 Q1922.01 1096.53 1918.38 1096.53 M1918.38 1092.83 Q1924.19 1092.83 1927.25 1097.43 Q1930.32 1102.02 1930.32 1110.77 Q1930.32 1119.49 1927.25 1124.1 Q1924.19 1128.68 1918.38 1128.68 Q1912.57 1128.68 1909.49 1124.1 Q1906.44 1119.49 1906.44 1110.77 Q1906.44 1102.02 1909.49 1097.43 Q1912.57 1092.83 1918.38 1092.83 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip840)" d="M1113.58 1183.8 Q1113.58 1184.05 1113.29 1185.05 Q1113 1186.05 1112.29 1187.6 Q1111.61 1189.14 1110.68 1190.56 Q1109.75 1191.94 1108.2 1192.98 Q1106.69 1193.97 1104.95 1193.97 Q1102.63 1193.97 1101.08 1192.43 Q1099.54 1190.88 1099.54 1188.56 Q1099.54 1187.27 1100.21 1185.5 Q1104.5 1174.07 1104.5 1170.14 Q1104.5 1165.54 1100.92 1165.54 Q1099.15 1165.54 1097.48 1166.21 Q1095.83 1166.86 1094.71 1167.76 Q1093.58 1168.66 1092.55 1169.92 Q1091.55 1171.14 1091.03 1171.98 Q1090.55 1172.78 1090.16 1173.59 L1089.33 1176.87 Q1089.13 1177.77 1088.2 1181.28 L1086.75 1187.24 Q1085.72 1191.69 1085.49 1192.11 Q1085.17 1193.01 1084.46 1193.49 Q1083.76 1193.97 1083.05 1193.97 Q1082.24 1193.97 1081.69 1193.49 Q1081.15 1193.01 1081.15 1192.17 Q1081.15 1192.04 1081.24 1191.56 Q1081.34 1191.07 1081.5 1190.4 Q1081.66 1189.72 1081.73 1189.34 L1085.56 1174.1 Q1086.27 1171.33 1086.43 1170.46 Q1086.62 1169.56 1086.62 1168.56 Q1086.62 1165.54 1084.56 1165.54 Q1082.89 1165.54 1081.79 1167.53 Q1080.7 1169.53 1079.76 1173.39 Q1079.47 1174.46 1079.28 1174.68 Q1079.12 1174.91 1078.63 1174.91 Q1077.83 1174.88 1077.83 1174.23 Q1077.83 1174.07 1078.09 1173.01 Q1078.34 1171.94 1078.83 1170.43 Q1079.34 1168.89 1079.83 1167.85 Q1080.25 1167.08 1080.47 1166.73 Q1080.73 1166.34 1081.34 1165.6 Q1081.98 1164.83 1082.82 1164.47 Q1083.69 1164.09 1084.75 1164.09 Q1087.14 1164.09 1088.88 1165.63 Q1090.62 1167.15 1090.84 1169.82 Q1095.12 1164.09 1101.11 1164.09 Q1104.66 1164.09 1106.69 1165.95 Q1108.72 1167.82 1108.72 1171.14 Q1108.72 1171.91 1108.55 1172.91 Q1108.43 1173.88 1108.1 1175.1 Q1107.81 1176.32 1107.56 1177.26 Q1107.3 1178.19 1106.78 1179.71 Q1106.27 1181.19 1106.04 1181.83 Q1105.82 1182.48 1105.27 1183.99 Q1104.75 1185.47 1104.69 1185.63 Q1103.5 1188.63 1103.5 1190.33 Q1103.5 1191.46 1103.85 1191.98 Q1104.24 1192.49 1105.08 1192.49 Q1107.33 1192.49 1109 1190.27 Q1110.71 1188.02 1111.81 1184.34 Q1112.06 1183.54 1112.19 1183.35 Q1112.35 1183.15 1112.81 1183.15 Q1113.58 1183.15 1113.58 1183.8 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip840)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="242.073,1068.81 242.073,47.2441 "></polyline>
<polyline clip-path="url(#clip840)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="242.073,1039.9 260.971,1039.9 "></polyline>
<polyline clip-path="url(#clip840)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="242.073,827.403 260.971,827.403 "></polyline>
<polyline clip-path="url(#clip840)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="242.073,614.907 260.971,614.907 "></polyline>
<polyline clip-path="url(#clip840)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="242.073,402.41 260.971,402.41 "></polyline>
<polyline clip-path="url(#clip840)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="242.073,189.914 260.971,189.914 "></polyline>
<path clip-path="url(#clip840)" d="M124.736 1025.7 Q121.124 1025.7 119.296 1029.26 Q117.49 1032.8 117.49 1039.93 Q117.49 1047.04 119.296 1050.61 Q121.124 1054.15 124.736 1054.15 Q128.37 1054.15 130.175 1050.61 Q132.004 1047.04 132.004 1039.93 Q132.004 1032.8 130.175 1029.26 Q128.37 1025.7 124.736 1025.7 M124.736 1021.99 Q130.546 1021.99 133.601 1026.6 Q136.68 1031.18 136.68 1039.93 Q136.68 1048.66 133.601 1053.27 Q130.546 1057.85 124.736 1057.85 Q118.925 1057.85 115.847 1053.27 Q112.791 1048.66 112.791 1039.93 Q112.791 1031.18 115.847 1026.6 Q118.925 1021.99 124.736 1021.99 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip840)" d="M144.898 1051.3 L149.782 1051.3 L149.782 1057.18 L144.898 1057.18 L144.898 1051.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip840)" d="M169.967 1025.7 Q166.356 1025.7 164.527 1029.26 Q162.721 1032.8 162.721 1039.93 Q162.721 1047.04 164.527 1050.61 Q166.356 1054.15 169.967 1054.15 Q173.601 1054.15 175.407 1050.61 Q177.235 1047.04 177.235 1039.93 Q177.235 1032.8 175.407 1029.26 Q173.601 1025.7 169.967 1025.7 M169.967 1021.99 Q175.777 1021.99 178.833 1026.6 Q181.911 1031.18 181.911 1039.93 Q181.911 1048.66 178.833 1053.27 Q175.777 1057.85 169.967 1057.85 Q164.157 1057.85 161.078 1053.27 Q158.022 1048.66 158.022 1039.93 Q158.022 1031.18 161.078 1026.6 Q164.157 1021.99 169.967 1021.99 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip840)" d="M200.129 1025.7 Q196.518 1025.7 194.689 1029.26 Q192.883 1032.8 192.883 1039.93 Q192.883 1047.04 194.689 1050.61 Q196.518 1054.15 200.129 1054.15 Q203.763 1054.15 205.568 1050.61 Q207.397 1047.04 207.397 1039.93 Q207.397 1032.8 205.568 1029.26 Q203.763 1025.7 200.129 1025.7 M200.129 1021.99 Q205.939 1021.99 208.994 1026.6 Q212.073 1031.18 212.073 1039.93 Q212.073 1048.66 208.994 1053.27 Q205.939 1057.85 200.129 1057.85 Q194.319 1057.85 191.24 1053.27 Q188.184 1048.66 188.184 1039.93 Q188.184 1031.18 191.24 1026.6 Q194.319 1021.99 200.129 1021.99 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip840)" d="M125.731 813.202 Q122.12 813.202 120.291 816.766 Q118.486 820.308 118.486 827.438 Q118.486 834.544 120.291 838.109 Q122.12 841.651 125.731 841.651 Q129.365 841.651 131.171 838.109 Q132.999 834.544 132.999 827.438 Q132.999 820.308 131.171 816.766 Q129.365 813.202 125.731 813.202 M125.731 809.498 Q131.541 809.498 134.597 814.104 Q137.675 818.688 137.675 827.438 Q137.675 836.164 134.597 840.771 Q131.541 845.354 125.731 845.354 Q119.921 845.354 116.842 840.771 Q113.787 836.164 113.787 827.438 Q113.787 818.688 116.842 814.104 Q119.921 809.498 125.731 809.498 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip840)" d="M145.893 838.803 L150.777 838.803 L150.777 844.683 L145.893 844.683 L145.893 838.803 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip840)" d="M164.99 840.748 L181.309 840.748 L181.309 844.683 L159.365 844.683 L159.365 840.748 Q162.027 837.993 166.61 833.364 Q171.217 828.711 172.397 827.368 Q174.643 824.845 175.522 823.109 Q176.425 821.35 176.425 819.66 Q176.425 816.905 174.481 815.169 Q172.559 813.433 169.458 813.433 Q167.258 813.433 164.805 814.197 Q162.374 814.961 159.597 816.512 L159.597 811.79 Q162.421 810.655 164.874 810.077 Q167.328 809.498 169.365 809.498 Q174.735 809.498 177.93 812.183 Q181.124 814.868 181.124 819.359 Q181.124 821.489 180.314 823.41 Q179.527 825.308 177.42 827.901 Q176.842 828.572 173.74 831.79 Q170.638 834.984 164.99 840.748 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip840)" d="M191.17 810.123 L209.527 810.123 L209.527 814.058 L195.453 814.058 L195.453 822.53 Q196.471 822.183 197.49 822.021 Q198.508 821.836 199.527 821.836 Q205.314 821.836 208.693 825.007 Q212.073 828.178 212.073 833.595 Q212.073 839.174 208.601 842.276 Q205.129 845.354 198.809 845.354 Q196.633 845.354 194.365 844.984 Q192.119 844.614 189.712 843.873 L189.712 839.174 Q191.795 840.308 194.018 840.864 Q196.24 841.419 198.717 841.419 Q202.721 841.419 205.059 839.313 Q207.397 837.206 207.397 833.595 Q207.397 829.984 205.059 827.877 Q202.721 825.771 198.717 825.771 Q196.842 825.771 194.967 826.188 Q193.115 826.604 191.17 827.484 L191.17 810.123 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip840)" d="M124.736 600.705 Q121.124 600.705 119.296 604.27 Q117.49 607.812 117.49 614.941 Q117.49 622.048 119.296 625.612 Q121.124 629.154 124.736 629.154 Q128.37 629.154 130.175 625.612 Q132.004 622.048 132.004 614.941 Q132.004 607.812 130.175 604.27 Q128.37 600.705 124.736 600.705 M124.736 597.002 Q130.546 597.002 133.601 601.608 Q136.68 606.191 136.68 614.941 Q136.68 623.668 133.601 628.275 Q130.546 632.858 124.736 632.858 Q118.925 632.858 115.847 628.275 Q112.791 623.668 112.791 614.941 Q112.791 606.191 115.847 601.608 Q118.925 597.002 124.736 597.002 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip840)" d="M144.898 626.307 L149.782 626.307 L149.782 632.187 L144.898 632.187 L144.898 626.307 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip840)" d="M160.013 597.627 L178.37 597.627 L178.37 601.562 L164.296 601.562 L164.296 610.034 Q165.314 609.687 166.333 609.525 Q167.351 609.339 168.37 609.339 Q174.157 609.339 177.536 612.511 Q180.916 615.682 180.916 621.099 Q180.916 626.677 177.444 629.779 Q173.971 632.858 167.652 632.858 Q165.476 632.858 163.208 632.487 Q160.962 632.117 158.555 631.376 L158.555 626.677 Q160.638 627.812 162.86 628.367 Q165.083 628.923 167.559 628.923 Q171.564 628.923 173.902 626.816 Q176.24 624.71 176.24 621.099 Q176.24 617.488 173.902 615.381 Q171.564 613.275 167.559 613.275 Q165.684 613.275 163.809 613.691 Q161.958 614.108 160.013 614.988 L160.013 597.627 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip840)" d="M200.129 600.705 Q196.518 600.705 194.689 604.27 Q192.883 607.812 192.883 614.941 Q192.883 622.048 194.689 625.612 Q196.518 629.154 200.129 629.154 Q203.763 629.154 205.568 625.612 Q207.397 622.048 207.397 614.941 Q207.397 607.812 205.568 604.27 Q203.763 600.705 200.129 600.705 M200.129 597.002 Q205.939 597.002 208.994 601.608 Q212.073 606.191 212.073 614.941 Q212.073 623.668 208.994 628.275 Q205.939 632.858 200.129 632.858 Q194.319 632.858 191.24 628.275 Q188.184 623.668 188.184 614.941 Q188.184 606.191 191.24 601.608 Q194.319 597.002 200.129 597.002 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip840)" d="M125.731 388.209 Q122.12 388.209 120.291 391.774 Q118.486 395.315 118.486 402.445 Q118.486 409.551 120.291 413.116 Q122.12 416.658 125.731 416.658 Q129.365 416.658 131.171 413.116 Q132.999 409.551 132.999 402.445 Q132.999 395.315 131.171 391.774 Q129.365 388.209 125.731 388.209 M125.731 384.505 Q131.541 384.505 134.597 389.112 Q137.675 393.695 137.675 402.445 Q137.675 411.172 134.597 415.778 Q131.541 420.361 125.731 420.361 Q119.921 420.361 116.842 415.778 Q113.787 411.172 113.787 402.445 Q113.787 393.695 116.842 389.112 Q119.921 384.505 125.731 384.505 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip840)" d="M145.893 413.811 L150.777 413.811 L150.777 419.69 L145.893 419.69 L145.893 413.811 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip840)" d="M159.782 385.13 L182.004 385.13 L182.004 387.121 L169.458 419.69 L164.573 419.69 L176.379 389.065 L159.782 389.065 L159.782 385.13 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip840)" d="M191.17 385.13 L209.527 385.13 L209.527 389.065 L195.453 389.065 L195.453 397.537 Q196.471 397.19 197.49 397.028 Q198.508 396.843 199.527 396.843 Q205.314 396.843 208.693 400.014 Q212.073 403.186 212.073 408.602 Q212.073 414.181 208.601 417.283 Q205.129 420.361 198.809 420.361 Q196.633 420.361 194.365 419.991 Q192.119 419.621 189.712 418.88 L189.712 414.181 Q191.795 415.315 194.018 415.871 Q196.24 416.426 198.717 416.426 Q202.721 416.426 205.059 414.32 Q207.397 412.213 207.397 408.602 Q207.397 404.991 205.059 402.885 Q202.721 400.778 198.717 400.778 Q196.842 400.778 194.967 401.195 Q193.115 401.611 191.17 402.491 L191.17 385.13 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip840)" d="M115.546 203.259 L123.185 203.259 L123.185 176.893 L114.875 178.56 L114.875 174.3 L123.138 172.634 L127.814 172.634 L127.814 203.259 L135.453 203.259 L135.453 207.194 L115.546 207.194 L115.546 203.259 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip840)" d="M144.898 201.314 L149.782 201.314 L149.782 207.194 L144.898 207.194 L144.898 201.314 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip840)" d="M169.967 175.712 Q166.356 175.712 164.527 179.277 Q162.721 182.819 162.721 189.948 Q162.721 197.055 164.527 200.62 Q166.356 204.161 169.967 204.161 Q173.601 204.161 175.407 200.62 Q177.235 197.055 177.235 189.948 Q177.235 182.819 175.407 179.277 Q173.601 175.712 169.967 175.712 M169.967 172.009 Q175.777 172.009 178.833 176.615 Q181.911 181.198 181.911 189.948 Q181.911 198.675 178.833 203.282 Q175.777 207.865 169.967 207.865 Q164.157 207.865 161.078 203.282 Q158.022 198.675 158.022 189.948 Q158.022 181.198 161.078 176.615 Q164.157 172.009 169.967 172.009 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip840)" d="M200.129 175.712 Q196.518 175.712 194.689 179.277 Q192.883 182.819 192.883 189.948 Q192.883 197.055 194.689 200.62 Q196.518 204.161 200.129 204.161 Q203.763 204.161 205.568 200.62 Q207.397 197.055 207.397 189.948 Q207.397 182.819 205.568 179.277 Q203.763 175.712 200.129 175.712 M200.129 172.009 Q205.939 172.009 208.994 176.615 Q212.073 181.198 212.073 189.948 Q212.073 198.675 208.994 203.282 Q205.939 207.865 200.129 207.865 Q194.319 207.865 191.24 203.282 Q188.184 198.675 188.184 189.948 Q188.184 181.198 191.24 176.615 Q194.319 172.009 200.129 172.009 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip840)" d="M61.1775 617.82 Q65.3321 618.658 67.7153 619.785 Q71.3546 621.621 71.3546 624.68 Q71.3546 626.806 70.163 628.416 Q68.9391 629.994 66.9102 630.542 Q67.7153 631.154 68.2628 631.701 Q68.8103 632.216 69.6477 633.215 Q70.4528 634.213 70.9037 635.566 Q71.3546 636.886 71.3546 638.4 Q71.3546 639.559 71.1291 640.622 Q70.9359 641.685 70.3884 642.812 Q69.8087 643.907 68.9391 644.712 Q68.0696 645.485 66.6525 646.001 Q65.2355 646.516 63.4319 646.516 Q61.1775 646.516 58.118 645.646 Q55.0584 644.745 49.5834 642.683 Q46.6849 641.556 45.0746 641.556 Q44.3339 641.556 43.8508 641.717 Q43.3677 641.878 43.2066 642.2 Q43.0134 642.49 42.9812 642.683 Q42.9168 642.877 42.9168 643.199 Q42.9168 645.195 44.9458 646.935 Q46.9747 648.674 51.0971 649.865 Q51.9022 650.123 52.0955 650.284 Q52.2887 650.445 52.2887 650.928 Q52.2565 651.733 51.6124 651.733 Q51.3547 651.733 50.3563 651.443 Q49.3258 651.153 47.8121 650.477 Q46.2662 649.769 44.8813 648.802 Q43.4643 647.836 42.4659 646.323 Q41.4675 644.777 41.4675 643.005 Q41.4675 640.59 43.0456 639.108 Q44.5915 637.595 46.8781 637.595 Q48.2952 637.595 51.0327 638.722 Q60.5334 642.297 64.4947 642.297 Q69.8731 642.297 69.8731 638.207 Q69.8731 636.854 69.3256 635.598 Q68.7781 634.31 68.0052 633.472 Q67.2322 632.635 66.3949 631.991 Q65.5575 631.315 65.01 631.025 Q64.4625 630.703 64.3337 630.671 L44.4949 625.743 Q43.7219 625.55 43.2066 625.196 Q42.6591 624.809 42.4659 624.358 Q42.2727 623.907 42.2405 623.65 Q42.1761 623.392 42.1761 623.167 Q42.1761 622.361 42.6591 621.814 Q43.1422 621.234 43.9796 621.234 Q44.1406 621.234 44.9136 621.427 Q45.6543 621.588 46.7493 621.846 Q47.8121 622.104 48.3918 622.233 Q52.4497 623.263 52.8684 623.36 L59.9859 625.196 Q60.4046 625.292 61.7572 625.614 Q63.1099 625.904 63.8184 626.065 Q64.4947 626.226 65.4287 626.387 Q66.3305 626.516 66.8457 626.516 Q68.456 626.516 69.1646 626.033 Q69.8731 625.55 69.8731 624.487 Q69.8731 623.489 69.1968 622.716 Q68.4882 621.911 67.1356 621.299 Q65.7507 620.687 64.6235 620.332 Q63.4963 619.978 61.725 619.527 Q60.9521 619.366 60.7588 619.237 Q60.5334 619.076 60.5334 618.626 Q60.5334 617.82 61.1775 617.82 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip840)" d="M54.1244 610.158 Q42.9812 610.158 33.9958 606.003 Q30.2277 604.232 27.0715 601.752 Q23.9153 599.272 22.5305 597.629 Q21.1456 595.987 21.1456 595.536 Q21.1456 594.892 21.7897 594.86 Q22.1118 594.86 22.917 595.729 Q33.7381 606.357 54.1244 606.325 Q74.5752 606.325 84.9776 595.987 Q86.1049 594.86 86.4591 594.86 Q87.1032 594.86 87.1032 595.536 Q87.1032 595.987 85.7828 597.565 Q84.4624 599.143 81.435 601.591 Q78.4077 604.038 74.704 605.81 Q65.7185 610.158 54.1244 610.158 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip840)" d="M62.981 563.117 Q63.2709 562.859 63.5607 562.859 Q63.8506 562.859 64.688 563.503 Q65.5253 564.115 66.6525 565.436 Q67.7797 566.756 68.8425 568.463 Q69.9053 570.17 70.6138 572.682 Q71.3546 575.194 71.3546 577.835 Q71.3546 582.762 68.1018 585.661 Q64.849 588.527 60.1791 588.527 Q55.6381 588.527 51.2903 585.983 Q46.9103 583.439 44.205 579.316 Q41.4675 575.194 41.4675 570.846 Q41.4675 567.4 43.0778 565.242 Q44.6881 563.085 47.1358 563.085 Q49.0359 563.085 50.1953 564.18 Q51.3547 565.275 51.3547 566.756 Q51.3547 567.787 50.775 568.495 Q50.1631 569.204 49.0359 569.204 Q47.5866 569.204 46.4594 568.012 Q46.0086 567.561 45.8153 567.046 Q45.5899 566.498 45.5899 566.176 Q45.5577 565.854 45.5577 565.113 Q44.3016 565.79 43.6253 567.4 Q42.9168 568.978 42.9168 570.782 Q42.9168 573.455 44.7847 575.999 Q46.6205 578.543 49.519 580.089 Q52.3531 581.635 56.3788 582.633 Q60.3724 583.632 62.6912 583.632 Q65.8796 583.632 67.8763 582.15 Q69.8731 580.669 69.8731 577.706 Q69.8731 577.126 69.8409 576.514 Q69.8087 575.87 69.4544 574.26 Q69.1002 572.617 68.4882 571.168 Q67.8763 569.719 66.5559 567.883 Q65.2032 566.015 63.3675 564.534 Q62.6912 564.018 62.6912 563.664 Q62.6912 563.374 62.981 563.117 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip840)" d="M69.551 559.332 Q68.4882 560.266 67.1034 560.266 Q65.7185 560.266 64.688 559.364 Q63.6252 558.43 63.6252 556.756 Q63.6252 554.791 65.5253 553.664 Q67.3932 552.537 70.5494 552.537 Q73.9632 552.537 77.1194 553.922 Q80.3078 555.306 81.8215 556.659 Q83.3351 558.012 83.3351 558.559 Q83.3351 559.203 82.6266 559.203 Q82.369 559.203 81.8859 558.753 Q76.7974 554.018 70.5494 553.986 Q69.551 553.986 69.551 554.115 L69.6799 554.276 Q70.6138 555.403 70.6138 556.756 Q70.6138 558.398 69.551 559.332 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip840)" d="M61.1775 495.974 Q61.4352 495.974 62.4335 496.264 Q63.4319 496.554 64.9778 497.263 Q66.5237 497.939 67.9407 498.873 Q69.3256 499.807 70.3562 501.353 Q71.3546 502.866 71.3546 504.605 Q71.3546 506.924 69.8087 508.47 Q68.2628 510.016 65.944 510.016 Q64.6557 510.016 62.8844 509.34 Q51.4513 505.056 47.5222 505.056 Q42.9168 505.056 42.9168 508.631 Q42.9168 510.403 43.5931 512.077 Q44.2372 513.72 45.139 514.847 Q46.0408 515.974 47.2968 517.005 Q48.5206 518.003 49.358 518.518 Q50.1631 519.001 50.9683 519.388 L54.2533 520.225 Q55.155 520.419 58.6655 521.353 L64.6235 522.802 Q69.068 523.832 69.4866 524.058 Q70.3884 524.38 70.8715 525.088 Q71.3546 525.797 71.3546 526.505 Q71.3546 527.311 70.8715 527.858 Q70.3884 528.406 69.551 528.406 Q69.4222 528.406 68.9391 528.309 Q68.456 528.212 67.7797 528.051 Q67.1034 527.89 66.7169 527.826 L51.4836 523.993 Q48.7138 523.285 47.8443 523.124 Q46.9425 522.931 45.9441 522.931 Q42.9168 522.931 42.9168 524.992 Q42.9168 526.666 44.9136 527.761 Q46.9103 528.856 50.775 529.79 Q51.8378 530.08 52.0633 530.274 Q52.2887 530.435 52.2887 530.918 Q52.2565 531.723 51.6124 531.723 Q51.4513 531.723 50.3886 531.465 Q49.3258 531.207 47.8121 530.724 Q46.2662 530.209 45.2356 529.726 Q44.4627 529.307 44.1084 529.082 Q43.7219 528.824 42.9812 528.212 Q42.2083 527.568 41.854 526.731 Q41.4675 525.861 41.4675 524.799 Q41.4675 522.415 43.0134 520.676 Q44.5271 518.937 47.2002 518.712 Q41.4675 514.428 41.4675 508.438 Q41.4675 504.895 43.3355 502.866 Q45.2034 500.837 48.5206 500.837 Q49.2936 500.837 50.2919 500.998 Q51.2581 501.127 52.4819 501.449 Q53.7058 501.739 54.6397 501.997 Q55.5737 502.254 57.0874 502.77 Q58.5688 503.285 59.213 503.51 Q59.8571 503.736 61.3708 504.283 Q62.8522 504.799 63.0132 504.863 Q66.0084 506.055 67.7153 506.055 Q68.8425 506.055 69.3578 505.7 Q69.8731 505.314 69.8731 504.477 Q69.8731 502.222 67.6509 500.548 Q65.3965 498.841 61.725 497.746 Q60.9199 497.488 60.7266 497.359 Q60.5334 497.198 60.5334 496.747 Q60.5334 495.974 61.1775 495.974 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip840)" d="M86.4591 489.649 Q86.1371 489.649 85.3319 488.812 Q74.5107 478.184 54.1244 478.184 Q33.6737 478.184 23.3356 488.393 Q22.144 489.649 21.7897 489.649 Q21.1456 489.649 21.1456 489.005 Q21.1456 488.554 22.4661 486.976 Q23.7865 485.366 26.8139 482.95 Q29.8412 480.503 33.5449 478.699 Q42.5303 474.351 54.1244 474.351 Q65.2677 474.351 74.2531 478.506 Q78.0212 480.277 81.1774 482.757 Q84.3335 485.237 85.7184 486.879 Q87.1032 488.522 87.1032 489.005 Q87.1032 489.649 86.4591 489.649 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><circle clip-path="url(#clip842)" cx="290.489" cy="1039.9" r="14.4" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="2.472"></circle>
<circle clip-path="url(#clip842)" cx="469.805" cy="509.651" r="14.4" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="2.472"></circle>
<circle clip-path="url(#clip842)" cx="649.122" cy="258.392" r="14.4" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="2.472"></circle>
<circle clip-path="url(#clip842)" cx="828.439" cy="131.699" r="14.4" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="2.472"></circle>
<circle clip-path="url(#clip842)" cx="1007.76" cy="78.8301" r="14.4" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="2.472"></circle>
<circle clip-path="url(#clip842)" cx="1187.07" cy="76.1564" r="14.4" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="2.472"></circle>
<circle clip-path="url(#clip842)" cx="1366.39" cy="110.53" r="14.4" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="2.472"></circle>
<circle clip-path="url(#clip842)" cx="1545.71" cy="173.78" r="14.4" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="2.472"></circle>
<circle clip-path="url(#clip842)" cx="1725.02" cy="260.427" r="14.4" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="2.472"></circle>
<circle clip-path="url(#clip842)" cx="1904.34" cy="366.588" r="14.4" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="2.472"></circle>
</svg>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-grid-search-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Grid Search for Optimal n.&nbsp;<span class="math inline">\(ϕ = 0.1\)</span>.
</figcaption>
</figure>
</div>
</div>
<div id="cell-grid-search" class="cell" data-execution_count="1">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">argmax</span>(u, <span class="fl">1</span><span class="op">:</span><span class="fl">10</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div id="grid-search" class="cell-output cell-output-display" data-execution_count="1">
<pre><code>6</code></pre>
</div>
</div>
<p><strong>補完 (Interpolation)</strong></p>
<p>これを実数の世界に拡張してみましょう. もし, <span class="math inline">\(n\)</span> が実数の時の <span class="math inline">\(\Phi(n)\)</span> の値が計算できれば, 通常の一変数関数の最大化問題として解くことができます. そのために, <span class="math inline">\(\Phi(n)\)</span> を補完 (interpolation) してみましょう. Juliaでは <code>Interpolations.jl</code> パッケージを用います.</p>
<div id="define-profit-interp" class="cell" data-execution_count="1">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>n_grid <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>Φ_grid <span class="op">=</span> <span class="fu">Φ</span>.(n_grid)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>Φ_interp <span class="op">=</span> <span class="fu">linear_interpolation</span>(n_grid, Φ_grid)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>Φ_spline <span class="op">=</span> Interpolations.<span class="fu">scale</span>(</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">interpolate</span>(Φ_grid, <span class="fu">BSpline</span>(<span class="fu">Cubic</span>(<span class="fu">Line</span>(<span class="fu">OnGrid</span>())))),</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>    n_grid</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="cell-fig-interpolation" class="cell" data-execution_count="1">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">scatter</span>(<span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, Φ, label<span class="op">=</span><span class="st">"Grid Points"</span>, xlabel<span class="op">=</span>L<span class="st">"n"</span>, ylabel<span class="op">=</span>L<span class="st">"\Phi(n)"</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot!</span>(<span class="fl">1</span><span class="op">:</span><span class="fl">0.1</span><span class="op">:</span><span class="fl">10</span>, n <span class="op">-&gt;</span> <span class="fu">Φ_interp</span>(n), label<span class="op">=</span><span class="st">"Linear Interpolation"</span>, legend<span class="op">=:</span>topleft)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot!</span>(<span class="fl">1</span><span class="op">:</span><span class="fl">0.1</span><span class="op">:</span><span class="fl">10</span>, n <span class="op">-&gt;</span> <span class="fu">Φ_spline</span>(n), label<span class="op">=</span><span class="st">"Cubic Spline"</span>, linestyle<span class="op">=:</span>dash)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div id="fig-interpolation" class="cell-output cell-output-display quarto-float quarto-figure quarto-figure-center anchored" data-execution_count="1">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-interpolation-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<!--?xml version="1.0" encoding="utf-8"?-->
<svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" width="500" height="309" viewbox="0 0 2000 1236">
<defs>
  <clippath id="clip900">
    <rect x="0" y="0" width="2000" height="1236"></rect>
  </clippath>
</defs>
<path clip-path="url(#clip900)" d="M0 1236 L2000 1236 L2000 1.24345e-14 L0 1.24345e-14  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<defs>
  <clippath id="clip901">
    <rect x="400" y="0" width="1401" height="1236"></rect>
  </clippath>
</defs>
<path clip-path="url(#clip900)" d="M211.911 1068.81 L1952.76 1068.81 L1952.76 47.2441 L211.911 47.2441  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<defs>
  <clippath id="clip902">
    <rect x="211" y="47" width="1742" height="1023"></rect>
  </clippath>
</defs>
<polyline clip-path="url(#clip902)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="443.659,1068.81 443.659,47.2441 "></polyline>
<polyline clip-path="url(#clip902)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="808.616,1068.81 808.616,47.2441 "></polyline>
<polyline clip-path="url(#clip902)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1173.57,1068.81 1173.57,47.2441 "></polyline>
<polyline clip-path="url(#clip902)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1538.53,1068.81 1538.53,47.2441 "></polyline>
<polyline clip-path="url(#clip902)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1903.49,1068.81 1903.49,47.2441 "></polyline>
<polyline clip-path="url(#clip902)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="211.911,1039.9 1952.76,1039.9 "></polyline>
<polyline clip-path="url(#clip902)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="211.911,720.872 1952.76,720.872 "></polyline>
<polyline clip-path="url(#clip902)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="211.911,401.845 1952.76,401.845 "></polyline>
<polyline clip-path="url(#clip902)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="211.911,82.8185 1952.76,82.8185 "></polyline>
<polyline clip-path="url(#clip900)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="211.911,1068.81 1952.76,1068.81 "></polyline>
<polyline clip-path="url(#clip900)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="443.659,1068.81 443.659,1049.91 "></polyline>
<polyline clip-path="url(#clip900)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="808.616,1068.81 808.616,1049.91 "></polyline>
<polyline clip-path="url(#clip900)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1173.57,1068.81 1173.57,1049.91 "></polyline>
<polyline clip-path="url(#clip900)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1538.53,1068.81 1538.53,1049.91 "></polyline>
<polyline clip-path="url(#clip900)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1903.49,1068.81 1903.49,1049.91 "></polyline>
<path clip-path="url(#clip900)" d="M438.312 1124.08 L454.631 1124.08 L454.631 1128.01 L432.687 1128.01 L432.687 1124.08 Q435.349 1121.32 439.932 1116.69 Q444.538 1112.04 445.719 1110.7 Q447.964 1108.17 448.844 1106.44 Q449.747 1104.68 449.747 1102.99 Q449.747 1100.23 447.802 1098.5 Q445.881 1096.76 442.779 1096.76 Q440.58 1096.76 438.126 1097.53 Q435.696 1098.29 432.918 1099.84 L432.918 1095.12 Q435.742 1093.98 438.196 1093.41 Q440.65 1092.83 442.687 1092.83 Q448.057 1092.83 451.251 1095.51 Q454.446 1098.2 454.446 1102.69 Q454.446 1104.82 453.636 1106.74 Q452.849 1108.64 450.742 1111.23 Q450.163 1111.9 447.062 1115.12 Q443.96 1118.31 438.312 1124.08 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M811.625 1097.53 L799.82 1115.97 L811.625 1115.97 L811.625 1097.53 M810.398 1093.45 L816.278 1093.45 L816.278 1115.97 L821.208 1115.97 L821.208 1119.86 L816.278 1119.86 L816.278 1128.01 L811.625 1128.01 L811.625 1119.86 L796.023 1119.86 L796.023 1115.35 L810.398 1093.45 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M1173.98 1108.87 Q1170.83 1108.87 1168.98 1111.02 Q1167.15 1113.17 1167.15 1116.92 Q1167.15 1120.65 1168.98 1122.83 Q1170.83 1124.98 1173.98 1124.98 Q1177.13 1124.98 1178.95 1122.83 Q1180.81 1120.65 1180.81 1116.92 Q1180.81 1113.17 1178.95 1111.02 Q1177.13 1108.87 1173.98 1108.87 M1183.26 1094.22 L1183.26 1098.47 Q1181.5 1097.64 1179.7 1097.2 Q1177.91 1096.76 1176.15 1096.76 Q1171.52 1096.76 1169.07 1099.89 Q1166.64 1103.01 1166.29 1109.33 Q1167.66 1107.32 1169.72 1106.25 Q1171.78 1105.16 1174.26 1105.16 Q1179.46 1105.16 1182.47 1108.34 Q1185.51 1111.48 1185.51 1116.92 Q1185.51 1122.25 1182.36 1125.47 Q1179.21 1128.68 1173.98 1128.68 Q1167.98 1128.68 1164.81 1124.1 Q1161.64 1119.49 1161.64 1110.77 Q1161.64 1102.57 1165.53 1097.71 Q1169.42 1092.83 1175.97 1092.83 Q1177.73 1092.83 1179.51 1093.17 Q1181.32 1093.52 1183.26 1094.22 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M1538.53 1111.6 Q1535.2 1111.6 1533.28 1113.38 Q1531.38 1115.16 1531.38 1118.29 Q1531.38 1121.41 1533.28 1123.2 Q1535.2 1124.98 1538.53 1124.98 Q1541.86 1124.98 1543.78 1123.2 Q1545.71 1121.39 1545.71 1118.29 Q1545.71 1115.16 1543.78 1113.38 Q1541.89 1111.6 1538.53 1111.6 M1533.85 1109.61 Q1530.84 1108.87 1529.15 1106.81 Q1527.49 1104.75 1527.49 1101.78 Q1527.49 1097.64 1530.43 1095.23 Q1533.39 1092.83 1538.53 1092.83 Q1543.69 1092.83 1546.63 1095.23 Q1549.57 1097.64 1549.57 1101.78 Q1549.57 1104.75 1547.88 1106.81 Q1546.21 1108.87 1543.23 1109.61 Q1546.61 1110.4 1548.48 1112.69 Q1550.38 1114.98 1550.38 1118.29 Q1550.38 1123.31 1547.3 1126 Q1544.25 1128.68 1538.53 1128.68 Q1532.81 1128.68 1529.73 1126 Q1526.68 1123.31 1526.68 1118.29 Q1526.68 1114.98 1528.58 1112.69 Q1530.47 1110.4 1533.85 1109.61 M1532.14 1102.22 Q1532.14 1104.91 1533.81 1106.41 Q1535.5 1107.92 1538.53 1107.92 Q1541.54 1107.92 1543.23 1106.41 Q1544.94 1104.91 1544.94 1102.22 Q1544.94 1099.54 1543.23 1098.03 Q1541.54 1096.53 1538.53 1096.53 Q1535.5 1096.53 1533.81 1098.03 Q1532.14 1099.54 1532.14 1102.22 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M1878.17 1124.08 L1885.81 1124.08 L1885.81 1097.71 L1877.5 1099.38 L1877.5 1095.12 L1885.77 1093.45 L1890.44 1093.45 L1890.44 1124.08 L1898.08 1124.08 L1898.08 1128.01 L1878.17 1128.01 L1878.17 1124.08 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M1917.53 1096.53 Q1913.91 1096.53 1912.09 1100.1 Q1910.28 1103.64 1910.28 1110.77 Q1910.28 1117.87 1912.09 1121.44 Q1913.91 1124.98 1917.53 1124.98 Q1921.16 1124.98 1922.97 1121.44 Q1924.79 1117.87 1924.79 1110.77 Q1924.79 1103.64 1922.97 1100.1 Q1921.16 1096.53 1917.53 1096.53 M1917.53 1092.83 Q1923.34 1092.83 1926.39 1097.43 Q1929.47 1102.02 1929.47 1110.77 Q1929.47 1119.49 1926.39 1124.1 Q1923.34 1128.68 1917.53 1128.68 Q1911.72 1128.68 1908.64 1124.1 Q1905.58 1119.49 1905.58 1110.77 Q1905.58 1102.02 1908.64 1097.43 Q1911.72 1092.83 1917.53 1092.83 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M1098.5 1183.8 Q1098.5 1184.05 1098.21 1185.05 Q1097.92 1186.05 1097.21 1187.6 Q1096.53 1189.14 1095.6 1190.56 Q1094.66 1191.94 1093.12 1192.98 Q1091.61 1193.97 1089.87 1193.97 Q1087.55 1193.97 1086 1192.43 Q1084.46 1190.88 1084.46 1188.56 Q1084.46 1187.27 1085.13 1185.5 Q1089.42 1174.07 1089.42 1170.14 Q1089.42 1165.54 1085.84 1165.54 Q1084.07 1165.54 1082.39 1166.21 Q1080.75 1166.86 1079.62 1167.76 Q1078.5 1168.66 1077.47 1169.92 Q1076.47 1171.14 1075.95 1171.98 Q1075.47 1172.78 1075.08 1173.59 L1074.25 1176.87 Q1074.05 1177.77 1073.12 1181.28 L1071.67 1187.24 Q1070.64 1191.69 1070.41 1192.11 Q1070.09 1193.01 1069.38 1193.49 Q1068.67 1193.97 1067.97 1193.97 Q1067.16 1193.97 1066.61 1193.49 Q1066.07 1193.01 1066.07 1192.17 Q1066.07 1192.04 1066.16 1191.56 Q1066.26 1191.07 1066.42 1190.4 Q1066.58 1189.72 1066.65 1189.34 L1070.48 1174.1 Q1071.19 1171.33 1071.35 1170.46 Q1071.54 1169.56 1071.54 1168.56 Q1071.54 1165.54 1069.48 1165.54 Q1067.8 1165.54 1066.71 1167.53 Q1065.61 1169.53 1064.68 1173.39 Q1064.39 1174.46 1064.2 1174.68 Q1064.04 1174.91 1063.55 1174.91 Q1062.75 1174.88 1062.75 1174.23 Q1062.75 1174.07 1063.01 1173.01 Q1063.26 1171.94 1063.75 1170.43 Q1064.26 1168.89 1064.75 1167.85 Q1065.16 1167.08 1065.39 1166.73 Q1065.65 1166.34 1066.26 1165.6 Q1066.9 1164.83 1067.74 1164.47 Q1068.61 1164.09 1069.67 1164.09 Q1072.06 1164.09 1073.8 1165.63 Q1075.53 1167.15 1075.76 1169.82 Q1080.04 1164.09 1086.03 1164.09 Q1089.58 1164.09 1091.61 1165.95 Q1093.63 1167.82 1093.63 1171.14 Q1093.63 1171.91 1093.47 1172.91 Q1093.34 1173.88 1093.02 1175.1 Q1092.73 1176.32 1092.47 1177.26 Q1092.22 1178.19 1091.7 1179.71 Q1091.19 1181.19 1090.96 1181.83 Q1090.74 1182.48 1090.19 1183.99 Q1089.67 1185.47 1089.61 1185.63 Q1088.42 1188.63 1088.42 1190.33 Q1088.42 1191.46 1088.77 1191.98 Q1089.16 1192.49 1089.99 1192.49 Q1092.25 1192.49 1093.92 1190.27 Q1095.63 1188.02 1096.73 1184.34 Q1096.98 1183.54 1097.11 1183.35 Q1097.27 1183.15 1097.72 1183.15 Q1098.5 1183.15 1098.5 1183.8 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip900)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="211.911,1068.81 211.911,47.2441 "></polyline>
<polyline clip-path="url(#clip900)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="211.911,1039.9 230.809,1039.9 "></polyline>
<polyline clip-path="url(#clip900)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="211.911,720.872 230.809,720.872 "></polyline>
<polyline clip-path="url(#clip900)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="211.911,401.845 230.809,401.845 "></polyline>
<polyline clip-path="url(#clip900)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="211.911,82.8185 230.809,82.8185 "></polyline>
<path clip-path="url(#clip900)" d="M124.736 1025.7 Q121.124 1025.7 119.296 1029.26 Q117.49 1032.8 117.49 1039.93 Q117.49 1047.04 119.296 1050.61 Q121.124 1054.15 124.736 1054.15 Q128.37 1054.15 130.175 1050.61 Q132.004 1047.04 132.004 1039.93 Q132.004 1032.8 130.175 1029.26 Q128.37 1025.7 124.736 1025.7 M124.736 1021.99 Q130.546 1021.99 133.601 1026.6 Q136.68 1031.18 136.68 1039.93 Q136.68 1048.66 133.601 1053.27 Q130.546 1057.85 124.736 1057.85 Q118.925 1057.85 115.847 1053.27 Q112.791 1048.66 112.791 1039.93 Q112.791 1031.18 115.847 1026.6 Q118.925 1021.99 124.736 1021.99 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M144.898 1051.3 L149.782 1051.3 L149.782 1057.18 L144.898 1057.18 L144.898 1051.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M169.967 1025.7 Q166.356 1025.7 164.527 1029.26 Q162.721 1032.8 162.721 1039.93 Q162.721 1047.04 164.527 1050.61 Q166.356 1054.15 169.967 1054.15 Q173.601 1054.15 175.407 1050.61 Q177.235 1047.04 177.235 1039.93 Q177.235 1032.8 175.407 1029.26 Q173.601 1025.7 169.967 1025.7 M169.967 1021.99 Q175.777 1021.99 178.833 1026.6 Q181.911 1031.18 181.911 1039.93 Q181.911 1048.66 178.833 1053.27 Q175.777 1057.85 169.967 1057.85 Q164.157 1057.85 161.078 1053.27 Q158.022 1048.66 158.022 1039.93 Q158.022 1031.18 161.078 1026.6 Q164.157 1021.99 169.967 1021.99 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M125.731 706.671 Q122.12 706.671 120.291 710.236 Q118.486 713.778 118.486 720.907 Q118.486 728.014 120.291 731.578 Q122.12 735.12 125.731 735.12 Q129.365 735.12 131.171 731.578 Q132.999 728.014 132.999 720.907 Q132.999 713.778 131.171 710.236 Q129.365 706.671 125.731 706.671 M125.731 702.967 Q131.541 702.967 134.597 707.574 Q137.675 712.157 137.675 720.907 Q137.675 729.634 134.597 734.24 Q131.541 738.824 125.731 738.824 Q119.921 738.824 116.842 734.24 Q113.787 729.634 113.787 720.907 Q113.787 712.157 116.842 707.574 Q119.921 702.967 125.731 702.967 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M145.893 732.273 L150.777 732.273 L150.777 738.152 L145.893 738.152 L145.893 732.273 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M161.009 703.592 L179.365 703.592 L179.365 707.528 L165.291 707.528 L165.291 716 Q166.309 715.653 167.328 715.491 Q168.346 715.305 169.365 715.305 Q175.152 715.305 178.532 718.477 Q181.911 721.648 181.911 727.065 Q181.911 732.643 178.439 735.745 Q174.967 738.824 168.647 738.824 Q166.471 738.824 164.203 738.453 Q161.958 738.083 159.55 737.342 L159.55 732.643 Q161.634 733.777 163.856 734.333 Q166.078 734.889 168.555 734.889 Q172.559 734.889 174.897 732.782 Q177.235 730.676 177.235 727.065 Q177.235 723.453 174.897 721.347 Q172.559 719.24 168.555 719.24 Q166.68 719.24 164.805 719.657 Q162.953 720.074 161.009 720.953 L161.009 703.592 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M115.546 415.19 L123.185 415.19 L123.185 388.825 L114.875 390.491 L114.875 386.232 L123.138 384.565 L127.814 384.565 L127.814 415.19 L135.453 415.19 L135.453 419.125 L115.546 419.125 L115.546 415.19 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M144.898 413.246 L149.782 413.246 L149.782 419.125 L144.898 419.125 L144.898 413.246 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M169.967 387.644 Q166.356 387.644 164.527 391.209 Q162.721 394.751 162.721 401.88 Q162.721 408.987 164.527 412.551 Q166.356 416.093 169.967 416.093 Q173.601 416.093 175.407 412.551 Q177.235 408.987 177.235 401.88 Q177.235 394.751 175.407 391.209 Q173.601 387.644 169.967 387.644 M169.967 383.94 Q175.777 383.94 178.833 388.547 Q181.911 393.13 181.911 401.88 Q181.911 410.607 178.833 415.213 Q175.777 419.797 169.967 419.797 Q164.157 419.797 161.078 415.213 Q158.022 410.607 158.022 401.88 Q158.022 393.13 161.078 388.547 Q164.157 383.94 169.967 383.94 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M116.541 96.1633 L124.18 96.1633 L124.18 69.7977 L115.87 71.4644 L115.87 67.2051 L124.134 65.5385 L128.81 65.5385 L128.81 96.1633 L136.448 96.1633 L136.448 100.098 L116.541 100.098 L116.541 96.1633 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M145.893 94.2189 L150.777 94.2189 L150.777 100.098 L145.893 100.098 L145.893 94.2189 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M161.009 65.5385 L179.365 65.5385 L179.365 69.4736 L165.291 69.4736 L165.291 77.9458 Q166.309 77.5986 167.328 77.4366 Q168.346 77.2514 169.365 77.2514 Q175.152 77.2514 178.532 80.4226 Q181.911 83.5939 181.911 89.0106 Q181.911 94.5892 178.439 97.6911 Q174.967 100.77 168.647 100.77 Q166.471 100.77 164.203 100.399 Q161.958 100.029 159.55 99.2883 L159.55 94.5892 Q161.634 95.7235 163.856 96.279 Q166.078 96.8346 168.555 96.8346 Q172.559 96.8346 174.897 94.7281 Q177.235 92.6217 177.235 89.0106 Q177.235 85.3995 174.897 83.293 Q172.559 81.1865 168.555 81.1865 Q166.68 81.1865 164.805 81.6032 Q162.953 82.0199 161.009 82.8995 L161.009 65.5385 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M48.1341 627.039 Q42.8524 627.039 38.9555 621.983 Q35.0586 616.894 34.4789 609.841 L30.6464 609.841 Q28.6818 609.841 28.1665 611.065 Q27.619 612.289 27.619 617.023 L27.619 618.279 L25.5578 618.279 Q25.7511 612.611 25.7511 607.072 Q25.7511 601.532 25.5578 595.864 L27.619 595.864 L27.619 597.056 Q27.619 601.661 28.1343 602.981 Q28.6496 604.302 30.6464 604.302 L34.4789 604.302 Q34.9942 597.12 38.8911 591.935 Q42.788 586.75 48.1341 586.75 Q53.0938 586.75 57.1196 591.709 Q61.1131 596.637 61.725 604.302 L65.5253 604.302 Q67.4899 604.302 68.0374 603.078 Q68.5849 601.854 68.5849 597.12 L68.5849 595.864 L70.6138 595.864 Q70.4206 601.532 70.4206 607.072 Q70.4206 612.611 70.6138 618.279 L68.5849 618.279 L68.5849 617.023 Q68.5849 612.353 68.0374 611.097 Q67.4577 609.841 65.5253 609.841 L61.725 609.841 Q61.1453 616.959 57.2162 622.015 Q53.2871 627.039 48.1341 627.039 M48.0697 620.469 Q58.6977 620.469 60.1147 609.841 L36.0569 609.841 Q36.7977 614.93 39.7928 617.7 Q42.788 620.469 48.0697 620.469 M60.1791 604.302 Q58.601 593.416 48.1341 593.416 Q44.7203 593.416 42.3049 594.447 Q39.8894 595.445 38.6334 597.345 Q37.3774 599.213 36.8621 600.759 Q36.3146 602.305 35.9925 604.302 L60.1791 604.302 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M54.1244 576.463 Q42.9812 576.463 33.9958 572.309 Q30.2277 570.537 27.0715 568.057 Q23.9153 565.578 22.5305 563.935 Q21.1456 562.293 21.1456 561.842 Q21.1456 561.198 21.7897 561.165 Q22.1118 561.165 22.917 562.035 Q33.7381 572.663 54.1244 572.631 Q74.5752 572.631 84.9776 562.293 Q86.1049 561.165 86.4591 561.165 Q87.1032 561.165 87.1032 561.842 Q87.1032 562.293 85.7828 563.871 Q84.4624 565.449 81.435 567.896 Q78.4077 570.344 74.704 572.115 Q65.7185 576.463 54.1244 576.463 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M61.1775 520.668 Q61.4352 520.668 62.4335 520.958 Q63.4319 521.248 64.9778 521.956 Q66.5237 522.633 67.9407 523.567 Q69.3256 524.501 70.3562 526.047 Q71.3546 527.56 71.3546 529.299 Q71.3546 531.618 69.8087 533.164 Q68.2628 534.71 65.944 534.71 Q64.6557 534.71 62.8844 534.034 Q51.4513 529.75 47.5222 529.75 Q42.9168 529.75 42.9168 533.325 Q42.9168 535.096 43.5931 536.771 Q44.2372 538.414 45.139 539.541 Q46.0408 540.668 47.2968 541.699 Q48.5206 542.697 49.358 543.212 Q50.1631 543.695 50.9683 544.082 L54.2533 544.919 Q55.155 545.112 58.6655 546.046 L64.6235 547.496 Q69.068 548.526 69.4866 548.752 Q70.3884 549.074 70.8715 549.782 Q71.3546 550.491 71.3546 551.199 Q71.3546 552.005 70.8715 552.552 Q70.3884 553.1 69.551 553.1 Q69.4222 553.1 68.9391 553.003 Q68.456 552.906 67.7797 552.745 Q67.1034 552.584 66.7169 552.52 L51.4836 548.687 Q48.7138 547.979 47.8443 547.818 Q46.9425 547.625 45.9441 547.625 Q42.9168 547.625 42.9168 549.686 Q42.9168 551.36 44.9136 552.455 Q46.9103 553.55 50.775 554.484 Q51.8378 554.774 52.0633 554.967 Q52.2887 555.129 52.2887 555.612 Q52.2565 556.417 51.6124 556.417 Q51.4513 556.417 50.3886 556.159 Q49.3258 555.901 47.8121 555.418 Q46.2662 554.903 45.2356 554.42 Q44.4627 554.001 44.1084 553.776 Q43.7219 553.518 42.9812 552.906 Q42.2083 552.262 41.854 551.425 Q41.4675 550.555 41.4675 549.492 Q41.4675 547.109 43.0134 545.37 Q44.5271 543.631 47.2002 543.406 Q41.4675 539.122 41.4675 533.132 Q41.4675 529.589 43.3355 527.56 Q45.2034 525.531 48.5206 525.531 Q49.2936 525.531 50.2919 525.692 Q51.2581 525.821 52.4819 526.143 Q53.7058 526.433 54.6397 526.691 Q55.5737 526.948 57.0874 527.464 Q58.5688 527.979 59.213 528.204 Q59.8571 528.43 61.3708 528.977 Q62.8522 529.493 63.0132 529.557 Q66.0084 530.749 67.7153 530.749 Q68.8425 530.749 69.3578 530.394 Q69.8731 530.008 69.8731 529.171 Q69.8731 526.916 67.6509 525.241 Q65.3965 523.535 61.725 522.44 Q60.9199 522.182 60.7266 522.053 Q60.5334 521.892 60.5334 521.441 Q60.5334 520.668 61.1775 520.668 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M86.4591 514.343 Q86.1371 514.343 85.3319 513.506 Q74.5107 502.878 54.1244 502.878 Q33.6737 502.878 23.3356 513.087 Q22.144 514.343 21.7897 514.343 Q21.1456 514.343 21.1456 513.699 Q21.1456 513.248 22.4661 511.67 Q23.7865 510.06 26.8139 507.644 Q29.8412 505.196 33.5449 503.393 Q42.5303 499.045 54.1244 499.045 Q65.2677 499.045 74.2531 503.2 Q78.0212 504.971 81.1774 507.451 Q84.3335 509.931 85.7184 511.573 Q87.1032 513.216 87.1032 513.699 Q87.1032 514.343 86.4591 514.343 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><circle clip-path="url(#clip902)" cx="261.18" cy="1039.9" r="14.4" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="2.472"></circle>
<circle clip-path="url(#clip902)" cx="443.659" cy="995.673" r="14.4" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="2.472"></circle>
<circle clip-path="url(#clip902)" cx="626.137" cy="925.575" r="14.4" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="2.472"></circle>
<circle clip-path="url(#clip902)" cx="808.616" cy="837.122" r="14.4" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="2.472"></circle>
<circle clip-path="url(#clip902)" cx="991.094" cy="734.432" r="14.4" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="2.472"></circle>
<circle clip-path="url(#clip902)" cx="1173.57" cy="620.108" r="14.4" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="2.472"></circle>
<circle clip-path="url(#clip902)" cx="1356.05" cy="495.948" r="14.4" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="2.472"></circle>
<circle clip-path="url(#clip902)" cx="1538.53" cy="363.269" r="14.4" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="2.472"></circle>
<circle clip-path="url(#clip902)" cx="1721.01" cy="223.074" r="14.4" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="2.472"></circle>
<circle clip-path="url(#clip902)" cx="1903.49" cy="76.1564" r="14.4" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="2.472"></circle>
<polyline clip-path="url(#clip902)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="261.18,1039.9 279.428,1035.48 297.676,1031.05 315.924,1026.63 334.172,1022.21 352.42,1017.79 370.667,1013.36 388.915,1008.94 407.163,1004.52 425.411,1000.1 443.659,995.673 461.907,988.663 480.155,981.653 498.402,974.644 516.65,967.634 534.898,960.624 553.146,953.614 571.394,946.605 589.642,939.595 607.89,932.585 626.137,925.575 644.385,916.73 662.633,907.885 680.881,899.04 699.129,890.194 717.377,881.349 735.624,872.504 753.872,863.658 772.12,854.813 790.368,845.968 808.616,837.122 826.864,826.853 845.112,816.584 863.359,806.315 881.607,796.046 899.855,785.777 918.103,775.508 936.351,765.239 954.599,754.97 972.846,744.701 991.094,734.432 1009.34,722.999 1027.59,711.567 1045.84,700.134 1064.09,688.702 1082.33,677.27 1100.58,665.837 1118.83,654.405 1137.08,642.972 1155.32,631.54 1173.57,620.108 1191.82,607.692 1210.07,595.276 1228.32,582.86 1246.56,570.444 1264.81,558.028 1283.06,545.612 1301.31,533.196 1319.56,520.78 1337.8,508.364 1356.05,495.948 1374.3,482.68 1392.55,469.412 1410.79,456.144 1429.04,442.876 1447.29,429.608 1465.54,416.34 1483.79,403.072 1502.03,389.804 1520.28,376.536 1538.53,363.269 1556.78,349.249 1575.03,335.23 1593.27,321.21 1611.52,307.191 1629.77,293.171 1648.02,279.152 1666.26,265.132 1684.51,251.113 1702.76,237.093 1721.01,223.074 1739.26,208.382 1757.5,193.69 1775.75,178.999 1794,164.307 1812.25,149.615 1830.5,134.923 1848.74,120.232 1866.99,105.54 1885.24,90.8481 1903.49,76.1564 "></polyline>
<polyline clip-path="url(#clip902)" style="stroke:#3da44d; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" stroke-dasharray="16, 10" points="261.18,1039.9 279.428,1036.05 297.676,1032.18 315.924,1028.23 334.172,1024.17 352.42,1019.98 370.667,1015.61 388.915,1011.03 407.163,1006.2 425.411,1001.09 443.659,995.673 461.907,989.911 480.155,983.818 498.402,977.415 516.65,970.721 534.898,963.757 553.146,956.542 571.394,949.096 589.642,941.44 607.89,933.593 626.137,925.575 644.385,917.404 662.633,909.081 680.881,900.609 699.129,891.986 717.377,883.214 735.624,874.293 753.872,865.223 772.12,856.004 790.368,846.637 808.616,837.122 826.864,827.461 845.112,817.655 863.359,807.708 881.607,797.624 899.855,787.406 918.103,777.058 936.351,766.584 954.599,755.985 972.846,745.267 991.094,734.432 1009.34,723.483 1027.59,712.423 1045.84,701.253 1064.09,689.974 1082.33,678.588 1100.58,667.097 1118.83,655.502 1137.08,643.804 1155.32,632.006 1173.57,620.108 1191.82,608.112 1210.07,596.02 1228.32,583.832 1246.56,571.55 1264.81,559.175 1283.06,546.708 1301.31,534.151 1319.56,521.505 1337.8,508.77 1356.05,495.948 1374.3,483.041 1392.55,470.049 1410.79,456.975 1429.04,443.82 1447.29,430.585 1465.54,417.272 1483.79,403.882 1502.03,390.417 1520.28,376.879 1538.53,363.269 1556.78,349.587 1575.03,335.834 1593.27,322.008 1611.52,308.108 1629.77,294.132 1648.02,280.079 1666.26,265.948 1684.51,251.738 1702.76,237.447 1721.01,223.074 1739.26,208.619 1757.5,194.09 1775.75,179.494 1794,164.839 1812.25,150.135 1830.5,135.389 1848.74,120.61 1866.99,105.806 1885.24,90.9854 1903.49,76.1564 "></polyline>
<path clip-path="url(#clip900)" d="M269.939 288.656 L901.151 288.656 L901.151 81.2963 L269.939 81.2963  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<polyline clip-path="url(#clip900)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="269.939,288.656 901.151,288.656 901.151,81.2963 269.939,81.2963 269.939,288.656 "></polyline>
<circle clip-path="url(#clip900)" cx="347.31" cy="133.136" r="20.48" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.51573"></circle>
<path clip-path="url(#clip900)" d="M450.237 145.486 L450.237 136.203 L442.598 136.203 L442.598 132.361 L454.866 132.361 L454.866 147.199 Q452.158 149.12 448.894 150.115 Q445.63 151.088 441.926 151.088 Q433.825 151.088 429.241 146.365 Q424.681 141.62 424.681 133.171 Q424.681 124.699 429.241 119.977 Q433.825 115.231 441.926 115.231 Q445.306 115.231 448.338 116.065 Q451.394 116.898 453.963 118.518 L453.963 123.495 Q451.371 121.296 448.454 120.185 Q445.537 119.074 442.32 119.074 Q435.977 119.074 432.783 122.616 Q429.612 126.157 429.612 133.171 Q429.612 140.162 432.783 143.703 Q435.977 147.245 442.32 147.245 Q444.797 147.245 446.741 146.828 Q448.686 146.389 450.237 145.486 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M478.246 128.472 Q477.528 128.055 476.672 127.87 Q475.838 127.662 474.82 127.662 Q471.209 127.662 469.264 130.023 Q467.343 132.361 467.343 136.759 L467.343 150.416 L463.061 150.416 L463.061 124.491 L467.343 124.491 L467.343 128.518 Q468.686 126.157 470.838 125.023 Q472.991 123.866 476.07 123.866 Q476.51 123.866 477.042 123.935 Q477.574 123.981 478.222 124.097 L478.246 128.472 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M482.713 124.491 L486.972 124.491 L486.972 150.416 L482.713 150.416 L482.713 124.491 M482.713 114.398 L486.972 114.398 L486.972 119.792 L482.713 119.792 L482.713 114.398 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M512.945 128.426 L512.945 114.398 L517.204 114.398 L517.204 150.416 L512.945 150.416 L512.945 146.527 Q511.602 148.842 509.542 149.977 Q507.505 151.088 504.634 151.088 Q499.935 151.088 496.972 147.338 Q494.033 143.588 494.033 137.477 Q494.033 131.366 496.972 127.616 Q499.935 123.866 504.634 123.866 Q507.505 123.866 509.542 125 Q511.602 126.111 512.945 128.426 M498.431 137.477 Q498.431 142.176 500.352 144.861 Q502.296 147.523 505.676 147.523 Q509.056 147.523 511 144.861 Q512.945 142.176 512.945 137.477 Q512.945 132.778 511 130.116 Q509.056 127.43 505.676 127.43 Q502.296 127.43 500.352 130.116 Q498.431 132.778 498.431 137.477 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M545.907 119.699 L545.907 132.685 L551.787 132.685 Q555.051 132.685 556.833 130.995 Q558.616 129.305 558.616 126.18 Q558.616 123.079 556.833 121.389 Q555.051 119.699 551.787 119.699 L545.907 119.699 M541.231 115.856 L551.787 115.856 Q557.597 115.856 560.56 118.495 Q563.546 121.111 563.546 126.18 Q563.546 131.296 560.56 133.912 Q557.597 136.528 551.787 136.528 L545.907 136.528 L545.907 150.416 L541.231 150.416 L541.231 115.856 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M577.99 127.477 Q574.565 127.477 572.574 130.162 Q570.583 132.824 570.583 137.477 Q570.583 142.129 572.551 144.815 Q574.541 147.477 577.99 147.477 Q581.393 147.477 583.384 144.791 Q585.375 142.106 585.375 137.477 Q585.375 132.87 583.384 130.185 Q581.393 127.477 577.99 127.477 M577.99 123.866 Q583.546 123.866 586.717 127.477 Q589.889 131.088 589.889 137.477 Q589.889 143.842 586.717 147.477 Q583.546 151.088 577.99 151.088 Q572.412 151.088 569.241 147.477 Q566.092 143.842 566.092 137.477 Q566.092 131.088 569.241 127.477 Q572.412 123.866 577.99 123.866 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M596.949 124.491 L601.208 124.491 L601.208 150.416 L596.949 150.416 L596.949 124.491 M596.949 114.398 L601.208 114.398 L601.208 119.792 L596.949 119.792 L596.949 114.398 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M631.671 134.768 L631.671 150.416 L627.412 150.416 L627.412 134.907 Q627.412 131.227 625.976 129.398 Q624.541 127.569 621.671 127.569 Q618.222 127.569 616.231 129.768 Q614.24 131.967 614.24 135.764 L614.24 150.416 L609.958 150.416 L609.958 124.491 L614.24 124.491 L614.24 128.518 Q615.768 126.18 617.828 125.023 Q619.912 123.866 622.62 123.866 Q627.087 123.866 629.379 126.643 Q631.671 129.398 631.671 134.768 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M644.379 117.129 L644.379 124.491 L653.152 124.491 L653.152 127.801 L644.379 127.801 L644.379 141.875 Q644.379 145.046 645.235 145.949 Q646.115 146.852 648.777 146.852 L653.152 146.852 L653.152 150.416 L648.777 150.416 Q643.847 150.416 641.972 148.588 Q640.097 146.736 640.097 141.875 L640.097 127.801 L636.972 127.801 L636.972 124.491 L640.097 124.491 L640.097 117.129 L644.379 117.129 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M675.282 125.254 L675.282 129.282 Q673.476 128.356 671.532 127.893 Q669.587 127.43 667.504 127.43 Q664.333 127.43 662.735 128.403 Q661.161 129.375 661.161 131.319 Q661.161 132.801 662.296 133.657 Q663.43 134.491 666.856 135.254 L668.314 135.578 Q672.851 136.551 674.749 138.333 Q676.67 140.092 676.67 143.264 Q676.67 146.875 673.8 148.981 Q670.953 151.088 665.953 151.088 Q663.87 151.088 661.601 150.671 Q659.356 150.277 656.856 149.467 L656.856 145.069 Q659.217 146.296 661.509 146.921 Q663.8 147.523 666.046 147.523 Q669.055 147.523 670.675 146.504 Q672.296 145.463 672.296 143.588 Q672.296 141.852 671.115 140.926 Q669.958 140 665.999 139.143 L664.518 138.796 Q660.559 137.963 658.8 136.25 Q657.041 134.514 657.041 131.504 Q657.041 127.847 659.634 125.856 Q662.226 123.866 666.995 123.866 Q669.356 123.866 671.439 124.213 Q673.522 124.56 675.282 125.254 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip900)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="289.282,184.976 405.338,184.976 "></polyline>
<path clip-path="url(#clip900)" d="M424.681 167.696 L429.357 167.696 L429.357 198.321 L446.186 198.321 L446.186 202.256 L424.681 202.256 L424.681 167.696 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M450.908 176.331 L455.167 176.331 L455.167 202.256 L450.908 202.256 L450.908 176.331 M450.908 166.238 L455.167 166.238 L455.167 171.632 L450.908 171.632 L450.908 166.238 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M485.63 186.608 L485.63 202.256 L481.371 202.256 L481.371 186.747 Q481.371 183.067 479.935 181.238 Q478.5 179.409 475.63 179.409 Q472.181 179.409 470.19 181.608 Q468.199 183.807 468.199 187.604 L468.199 202.256 L463.917 202.256 L463.917 176.331 L468.199 176.331 L468.199 180.358 Q469.727 178.02 471.787 176.863 Q473.871 175.706 476.579 175.706 Q481.047 175.706 483.338 178.483 Q485.63 181.238 485.63 186.608 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M516.301 188.229 L516.301 190.312 L496.718 190.312 Q496.996 194.71 499.357 197.025 Q501.741 199.317 505.977 199.317 Q508.431 199.317 510.722 198.715 Q513.037 198.113 515.306 196.909 L515.306 200.937 Q513.014 201.909 510.607 202.418 Q508.199 202.928 505.722 202.928 Q499.519 202.928 495.884 199.317 Q492.273 195.705 492.273 189.548 Q492.273 183.182 495.699 179.456 Q499.148 175.706 504.982 175.706 Q510.213 175.706 513.245 179.085 Q516.301 182.442 516.301 188.229 M512.042 186.979 Q511.995 183.483 510.074 181.4 Q508.176 179.317 505.028 179.317 Q501.463 179.317 499.31 181.331 Q497.181 183.344 496.857 187.002 L512.042 186.979 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M535.074 189.224 Q529.912 189.224 527.921 190.405 Q525.931 191.585 525.931 194.432 Q525.931 196.701 527.412 198.043 Q528.917 199.363 531.486 199.363 Q535.028 199.363 537.157 196.863 Q539.31 194.34 539.31 190.173 L539.31 189.224 L535.074 189.224 M543.569 187.465 L543.569 202.256 L539.31 202.256 L539.31 198.321 Q537.852 200.682 535.676 201.817 Q533.5 202.928 530.352 202.928 Q526.37 202.928 524.009 200.705 Q521.671 198.46 521.671 194.71 Q521.671 190.335 524.588 188.113 Q527.528 185.891 533.338 185.891 L539.31 185.891 L539.31 185.474 Q539.31 182.534 537.366 180.937 Q535.444 179.317 531.949 179.317 Q529.727 179.317 527.62 179.849 Q525.514 180.381 523.569 181.446 L523.569 177.511 Q525.907 176.608 528.106 176.169 Q530.306 175.706 532.389 175.706 Q538.014 175.706 540.792 178.622 Q543.569 181.539 543.569 187.465 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M567.366 180.312 Q566.648 179.895 565.791 179.71 Q564.958 179.502 563.94 179.502 Q560.329 179.502 558.384 181.863 Q556.463 184.201 556.463 188.599 L556.463 202.256 L552.18 202.256 L552.18 176.331 L556.463 176.331 L556.463 180.358 Q557.805 177.997 559.958 176.863 Q562.111 175.706 565.19 175.706 Q565.629 175.706 566.162 175.775 Q566.694 175.821 567.342 175.937 L567.366 180.312 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M587.088 167.696 L591.764 167.696 L591.764 202.256 L587.088 202.256 L587.088 167.696 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M622.435 186.608 L622.435 202.256 L618.175 202.256 L618.175 186.747 Q618.175 183.067 616.74 181.238 Q615.305 179.409 612.435 179.409 Q608.986 179.409 606.995 181.608 Q605.004 183.807 605.004 187.604 L605.004 202.256 L600.722 202.256 L600.722 176.331 L605.004 176.331 L605.004 180.358 Q606.532 178.02 608.592 176.863 Q610.675 175.706 613.384 175.706 Q617.851 175.706 620.143 178.483 Q622.435 181.238 622.435 186.608 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M635.143 168.969 L635.143 176.331 L643.916 176.331 L643.916 179.641 L635.143 179.641 L635.143 193.715 Q635.143 196.886 635.999 197.789 Q636.879 198.692 639.541 198.692 L643.916 198.692 L643.916 202.256 L639.541 202.256 Q634.611 202.256 632.736 200.428 Q630.861 198.576 630.861 193.715 L630.861 179.641 L627.736 179.641 L627.736 176.331 L630.861 176.331 L630.861 168.969 L635.143 168.969 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M671.694 188.229 L671.694 190.312 L652.11 190.312 Q652.388 194.71 654.749 197.025 Q657.134 199.317 661.37 199.317 Q663.823 199.317 666.115 198.715 Q668.43 198.113 670.698 196.909 L670.698 200.937 Q668.407 201.909 665.999 202.418 Q663.592 202.928 661.115 202.928 Q654.911 202.928 651.277 199.317 Q647.666 195.705 647.666 189.548 Q647.666 183.182 651.092 179.456 Q654.541 175.706 660.374 175.706 Q665.606 175.706 668.638 179.085 Q671.694 182.442 671.694 188.229 M667.434 186.979 Q667.388 183.483 665.467 181.4 Q663.569 179.317 660.421 179.317 Q656.856 179.317 654.703 181.331 Q652.573 183.344 652.249 187.002 L667.434 186.979 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M693.707 180.312 Q692.99 179.895 692.133 179.71 Q691.3 179.502 690.282 179.502 Q686.67 179.502 684.726 181.863 Q682.805 184.201 682.805 188.599 L682.805 202.256 L678.522 202.256 L678.522 176.331 L682.805 176.331 L682.805 180.358 Q684.147 177.997 686.3 176.863 Q688.453 175.706 691.532 175.706 Q691.971 175.706 692.504 175.775 Q693.036 175.821 693.684 175.937 L693.707 180.312 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M702.295 198.367 L702.295 212.117 L698.013 212.117 L698.013 176.331 L702.295 176.331 L702.295 180.266 Q703.638 177.951 705.675 176.84 Q707.735 175.706 710.582 175.706 Q715.305 175.706 718.244 179.456 Q721.207 183.206 721.207 189.317 Q721.207 195.428 718.244 199.178 Q715.305 202.928 710.582 202.928 Q707.735 202.928 705.675 201.817 Q703.638 200.682 702.295 198.367 M716.786 189.317 Q716.786 184.618 714.842 181.956 Q712.92 179.27 709.541 179.27 Q706.161 179.27 704.217 181.956 Q702.295 184.618 702.295 189.317 Q702.295 194.016 704.217 196.701 Q706.161 199.363 709.541 199.363 Q712.92 199.363 714.842 196.701 Q716.786 194.016 716.786 189.317 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M738.314 179.317 Q734.888 179.317 732.897 182.002 Q730.906 184.664 730.906 189.317 Q730.906 193.969 732.874 196.655 Q734.865 199.317 738.314 199.317 Q741.716 199.317 743.707 196.631 Q745.698 193.946 745.698 189.317 Q745.698 184.71 743.707 182.025 Q741.716 179.317 738.314 179.317 M738.314 175.706 Q743.869 175.706 747.04 179.317 Q750.212 182.928 750.212 189.317 Q750.212 195.682 747.04 199.317 Q743.869 202.928 738.314 202.928 Q732.735 202.928 729.564 199.317 Q726.416 195.682 726.416 189.317 Q726.416 182.928 729.564 179.317 Q732.735 175.706 738.314 175.706 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M757.272 166.238 L761.531 166.238 L761.531 202.256 L757.272 202.256 L757.272 166.238 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M782.225 189.224 Q777.063 189.224 775.073 190.405 Q773.082 191.585 773.082 194.432 Q773.082 196.701 774.563 198.043 Q776.068 199.363 778.638 199.363 Q782.179 199.363 784.309 196.863 Q786.462 194.34 786.462 190.173 L786.462 189.224 L782.225 189.224 M790.721 187.465 L790.721 202.256 L786.462 202.256 L786.462 198.321 Q785.003 200.682 782.827 201.817 Q780.651 202.928 777.503 202.928 Q773.522 202.928 771.161 200.705 Q768.823 198.46 768.823 194.71 Q768.823 190.335 771.739 188.113 Q774.679 185.891 780.489 185.891 L786.462 185.891 L786.462 185.474 Q786.462 182.534 784.517 180.937 Q782.596 179.317 779.101 179.317 Q776.878 179.317 774.772 179.849 Q772.665 180.381 770.721 181.446 L770.721 177.511 Q773.059 176.608 775.258 176.169 Q777.457 175.706 779.54 175.706 Q785.165 175.706 787.943 178.622 Q790.721 181.539 790.721 187.465 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M803.707 168.969 L803.707 176.331 L812.48 176.331 L812.48 179.641 L803.707 179.641 L803.707 193.715 Q803.707 196.886 804.563 197.789 Q805.443 198.692 808.105 198.692 L812.48 198.692 L812.48 202.256 L808.105 202.256 Q803.174 202.256 801.299 200.428 Q799.424 198.576 799.424 193.715 L799.424 179.641 L796.299 179.641 L796.299 176.331 L799.424 176.331 L799.424 168.969 L803.707 168.969 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M818.082 176.331 L822.341 176.331 L822.341 202.256 L818.082 202.256 L818.082 176.331 M818.082 166.238 L822.341 166.238 L822.341 171.632 L818.082 171.632 L818.082 166.238 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M841.299 179.317 Q837.873 179.317 835.883 182.002 Q833.892 184.664 833.892 189.317 Q833.892 193.969 835.859 196.655 Q837.85 199.317 841.299 199.317 Q844.702 199.317 846.693 196.631 Q848.683 193.946 848.683 189.317 Q848.683 184.71 846.693 182.025 Q844.702 179.317 841.299 179.317 M841.299 175.706 Q846.855 175.706 850.026 179.317 Q853.197 182.928 853.197 189.317 Q853.197 195.682 850.026 199.317 Q846.855 202.928 841.299 202.928 Q835.721 202.928 832.549 199.317 Q829.401 195.682 829.401 189.317 Q829.401 182.928 832.549 179.317 Q835.721 175.706 841.299 175.706 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M881.808 186.608 L881.808 202.256 L877.549 202.256 L877.549 186.747 Q877.549 183.067 876.114 181.238 Q874.679 179.409 871.808 179.409 Q868.359 179.409 866.369 181.608 Q864.378 183.807 864.378 187.604 L864.378 202.256 L860.095 202.256 L860.095 176.331 L864.378 176.331 L864.378 180.358 Q865.906 178.02 867.966 176.863 Q870.049 175.706 872.757 175.706 Q877.225 175.706 879.517 178.483 Q881.808 181.238 881.808 186.608 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip900)" style="stroke:#3da44d; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" stroke-dasharray="16, 10" points="289.282,236.816 405.338,236.816 "></polyline>
<path clip-path="url(#clip900)" d="M452.551 222.198 L452.551 227.129 Q450.19 224.93 447.505 223.842 Q444.843 222.754 441.834 222.754 Q435.908 222.754 432.76 226.388 Q429.612 229.999 429.612 236.851 Q429.612 243.68 432.76 247.314 Q435.908 250.925 441.834 250.925 Q444.843 250.925 447.505 249.837 Q450.19 248.749 452.551 246.55 L452.551 251.434 Q450.098 253.101 447.343 253.934 Q444.612 254.768 441.556 254.768 Q433.709 254.768 429.195 249.976 Q424.681 245.161 424.681 236.851 Q424.681 228.518 429.195 223.726 Q433.709 218.911 441.556 218.911 Q444.658 218.911 447.389 219.745 Q450.144 220.555 452.551 222.198 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M459.149 243.865 L459.149 228.171 L463.408 228.171 L463.408 243.703 Q463.408 247.383 464.843 249.235 Q466.278 251.064 469.148 251.064 Q472.598 251.064 474.588 248.865 Q476.602 246.666 476.602 242.87 L476.602 228.171 L480.861 228.171 L480.861 254.096 L476.602 254.096 L476.602 250.115 Q475.051 252.476 472.991 253.633 Q470.954 254.768 468.246 254.768 Q463.778 254.768 461.463 251.99 Q459.149 249.212 459.149 243.865 M469.866 227.546 L469.866 227.546 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M508.245 241.157 Q508.245 236.458 506.301 233.796 Q504.38 231.11 501 231.11 Q497.621 231.11 495.676 233.796 Q493.755 236.458 493.755 241.157 Q493.755 245.856 495.676 248.541 Q497.621 251.203 501 251.203 Q504.38 251.203 506.301 248.541 Q508.245 245.856 508.245 241.157 M493.755 232.106 Q495.097 229.791 497.134 228.68 Q499.195 227.546 502.042 227.546 Q506.764 227.546 509.704 231.296 Q512.667 235.046 512.667 241.157 Q512.667 247.268 509.704 251.018 Q506.764 254.768 502.042 254.768 Q499.195 254.768 497.134 253.657 Q495.097 252.522 493.755 250.207 L493.755 254.096 L489.472 254.096 L489.472 218.078 L493.755 218.078 L493.755 232.106 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M519.727 228.171 L523.986 228.171 L523.986 254.096 L519.727 254.096 L519.727 228.171 M519.727 218.078 L523.986 218.078 L523.986 223.472 L519.727 223.472 L519.727 218.078 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M551.555 229.166 L551.555 233.147 Q549.75 232.152 547.921 231.666 Q546.116 231.157 544.264 231.157 Q540.12 231.157 537.829 233.796 Q535.537 236.411 535.537 241.157 Q535.537 245.902 537.829 248.541 Q540.12 251.157 544.264 251.157 Q546.116 251.157 547.921 250.67 Q549.75 250.161 551.555 249.166 L551.555 253.101 Q549.773 253.934 547.852 254.351 Q545.954 254.768 543.801 254.768 Q537.944 254.768 534.495 251.087 Q531.046 247.407 531.046 241.157 Q531.046 234.814 534.518 231.18 Q538.014 227.546 544.079 227.546 Q546.046 227.546 547.921 227.962 Q549.796 228.356 551.555 229.166 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M594.935 220.671 L594.935 225.231 Q592.273 223.958 589.912 223.333 Q587.551 222.708 585.352 222.708 Q581.532 222.708 579.449 224.189 Q577.389 225.671 577.389 228.402 Q577.389 230.694 578.754 231.874 Q580.143 233.032 583.986 233.749 L586.81 234.328 Q592.041 235.323 594.518 237.846 Q597.018 240.346 597.018 244.559 Q597.018 249.582 593.639 252.175 Q590.282 254.768 583.777 254.768 Q581.324 254.768 578.546 254.212 Q575.791 253.657 572.828 252.569 L572.828 247.754 Q575.676 249.351 578.407 250.161 Q581.139 250.971 583.777 250.971 Q587.782 250.971 589.958 249.397 Q592.134 247.823 592.134 244.907 Q592.134 242.36 590.56 240.925 Q589.009 239.49 585.444 238.772 L582.597 238.217 Q577.365 237.175 575.028 234.953 Q572.69 232.731 572.69 228.772 Q572.69 224.189 575.907 221.55 Q579.148 218.911 584.819 218.911 Q587.25 218.911 589.773 219.351 Q592.296 219.791 594.935 220.671 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M608.245 250.207 L608.245 263.957 L603.963 263.957 L603.963 228.171 L608.245 228.171 L608.245 232.106 Q609.588 229.791 611.625 228.68 Q613.685 227.546 616.532 227.546 Q621.254 227.546 624.194 231.296 Q627.157 235.046 627.157 241.157 Q627.157 247.268 624.194 251.018 Q621.254 254.768 616.532 254.768 Q613.685 254.768 611.625 253.657 Q609.588 252.522 608.245 250.207 M622.736 241.157 Q622.736 236.458 620.791 233.796 Q618.87 231.11 615.49 231.11 Q612.111 231.11 610.166 233.796 Q608.245 236.458 608.245 241.157 Q608.245 245.856 610.166 248.541 Q612.111 251.203 615.49 251.203 Q618.87 251.203 620.791 248.541 Q622.736 245.856 622.736 241.157 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M634.217 218.078 L638.476 218.078 L638.476 254.096 L634.217 254.096 L634.217 218.078 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M647.388 228.171 L651.647 228.171 L651.647 254.096 L647.388 254.096 L647.388 228.171 M647.388 218.078 L651.647 218.078 L651.647 223.472 L647.388 223.472 L647.388 218.078 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M682.11 238.448 L682.11 254.096 L677.851 254.096 L677.851 238.587 Q677.851 234.907 676.416 233.078 Q674.981 231.249 672.11 231.249 Q668.661 231.249 666.671 233.448 Q664.68 235.647 664.68 239.444 L664.68 254.096 L660.397 254.096 L660.397 228.171 L664.68 228.171 L664.68 232.198 Q666.208 229.86 668.268 228.703 Q670.351 227.546 673.059 227.546 Q677.527 227.546 679.819 230.323 Q682.11 233.078 682.11 238.448 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip900)" d="M712.781 240.069 L712.781 242.152 L693.198 242.152 Q693.476 246.55 695.837 248.865 Q698.221 251.157 702.457 251.157 Q704.911 251.157 707.203 250.555 Q709.518 249.953 711.786 248.749 L711.786 252.777 Q709.494 253.749 707.087 254.258 Q704.68 254.768 702.203 254.768 Q695.999 254.768 692.365 251.157 Q688.754 247.545 688.754 241.388 Q688.754 235.022 692.18 231.296 Q695.629 227.546 701.462 227.546 Q706.693 227.546 709.726 230.925 Q712.781 234.282 712.781 240.069 M708.522 238.819 Q708.476 235.323 706.555 233.24 Q704.656 231.157 701.508 231.157 Q697.944 231.157 695.791 233.171 Q693.661 235.184 693.337 238.842 L708.522 238.819 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path></svg>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-interpolation-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Linear and Spline Interpolation of Cost Function <span class="math inline">\(\Phi(n)\)</span>.
</figcaption>
</figure>
</div>
</div>
<p>ここでは線形補間 (linear interpolation) と3次スプライン補間 (cubic spline interpolation) の両方を定義しました. 線形補間は2点間を直線で結ぶだけですが, スプライン補間はより滑らかな曲線で補間します. 詳細は <span class="citation" data-cites="kitao2024">北尾, 砂川, and 山田 (<a href="#ref-kitao2024" role="doc-biblioref">2024</a>)</span> の付録Bが参考になります.</p>
<p>このように実数上に定義された関数を用いれば, 通常の最適化問題のように解くことができます.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p>
<div id="optimization-comparison" class="cell" data-execution_count="1">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">u_interp</span>(n) <span class="op">=</span> <span class="fu">log</span>(n) <span class="op">-</span> <span class="fu">Φ_interp</span>(n)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">u_spline</span>(n) <span class="op">=</span> <span class="fu">log</span>(n) <span class="op">-</span> <span class="fu">Φ_spline</span>(n)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>sol_interp <span class="op">=</span> <span class="fu">optimize</span>(n <span class="op">-&gt;</span> <span class="fu">-u_interp</span>(n), <span class="fl">1.0</span>, <span class="fl">10.0</span>)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>sol_spline <span class="op">=</span> <span class="fu">optimize</span>(n <span class="op">-&gt;</span> <span class="fu">-u_spline</span>(n), <span class="fl">1.0</span>, <span class="fl">10.0</span>)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>(<span class="st">"Linear Interpolation: n = </span><span class="sc">$</span>(<span class="fu">round</span>(sol_interp.minimizer, digits<span class="op">=</span><span class="fl">4</span>))<span class="st">"</span>)</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>(<span class="st">"Cubic Spline: n = </span><span class="sc">$</span>(<span class="fu">round</span>(sol_spline.minimizer, digits<span class="op">=</span><span class="fl">4</span>))<span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear Interpolation: n = 5.5811
Cubic Spline: n = 5.5516</code></pre>
</div>
</div>
<p>今回の例では, 階乗は<a href="https://ja.wikipedia.org/wiki/%E3%82%AC%E3%83%B3%E3%83%9E%E9%96%A2%E6%95%B0">ガンマ関数</a> を用いて実数に拡張できるので, より厳密な解を求めることもできます.</p>
<div id="analytical-solution" class="cell" data-execution_count="1">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Φ</span>(n<span class="op">::</span><span class="dt">Real</span>; ϕ<span class="op">=</span><span class="fl">0.1</span>) <span class="op">=</span> ϕ <span class="op">*</span> <span class="fu">loggamma</span>(n <span class="op">+</span> <span class="fl">1</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">u_exact</span>(n) <span class="op">=</span> <span class="fu">log</span>(n) <span class="op">-</span> <span class="fu">Φ</span>(n)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>sol_exact <span class="op">=</span> <span class="fu">optimize</span>(n <span class="op">-&gt;</span> <span class="fu">-u_exact</span>(n), <span class="fl">1.0</span>, <span class="fl">10.0</span>)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>(<span class="st">"Exact Solution: n = </span><span class="sc">$</span>(<span class="fu">round</span>(sol_exact.minimizer, digits<span class="op">=</span><span class="fl">4</span>))<span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Exact Solution: n = 5.5512</code></pre>
</div>
</div>
</section>
<section id="ベルマン方程式の数値解法" class="level2">
<h2 class="anchored" data-anchor-id="ベルマン方程式の数値解法">ベルマン方程式の数値解法</h2>
<p>以下の無限期間代表的個人のモデルを考えます.</p>
<p><span class="math display">\[
\max_{\{c_t, k_{t+1}\}_{t=0}^{\infty}} \sum_{t=0}^{\infty} \beta^t u(c_t) \quad \text{s.t.} \quad c_t + k_{t+1} = f(k_t) + (1-\delta)k_t.
\]</span></p>
<p>これをベルマン方程式 <span class="math inline">\(V(k)\)</span> に書き換えた時の数値解法を考えます.</p>
<p><span class="math display">\[
V(k) = \max_{k'} \left\{u(f(k) + (1-\delta)k - k') + \beta V(k')\right\}
\]</span></p>
<p>大きく分けて, 2つの方法があります.</p>
<ol type="1">
<li><strong>Value Function Iteration</strong>
<ul>
<li>ベルマン方程式の不動点を直接求める方法</li>
<li>収束性が保証されているが, 収束速度は比較的遅い</li>
</ul></li>
<li><strong>Policy Function Iteration</strong>
<ul>
<li>政策関数の不動点を求める方法</li>
<li>収束性は保証されていないが, 収束速度は比較的速い</li>
</ul></li>
</ol>
<p>数値計算に用いるために, 以下の関数形とパラメータを仮定します.</p>
<ul>
<li><span class="math inline">\(u(c) = \log c\)</span></li>
<li><span class="math inline">\(f(k) = k^\alpha\)</span></li>
<li><span class="math inline">\(\beta = 0.96\)</span></li>
<li><span class="math inline">\(\delta = 0.1\)</span></li>
<li><span class="math inline">\(\alpha = 0.36\)</span></li>
</ul>
<div id="model-deterministic" class="cell" data-execution_count="1">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb12"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="pp">@kwdef</span> <span class="kw">struct</span> Model{TF<span class="op">&lt;:</span><span class="dt">AbstractFloat</span>,TI<span class="op">&lt;:</span><span class="dt">Integer</span>}</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Parameters</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>    α<span class="op">::</span><span class="dt">TF </span><span class="op">=</span> <span class="fl">0.4</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    β<span class="op">::</span><span class="dt">TF </span><span class="op">=</span> <span class="fl">0.96</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    δ<span class="op">::</span><span class="dt">TF </span><span class="op">=</span> <span class="fl">0.1</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Value Function</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>    n_k<span class="op">::</span><span class="dt">TI </span><span class="op">=</span> <span class="fl">101</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>    k_min<span class="op">::</span><span class="dt">TF </span><span class="op">=</span> <span class="fl">0.05</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>    k_max<span class="op">::</span><span class="dt">TF </span><span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>    k_grid<span class="op">::</span><span class="dt">Vector{TF} </span><span class="op">=</span> <span class="fu">collect</span>(<span class="fu">range</span>(k_min, k_max, length<span class="op">=</span>n_k))</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>    V<span class="op">::</span><span class="dt">Vector{TF} </span><span class="op">=</span> <span class="fu">zeros</span>(n_k)</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>    h<span class="op">::</span><span class="dt">Vector{TF} </span><span class="op">=</span> <span class="fu">copy</span>(k_grid)</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a><span class="fu">u</span>(c; m) <span class="op">=</span> <span class="fu">log</span>(c)</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a><span class="fu">u′</span>(c; m) <span class="op">=</span> <span class="fl">1</span> <span class="op">/</span> c</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a><span class="fu">f</span>(k; m) <span class="op">=</span> k<span class="op">^</span>m.α</span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a><span class="fu">f′</span>(k; m) <span class="op">=</span> m.α <span class="op">*</span> k<span class="op">^</span>(m.α <span class="op">-</span> <span class="fl">1</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<section id="value-function-iteration" class="level3">
<h3 class="anchored" data-anchor-id="value-function-iteration">Value Function Iteration</h3>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Value Function Iteration
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li><span class="math inline">\(k\)</span> の定義域を <span class="math inline">\([k_{\min}, k_{\max}]\)</span> を <span class="math inline">\(n\)</span> 個のグリッドポイントに分割する.</li>
<li><span class="math inline">\(V(k)\)</span> の初期値 <span class="math inline">\(V^0\)</span> を適当に設定する. つまり, <span class="math inline">\(V^0 = (V_0^0, V_1^0, \dots, V_n^0)\)</span> に適当な値を設定する.</li>
<li><span class="math inline">\(V^0\)</span> をベルマン方程式の右辺に代入し, 各 <span class="math inline">\(k_i\)</span> に対して <span class="math inline">\(V_i^1\)</span> を計算する.</li>
<li>2-3を繰り返す. 収束条件は以下のように設定する.
<ul>
<li><span class="math inline">\(|V^N - V^{N-1}| &lt; \varepsilon\)</span></li>
<li><span class="math inline">\(|V^N - V^{N-1}|\)</span> はベクトルのノルム</li>
<li><span class="math inline">\(\varepsilon\)</span> は十分小さな値を設定する. 例えば, <span class="math inline">\(\epsilon = 10^{-6}\)</span> とする</li>
</ul></li>
</ol>
</div>
</div>
<p>なおこのような収束の閾値 <span class="math inline">\(\varepsilon\)</span> を tolerance と呼ぶことがあります.</p>
<div id="value-function-iteration" class="cell" data-execution_count="1">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">vfi!</span>(m<span class="op">::</span><span class="dt">Model</span>; tol<span class="op">=</span><span class="fl">1e-6</span>, max_iter<span class="op">=</span><span class="fl">1000</span>, verbose<span class="op">=</span><span class="cn">true</span>)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>    (; k_grid, β, δ) <span class="op">=</span> m</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    iter, dist <span class="op">=</span> <span class="fl">0</span>, <span class="cn">Inf</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    V_new <span class="op">=</span> <span class="fu">similar</span>(m.V)</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> dist <span class="op">&gt;</span> tol <span class="op">&amp;&amp;</span> iter <span class="op">&lt;</span> max_iter</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> (i_k, k) <span class="kw">in</span> <span class="fu">enumerate</span>(k_grid)</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>            c_min <span class="op">=</span> <span class="fl">1e-9</span> <span class="co"># consumption cannot be negative</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>            V_new[i_k] <span class="op">=</span> <span class="fu">maximum</span>(</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>                <span class="fu">log</span>(<span class="fu">max</span>(<span class="fu">f</span>(k; m) <span class="op">+</span> (<span class="fl">1</span> <span class="op">-</span> δ) <span class="op">*</span> k <span class="op">-</span> k′, c_min)) <span class="op">+</span> β <span class="op">*</span> m.V[i_k′]</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> (i_k′, k′) <span class="kw">in</span> <span class="fu">enumerate</span>(k_grid)</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">end</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>        dist <span class="op">=</span> <span class="fu">maximum</span>(abs, V_new <span class="op">-</span> m.V)</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>        m.V <span class="op">.=</span> V_new</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>        iter <span class="op">+=</span> <span class="fl">1</span></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> verbose</span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> iter <span class="op">==</span> max_iter</span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>            <span class="fu">println</span>(<span class="st">"Warning: Maximum iterations reached."</span>)</span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span></span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>            <span class="fu">println</span>(<span class="st">"Converged in </span><span class="sc">$</span>iter<span class="st"> iterations."</span>)</span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">end</span></span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="cn">nothing</span></span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="cell-fig-vfi" class="cell" data-execution_count="1">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb14"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>m <span class="op">=</span> <span class="fu">Model</span>()</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">vfi!</span>(m)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(m.k_grid, m.V, label<span class="op">=</span><span class="cn">false</span>, xlabel<span class="op">=</span>L<span class="st">"Capital </span><span class="sc">$</span>k<span class="sc">$</span><span class="st">", </span>ylabel<span class="st">=L"</span>Value <span class="op">$</span><span class="fu">V</span>(k)<span class="op">$</span><span class="st">")</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Converged in 315 iterations.</code></pre>
</div>
<div id="fig-vfi" class="cell-output cell-output-display quarto-float quarto-figure quarto-figure-center anchored" data-execution_count="1">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-vfi-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<!--?xml version="1.0" encoding="utf-8"?-->
<svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" width="500" height="309" viewbox="0 0 2000 1236">
<defs>
  <clippath id="clip960">
    <rect x="0" y="0" width="2000" height="1236"></rect>
  </clippath>
</defs>
<path clip-path="url(#clip960)" d="M0 1236 L2000 1236 L2000 1.24345e-14 L0 1.24345e-14  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<defs>
  <clippath id="clip961">
    <rect x="400" y="0" width="1401" height="1236"></rect>
  </clippath>
</defs>
<path clip-path="url(#clip960)" d="M279.897 1068.81 L1952.76 1068.81 L1952.76 47.2441 L279.897 47.2441  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<defs>
  <clippath id="clip962">
    <rect x="279" y="47" width="1674" height="1023"></rect>
  </clippath>
</defs>
<polyline clip-path="url(#clip962)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="502.594,1068.81 502.594,47.2441 "></polyline>
<polyline clip-path="url(#clip962)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="853.298,1068.81 853.298,47.2441 "></polyline>
<polyline clip-path="url(#clip962)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1204,1068.81 1204,47.2441 "></polyline>
<polyline clip-path="url(#clip962)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1554.71,1068.81 1554.71,47.2441 "></polyline>
<polyline clip-path="url(#clip962)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1905.41,1068.81 1905.41,47.2441 "></polyline>
<polyline clip-path="url(#clip962)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="279.897,953.997 1952.76,953.997 "></polyline>
<polyline clip-path="url(#clip962)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="279.897,768.19 1952.76,768.19 "></polyline>
<polyline clip-path="url(#clip962)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="279.897,582.384 1952.76,582.384 "></polyline>
<polyline clip-path="url(#clip962)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="279.897,396.577 1952.76,396.577 "></polyline>
<polyline clip-path="url(#clip962)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="279.897,210.77 1952.76,210.77 "></polyline>
<polyline clip-path="url(#clip960)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="279.897,1068.81 1952.76,1068.81 "></polyline>
<polyline clip-path="url(#clip960)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="502.594,1068.81 502.594,1049.91 "></polyline>
<polyline clip-path="url(#clip960)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="853.298,1068.81 853.298,1049.91 "></polyline>
<polyline clip-path="url(#clip960)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1204,1068.81 1204,1049.91 "></polyline>
<polyline clip-path="url(#clip960)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1554.71,1068.81 1554.71,1049.91 "></polyline>
<polyline clip-path="url(#clip960)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1905.41,1068.81 1905.41,1049.91 "></polyline>
<path clip-path="url(#clip960)" d="M480.592 1096.53 Q476.981 1096.53 475.152 1100.1 Q473.347 1103.64 473.347 1110.77 Q473.347 1117.87 475.152 1121.44 Q476.981 1124.98 480.592 1124.98 Q484.226 1124.98 486.032 1121.44 Q487.86 1117.87 487.86 1110.77 Q487.86 1103.64 486.032 1100.1 Q484.226 1096.53 480.592 1096.53 M480.592 1092.83 Q486.402 1092.83 489.458 1097.43 Q492.536 1102.02 492.536 1110.77 Q492.536 1119.49 489.458 1124.1 Q486.402 1128.68 480.592 1128.68 Q474.782 1128.68 471.703 1124.1 Q468.648 1119.49 468.648 1110.77 Q468.648 1102.02 471.703 1097.43 Q474.782 1092.83 480.592 1092.83 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip960)" d="M500.754 1122.13 L505.638 1122.13 L505.638 1128.01 L500.754 1128.01 L500.754 1122.13 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip960)" d="M516.633 1124.08 L524.272 1124.08 L524.272 1097.71 L515.962 1099.38 L515.962 1095.12 L524.226 1093.45 L528.902 1093.45 L528.902 1124.08 L536.541 1124.08 L536.541 1128.01 L516.633 1128.01 L516.633 1124.08 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip960)" d="M831.481 1096.53 Q827.87 1096.53 826.041 1100.1 Q824.236 1103.64 824.236 1110.77 Q824.236 1117.87 826.041 1121.44 Q827.87 1124.98 831.481 1124.98 Q835.116 1124.98 836.921 1121.44 Q838.75 1117.87 838.75 1110.77 Q838.75 1103.64 836.921 1100.1 Q835.116 1096.53 831.481 1096.53 M831.481 1092.83 Q837.291 1092.83 840.347 1097.43 Q843.426 1102.02 843.426 1110.77 Q843.426 1119.49 840.347 1124.1 Q837.291 1128.68 831.481 1128.68 Q825.671 1128.68 822.592 1124.1 Q819.537 1119.49 819.537 1110.77 Q819.537 1102.02 822.592 1097.43 Q825.671 1092.83 831.481 1092.83 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip960)" d="M851.643 1122.13 L856.527 1122.13 L856.527 1128.01 L851.643 1128.01 L851.643 1122.13 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip960)" d="M870.74 1124.08 L887.06 1124.08 L887.06 1128.01 L865.115 1128.01 L865.115 1124.08 Q867.777 1121.32 872.361 1116.69 Q876.967 1112.04 878.148 1110.7 Q880.393 1108.17 881.273 1106.44 Q882.175 1104.68 882.175 1102.99 Q882.175 1100.23 880.231 1098.5 Q878.31 1096.76 875.208 1096.76 Q873.009 1096.76 870.555 1097.53 Q868.125 1098.29 865.347 1099.84 L865.347 1095.12 Q868.171 1093.98 870.625 1093.41 Q873.078 1092.83 875.115 1092.83 Q880.486 1092.83 883.68 1095.51 Q886.874 1098.2 886.874 1102.69 Q886.874 1104.82 886.064 1106.74 Q885.277 1108.64 883.171 1111.23 Q882.592 1111.9 879.49 1115.12 Q876.388 1118.31 870.74 1124.08 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip960)" d="M1181.71 1096.53 Q1178.1 1096.53 1176.27 1100.1 Q1174.47 1103.64 1174.47 1110.77 Q1174.47 1117.87 1176.27 1121.44 Q1178.1 1124.98 1181.71 1124.98 Q1185.35 1124.98 1187.15 1121.44 Q1188.98 1117.87 1188.98 1110.77 Q1188.98 1103.64 1187.15 1100.1 Q1185.35 1096.53 1181.71 1096.53 M1181.71 1092.83 Q1187.52 1092.83 1190.58 1097.43 Q1193.66 1102.02 1193.66 1110.77 Q1193.66 1119.49 1190.58 1124.1 Q1187.52 1128.68 1181.71 1128.68 Q1175.9 1128.68 1172.82 1124.1 Q1169.77 1119.49 1169.77 1110.77 Q1169.77 1102.02 1172.82 1097.43 Q1175.9 1092.83 1181.71 1092.83 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip960)" d="M1201.87 1122.13 L1206.76 1122.13 L1206.76 1128.01 L1201.87 1128.01 L1201.87 1122.13 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip960)" d="M1231.11 1109.38 Q1234.47 1110.1 1236.34 1112.36 Q1238.24 1114.63 1238.24 1117.97 Q1238.24 1123.08 1234.72 1125.88 Q1231.2 1128.68 1224.72 1128.68 Q1222.54 1128.68 1220.23 1128.24 Q1217.94 1127.83 1215.48 1126.97 L1215.48 1122.46 Q1217.43 1123.59 1219.74 1124.17 Q1222.06 1124.75 1224.58 1124.75 Q1228.98 1124.75 1231.27 1123.01 Q1233.59 1121.28 1233.59 1117.97 Q1233.59 1114.91 1231.43 1113.2 Q1229.3 1111.46 1225.48 1111.46 L1221.46 1111.46 L1221.46 1107.62 L1225.67 1107.62 Q1229.12 1107.62 1230.95 1106.25 Q1232.78 1104.86 1232.78 1102.27 Q1232.78 1099.61 1230.88 1098.2 Q1229 1096.76 1225.48 1096.76 Q1223.56 1096.76 1221.36 1097.18 Q1219.16 1097.6 1216.53 1098.47 L1216.53 1094.31 Q1219.19 1093.57 1221.5 1093.2 Q1223.84 1092.83 1225.9 1092.83 Q1231.22 1092.83 1234.33 1095.26 Q1237.43 1097.66 1237.43 1101.78 Q1237.43 1104.66 1235.78 1106.65 Q1234.14 1108.61 1231.11 1109.38 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip960)" d="M1531.85 1096.53 Q1528.24 1096.53 1526.41 1100.1 Q1524.6 1103.64 1524.6 1110.77 Q1524.6 1117.87 1526.41 1121.44 Q1528.24 1124.98 1531.85 1124.98 Q1535.48 1124.98 1537.29 1121.44 Q1539.12 1117.87 1539.12 1110.77 Q1539.12 1103.64 1537.29 1100.1 Q1535.48 1096.53 1531.85 1096.53 M1531.85 1092.83 Q1537.66 1092.83 1540.71 1097.43 Q1543.79 1102.02 1543.79 1110.77 Q1543.79 1119.49 1540.71 1124.1 Q1537.66 1128.68 1531.85 1128.68 Q1526.04 1128.68 1522.96 1124.1 Q1519.9 1119.49 1519.9 1110.77 Q1519.9 1102.02 1522.96 1097.43 Q1526.04 1092.83 1531.85 1092.83 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip960)" d="M1552.01 1122.13 L1556.89 1122.13 L1556.89 1128.01 L1552.01 1128.01 L1552.01 1122.13 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip960)" d="M1579.93 1097.53 L1568.12 1115.97 L1579.93 1115.97 L1579.93 1097.53 M1578.7 1093.45 L1584.58 1093.45 L1584.58 1115.97 L1589.51 1115.97 L1589.51 1119.86 L1584.58 1119.86 L1584.58 1128.01 L1579.93 1128.01 L1579.93 1119.86 L1564.32 1119.86 L1564.32 1115.35 L1578.7 1093.45 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip960)" d="M1883.29 1096.53 Q1879.68 1096.53 1877.85 1100.1 Q1876.05 1103.64 1876.05 1110.77 Q1876.05 1117.87 1877.85 1121.44 Q1879.68 1124.98 1883.29 1124.98 Q1886.93 1124.98 1888.73 1121.44 Q1890.56 1117.87 1890.56 1110.77 Q1890.56 1103.64 1888.73 1100.1 Q1886.93 1096.53 1883.29 1096.53 M1883.29 1092.83 Q1889.1 1092.83 1892.16 1097.43 Q1895.24 1102.02 1895.24 1110.77 Q1895.24 1119.49 1892.16 1124.1 Q1889.1 1128.68 1883.29 1128.68 Q1877.48 1128.68 1874.4 1124.1 Q1871.35 1119.49 1871.35 1110.77 Q1871.35 1102.02 1874.4 1097.43 Q1877.48 1092.83 1883.29 1092.83 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip960)" d="M1903.45 1122.13 L1908.34 1122.13 L1908.34 1128.01 L1903.45 1128.01 L1903.45 1122.13 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip960)" d="M1918.57 1093.45 L1936.93 1093.45 L1936.93 1097.39 L1922.85 1097.39 L1922.85 1105.86 Q1923.87 1105.51 1924.89 1105.35 Q1925.91 1105.16 1926.93 1105.16 Q1932.71 1105.16 1936.09 1108.34 Q1939.47 1111.51 1939.47 1116.92 Q1939.47 1122.5 1936 1125.6 Q1932.53 1128.68 1926.21 1128.68 Q1924.03 1128.68 1921.76 1128.31 Q1919.52 1127.94 1917.11 1127.2 L1917.11 1122.5 Q1919.2 1123.64 1921.42 1124.19 Q1923.64 1124.75 1926.12 1124.75 Q1930.12 1124.75 1932.46 1122.64 Q1934.8 1120.53 1934.8 1116.92 Q1934.8 1113.31 1932.46 1111.21 Q1930.12 1109.1 1926.12 1109.1 Q1924.24 1109.1 1922.37 1109.52 Q1920.51 1109.93 1918.57 1110.81 L1918.57 1093.45 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip960)" d="M1014.82 1157.6 L1014.82 1164.38 Q1011.57 1161.36 1007.88 1159.86 Q1004.22 1158.37 1000.08 1158.37 Q991.936 1158.37 987.607 1163.36 Q983.278 1168.33 983.278 1177.75 Q983.278 1187.14 987.607 1192.14 Q991.936 1197.1 1000.08 1197.1 Q1004.22 1197.1 1007.88 1195.61 Q1011.57 1194.11 1014.82 1191.09 L1014.82 1197.8 Q1011.45 1200.09 1007.66 1201.24 Q1003.9 1202.38 999.702 1202.38 Q988.912 1202.38 982.705 1195.8 Q976.499 1189.18 976.499 1177.75 Q976.499 1166.29 982.705 1159.7 Q988.912 1153.08 999.702 1153.08 Q1003.97 1153.08 1007.72 1154.23 Q1011.51 1155.34 1014.82 1157.6 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip960)" d="M1040.7 1183.54 Q1033.6 1183.54 1030.86 1185.17 Q1028.12 1186.79 1028.12 1190.7 Q1028.12 1193.82 1030.16 1195.67 Q1032.23 1197.48 1035.76 1197.48 Q1040.63 1197.48 1043.56 1194.05 Q1046.52 1190.58 1046.52 1184.85 L1046.52 1183.54 L1040.7 1183.54 M1052.38 1181.12 L1052.38 1201.46 L1046.52 1201.46 L1046.52 1196.05 Q1044.52 1199.3 1041.52 1200.86 Q1038.53 1202.38 1034.2 1202.38 Q1028.73 1202.38 1025.48 1199.33 Q1022.27 1196.24 1022.27 1191.09 Q1022.27 1185.07 1026.28 1182.01 Q1030.32 1178.96 1038.31 1178.96 L1046.52 1178.96 L1046.52 1178.39 Q1046.52 1174.34 1043.85 1172.15 Q1041.21 1169.92 1036.4 1169.92 Q1033.34 1169.92 1030.45 1170.65 Q1027.55 1171.38 1024.88 1172.85 L1024.88 1167.44 Q1028.09 1166.2 1031.12 1165.59 Q1034.14 1164.95 1037 1164.95 Q1044.74 1164.95 1048.56 1168.96 Q1052.38 1172.98 1052.38 1181.12 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip960)" d="M1070.11 1196.11 L1070.11 1215.02 L1064.22 1215.02 L1064.22 1165.81 L1070.11 1165.81 L1070.11 1171.22 Q1071.95 1168.04 1074.75 1166.51 Q1077.59 1164.95 1081.5 1164.95 Q1087.99 1164.95 1092.04 1170.11 Q1096.11 1175.27 1096.11 1183.67 Q1096.11 1192.07 1092.04 1197.23 Q1087.99 1202.38 1081.5 1202.38 Q1077.59 1202.38 1074.75 1200.86 Q1071.95 1199.3 1070.11 1196.11 M1090.03 1183.67 Q1090.03 1177.21 1087.36 1173.55 Q1084.72 1169.86 1080.07 1169.86 Q1075.42 1169.86 1072.75 1173.55 Q1070.11 1177.21 1070.11 1183.67 Q1070.11 1190.13 1072.75 1193.82 Q1075.42 1197.48 1080.07 1197.48 Q1084.72 1197.48 1087.36 1193.82 Q1090.03 1190.13 1090.03 1183.67 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip960)" d="M1105.82 1165.81 L1111.67 1165.81 L1111.67 1201.46 L1105.82 1201.46 L1105.82 1165.81 M1105.82 1151.94 L1111.67 1151.94 L1111.67 1159.35 L1105.82 1159.35 L1105.82 1151.94 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip960)" d="M1129.72 1155.69 L1129.72 1165.81 L1141.78 1165.81 L1141.78 1170.37 L1129.72 1170.37 L1129.72 1189.72 Q1129.72 1194.08 1130.9 1195.32 Q1132.11 1196.56 1135.77 1196.56 L1141.78 1196.56 L1141.78 1201.46 L1135.77 1201.46 Q1128.99 1201.46 1126.41 1198.95 Q1123.83 1196.4 1123.83 1189.72 L1123.83 1170.37 L1119.54 1170.37 L1119.54 1165.81 L1123.83 1165.81 L1123.83 1155.69 L1129.72 1155.69 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip960)" d="M1165.69 1183.54 Q1158.59 1183.54 1155.85 1185.17 Q1153.12 1186.79 1153.12 1190.7 Q1153.12 1193.82 1155.15 1195.67 Q1157.22 1197.48 1160.75 1197.48 Q1165.62 1197.48 1168.55 1194.05 Q1171.51 1190.58 1171.51 1184.85 L1171.51 1183.54 L1165.69 1183.54 M1177.37 1181.12 L1177.37 1201.46 L1171.51 1201.46 L1171.51 1196.05 Q1169.51 1199.3 1166.52 1200.86 Q1163.52 1202.38 1159.19 1202.38 Q1153.72 1202.38 1150.47 1199.33 Q1147.26 1196.24 1147.26 1191.09 Q1147.26 1185.07 1151.27 1182.01 Q1155.31 1178.96 1163.3 1178.96 L1171.51 1178.96 L1171.51 1178.39 Q1171.51 1174.34 1168.84 1172.15 Q1166.2 1169.92 1161.39 1169.92 Q1158.34 1169.92 1155.44 1170.65 Q1152.54 1171.38 1149.87 1172.85 L1149.87 1167.44 Q1153.08 1166.2 1156.11 1165.59 Q1159.13 1164.95 1162 1164.95 Q1169.73 1164.95 1173.55 1168.96 Q1177.37 1172.98 1177.37 1181.12 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip960)" d="M1189.43 1151.94 L1195.29 1151.94 L1195.29 1201.46 L1189.43 1201.46 L1189.43 1151.94 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip960)" d="M1251.97 1176.47 Q1251.97 1178.31 1250.85 1179.4 Q1249.75 1180.5 1248.37 1180.5 Q1247.14 1180.5 1246.5 1179.79 Q1245.86 1179.08 1245.86 1178.18 Q1245.86 1177.79 1246.02 1177.31 Q1246.18 1176.79 1246.53 1176.18 Q1246.92 1175.57 1247.72 1175.12 Q1248.53 1174.67 1249.62 1174.6 Q1249.4 1174.38 1249.33 1174.34 Q1248.85 1173.96 1247.95 1173.83 Q1247.82 1173.76 1247.37 1173.76 Q1245.15 1173.76 1242.89 1175.41 Q1240.67 1177.02 1237.93 1180.08 Q1234.49 1183.65 1232.26 1184.97 Q1242.02 1186.26 1242.02 1191.9 Q1242.02 1192.83 1241.77 1193.96 Q1241.25 1196.08 1241.25 1197.63 Q1241.25 1200.72 1243.34 1200.72 Q1245.37 1200.72 1246.66 1198.66 Q1247.98 1196.6 1249.08 1192.57 Q1249.24 1191.83 1249.4 1191.61 Q1249.56 1191.38 1250.01 1191.38 Q1250.82 1191.38 1250.82 1192.03 Q1250.07 1195.79 1248.43 1198.69 Q1246.34 1202.2 1243.21 1202.2 Q1240.61 1202.2 1238.87 1200.4 Q1237.16 1198.56 1237.16 1195.66 Q1237.16 1194.96 1237.42 1193.35 Q1237.61 1192.7 1237.61 1191.96 Q1237.61 1190.45 1236.77 1189.32 Q1235.94 1188.16 1234.58 1187.58 Q1233.23 1187 1232.1 1186.74 Q1231.01 1186.45 1229.95 1186.36 Q1226.73 1199.98 1226.27 1200.82 Q1225.98 1201.4 1225.34 1201.78 Q1224.7 1202.2 1224.02 1202.2 Q1223.38 1202.2 1222.73 1201.75 Q1222.12 1201.33 1222.12 1200.33 Q1222.12 1199.82 1222.38 1198.89 L1231.94 1160.88 L1232.14 1159.59 Q1232.14 1159.21 1231.97 1159.01 Q1231.85 1158.79 1231.07 1158.63 Q1230.33 1158.47 1228.85 1158.47 Q1228.24 1158.47 1227.95 1158.43 Q1227.69 1158.4 1227.47 1158.24 Q1227.24 1158.05 1227.24 1157.66 Q1227.24 1157.11 1227.47 1156.82 Q1227.72 1156.5 1227.92 1156.44 Q1228.11 1156.37 1228.5 1156.34 Q1229.04 1156.31 1230.88 1156.15 Q1232.72 1155.95 1234.29 1155.83 Q1235.87 1155.7 1236.55 1155.7 Q1236.93 1155.7 1237.13 1155.89 Q1237.35 1156.05 1237.39 1156.24 L1237.42 1156.41 L1230.56 1184.23 Q1233.39 1183.1 1237.87 1178.11 Q1243.05 1172.32 1247.5 1172.32 Q1249.59 1172.32 1250.78 1173.6 Q1251.97 1174.86 1251.97 1176.47 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip960)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="279.897,1068.81 279.897,47.2441 "></polyline>
<polyline clip-path="url(#clip960)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="279.897,953.997 298.795,953.997 "></polyline>
<polyline clip-path="url(#clip960)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="279.897,768.19 298.795,768.19 "></polyline>
<polyline clip-path="url(#clip960)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="279.897,582.384 298.795,582.384 "></polyline>
<polyline clip-path="url(#clip960)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="279.897,396.577 298.795,396.577 "></polyline>
<polyline clip-path="url(#clip960)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="279.897,210.77 298.795,210.77 "></polyline>
<path clip-path="url(#clip960)" d="M112.791 954.449 L142.467 954.449 L142.467 958.384 L112.791 958.384 L112.791 954.449 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip960)" d="M153.37 967.342 L161.009 967.342 L161.009 940.977 L152.698 942.643 L152.698 938.384 L160.962 936.717 L165.638 936.717 L165.638 967.342 L173.277 967.342 L173.277 971.277 L153.37 971.277 L153.37 967.342 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip960)" d="M183.532 967.342 L191.17 967.342 L191.17 940.977 L182.86 942.643 L182.86 938.384 L191.124 936.717 L195.8 936.717 L195.8 967.342 L203.439 967.342 L203.439 971.277 L183.532 971.277 L183.532 967.342 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip960)" d="M212.883 965.398 L217.767 965.398 L217.767 971.277 L212.883 971.277 L212.883 965.398 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip960)" d="M237.953 939.796 Q234.341 939.796 232.513 943.361 Q230.707 946.903 230.707 954.032 Q230.707 961.139 232.513 964.703 Q234.341 968.245 237.953 968.245 Q241.587 968.245 243.392 964.703 Q245.221 961.139 245.221 954.032 Q245.221 946.903 243.392 943.361 Q241.587 939.796 237.953 939.796 M237.953 936.092 Q243.763 936.092 246.818 940.699 Q249.897 945.282 249.897 954.032 Q249.897 962.759 246.818 967.365 Q243.763 971.949 237.953 971.949 Q232.142 971.949 229.064 967.365 Q226.008 962.759 226.008 954.032 Q226.008 945.282 229.064 940.699 Q232.142 936.092 237.953 936.092 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip960)" d="M113.787 768.642 L143.462 768.642 L143.462 772.577 L113.787 772.577 L113.787 768.642 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip960)" d="M154.365 781.535 L162.004 781.535 L162.004 755.17 L153.694 756.836 L153.694 752.577 L161.958 750.91 L166.634 750.91 L166.634 781.535 L174.272 781.535 L174.272 785.47 L154.365 785.47 L154.365 781.535 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip960)" d="M193.717 753.989 Q190.106 753.989 188.277 757.554 Q186.471 761.096 186.471 768.225 Q186.471 775.332 188.277 778.896 Q190.106 782.438 193.717 782.438 Q197.351 782.438 199.156 778.896 Q200.985 775.332 200.985 768.225 Q200.985 761.096 199.156 757.554 Q197.351 753.989 193.717 753.989 M193.717 750.285 Q199.527 750.285 202.582 754.892 Q205.661 759.475 205.661 768.225 Q205.661 776.952 202.582 781.558 Q199.527 786.142 193.717 786.142 Q187.907 786.142 184.828 781.558 Q181.772 776.952 181.772 768.225 Q181.772 759.475 184.828 754.892 Q187.907 750.285 193.717 750.285 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip960)" d="M213.879 779.591 L218.763 779.591 L218.763 785.47 L213.879 785.47 L213.879 779.591 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip960)" d="M228.994 750.91 L247.351 750.91 L247.351 754.846 L233.277 754.846 L233.277 763.318 Q234.295 762.971 235.314 762.809 Q236.332 762.623 237.351 762.623 Q243.138 762.623 246.517 765.795 Q249.897 768.966 249.897 774.383 Q249.897 779.961 246.425 783.063 Q242.953 786.142 236.633 786.142 Q234.457 786.142 232.189 785.771 Q229.943 785.401 227.536 784.66 L227.536 779.961 Q229.619 781.096 231.841 781.651 Q234.064 782.207 236.541 782.207 Q240.545 782.207 242.883 780.1 Q245.221 777.994 245.221 774.383 Q245.221 770.771 242.883 768.665 Q240.545 766.559 236.541 766.559 Q234.666 766.559 232.791 766.975 Q230.939 767.392 228.994 768.272 L228.994 750.91 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip960)" d="M112.791 582.835 L142.467 582.835 L142.467 586.77 L112.791 586.77 L112.791 582.835 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip960)" d="M153.37 595.728 L161.009 595.728 L161.009 569.363 L152.698 571.029 L152.698 566.77 L160.962 565.104 L165.638 565.104 L165.638 595.728 L173.277 595.728 L173.277 599.664 L153.37 599.664 L153.37 595.728 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip960)" d="M192.721 568.182 Q189.11 568.182 187.282 571.747 Q185.476 575.289 185.476 582.418 Q185.476 589.525 187.282 593.089 Q189.11 596.631 192.721 596.631 Q196.356 596.631 198.161 593.089 Q199.99 589.525 199.99 582.418 Q199.99 575.289 198.161 571.747 Q196.356 568.182 192.721 568.182 M192.721 564.479 Q198.531 564.479 201.587 569.085 Q204.666 573.668 204.666 582.418 Q204.666 591.145 201.587 595.752 Q198.531 600.335 192.721 600.335 Q186.911 600.335 183.832 595.752 Q180.777 591.145 180.777 582.418 Q180.777 573.668 183.832 569.085 Q186.911 564.479 192.721 564.479 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip960)" d="M212.883 593.784 L217.767 593.784 L217.767 599.664 L212.883 599.664 L212.883 593.784 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip960)" d="M237.953 568.182 Q234.341 568.182 232.513 571.747 Q230.707 575.289 230.707 582.418 Q230.707 589.525 232.513 593.089 Q234.341 596.631 237.953 596.631 Q241.587 596.631 243.392 593.089 Q245.221 589.525 245.221 582.418 Q245.221 575.289 243.392 571.747 Q241.587 568.182 237.953 568.182 M237.953 564.479 Q243.763 564.479 246.818 569.085 Q249.897 573.668 249.897 582.418 Q249.897 591.145 246.818 595.752 Q243.763 600.335 237.953 600.335 Q232.142 600.335 229.064 595.752 Q226.008 591.145 226.008 582.418 Q226.008 573.668 229.064 569.085 Q232.142 564.479 237.953 564.479 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip960)" d="M143.948 397.028 L173.624 397.028 L173.624 400.963 L143.948 400.963 L143.948 397.028 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip960)" d="M183.856 413.139 L183.856 408.88 Q185.615 409.713 187.42 410.153 Q189.226 410.593 190.962 410.593 Q195.592 410.593 198.022 407.491 Q200.476 404.366 200.823 398.023 Q199.481 400.014 197.42 401.079 Q195.36 402.144 192.86 402.144 Q187.675 402.144 184.643 399.019 Q181.633 395.871 181.633 390.431 Q181.633 385.107 184.782 381.889 Q187.93 378.672 193.161 378.672 Q199.156 378.672 202.305 383.278 Q205.476 387.861 205.476 396.611 Q205.476 404.783 201.587 409.667 Q197.721 414.528 191.17 414.528 Q189.411 414.528 187.606 414.181 Q185.8 413.833 183.856 413.139 M193.161 398.486 Q196.309 398.486 198.138 396.334 Q199.99 394.181 199.99 390.431 Q199.99 386.704 198.138 384.551 Q196.309 382.375 193.161 382.375 Q190.013 382.375 188.161 384.551 Q186.332 386.704 186.332 390.431 Q186.332 394.181 188.161 396.334 Q190.013 398.486 193.161 398.486 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip960)" d="M213.879 407.977 L218.763 407.977 L218.763 413.857 L213.879 413.857 L213.879 407.977 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip960)" d="M228.994 379.297 L247.351 379.297 L247.351 383.232 L233.277 383.232 L233.277 391.704 Q234.295 391.357 235.314 391.195 Q236.332 391.009 237.351 391.009 Q243.138 391.009 246.517 394.181 Q249.897 397.352 249.897 402.769 Q249.897 408.347 246.425 411.449 Q242.953 414.528 236.633 414.528 Q234.457 414.528 232.189 414.158 Q229.943 413.787 227.536 413.046 L227.536 408.347 Q229.619 409.482 231.841 410.037 Q234.064 410.593 236.541 410.593 Q240.545 410.593 242.883 408.486 Q245.221 406.38 245.221 402.769 Q245.221 399.158 242.883 397.051 Q240.545 394.945 236.541 394.945 Q234.666 394.945 232.791 395.361 Q230.939 395.778 228.994 396.658 L228.994 379.297 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip960)" d="M142.953 211.221 L172.629 211.221 L172.629 215.156 L142.953 215.156 L142.953 211.221 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip960)" d="M182.86 227.332 L182.86 223.073 Q184.62 223.906 186.425 224.346 Q188.231 224.786 189.967 224.786 Q194.596 224.786 197.027 221.684 Q199.481 218.559 199.828 212.216 Q198.485 214.207 196.425 215.272 Q194.365 216.337 191.865 216.337 Q186.68 216.337 183.647 213.212 Q180.638 210.064 180.638 204.624 Q180.638 199.3 183.786 196.082 Q186.934 192.865 192.166 192.865 Q198.161 192.865 201.309 197.471 Q204.481 202.054 204.481 210.804 Q204.481 218.976 200.592 223.86 Q196.726 228.721 190.175 228.721 Q188.416 228.721 186.61 228.374 Q184.805 228.026 182.86 227.332 M192.166 212.679 Q195.314 212.679 197.143 210.527 Q198.994 208.374 198.994 204.624 Q198.994 200.897 197.143 198.744 Q195.314 196.568 192.166 196.568 Q189.018 196.568 187.166 198.744 Q185.337 200.897 185.337 204.624 Q185.337 208.374 187.166 210.527 Q189.018 212.679 192.166 212.679 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip960)" d="M212.883 222.17 L217.767 222.17 L217.767 228.05 L212.883 228.05 L212.883 222.17 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip960)" d="M237.953 196.568 Q234.341 196.568 232.513 200.133 Q230.707 203.675 230.707 210.804 Q230.707 217.911 232.513 221.476 Q234.341 225.017 237.953 225.017 Q241.587 225.017 243.392 221.476 Q245.221 217.911 245.221 210.804 Q245.221 203.675 243.392 200.133 Q241.587 196.568 237.953 196.568 M237.953 192.865 Q243.763 192.865 246.818 197.471 Q249.897 202.054 249.897 210.804 Q249.897 219.531 246.818 224.138 Q243.763 228.721 237.953 228.721 Q232.142 228.721 229.064 224.138 Q226.008 219.531 226.008 210.804 Q226.008 202.054 229.064 197.471 Q232.142 192.865 237.953 192.865 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip960)" d="M70.6138 709.179 L23.0938 727.322 L23.0938 720.606 L63.1023 705.551 L23.0938 690.464 L23.0938 683.78 L70.6138 701.891 L70.6138 709.179 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip960)" d="M52.6944 665.956 Q52.6944 673.054 54.3176 675.791 Q55.9409 678.528 59.8558 678.528 Q62.975 678.528 64.821 676.491 Q66.6353 674.423 66.6353 670.89 Q66.6353 666.02 63.1978 663.092 Q59.7285 660.132 53.9993 660.132 L52.6944 660.132 L52.6944 665.956 M50.2754 654.275 L70.6138 654.275 L70.6138 660.132 L65.203 660.132 Q68.4495 662.137 70.0091 665.129 Q71.5369 668.12 71.5369 672.449 Q71.5369 677.924 68.4813 681.17 Q65.394 684.385 60.2377 684.385 Q54.2221 684.385 51.1666 680.374 Q48.1111 676.332 48.1111 668.343 L48.1111 660.132 L47.5381 660.132 Q43.4959 660.132 41.2998 662.805 Q39.0718 665.447 39.0718 670.253 Q39.0718 673.309 39.8038 676.205 Q40.5359 679.101 42 681.775 L36.5891 681.775 Q35.3478 678.56 34.7431 675.537 Q34.1065 672.513 34.1065 669.648 Q34.1065 661.914 38.1169 658.094 Q42.1273 654.275 50.2754 654.275 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip960)" d="M21.0886 642.212 L21.0886 636.356 L70.6138 636.356 L70.6138 642.212 L21.0886 642.212 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip960)" d="M56.5456 624.706 L34.9659 624.706 L34.9659 618.85 L56.3228 618.85 Q61.3836 618.85 63.9298 616.877 Q66.4443 614.903 66.4443 610.956 Q66.4443 606.214 63.4206 603.477 Q60.3969 600.708 55.177 600.708 L34.9659 600.708 L34.9659 594.851 L70.6138 594.851 L70.6138 600.708 L65.1393 600.708 Q68.3858 602.84 69.9773 605.673 Q71.5369 608.474 71.5369 612.198 Q71.5369 618.341 67.7174 621.523 Q63.898 624.706 56.5456 624.706 M34.1065 609.97 L34.1065 609.97 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip960)" d="M51.3257 552.296 L54.1903 552.296 L54.1903 579.223 Q60.2377 578.841 63.4206 575.595 Q66.5716 572.317 66.5716 566.492 Q66.5716 563.118 65.7441 559.967 Q64.9165 556.784 63.2614 553.665 L68.7996 553.665 Q70.1364 556.816 70.8366 560.126 Q71.5369 563.436 71.5369 566.842 Q71.5369 575.372 66.5716 580.369 Q61.6064 585.334 53.14 585.334 Q44.3871 585.334 39.2627 580.624 Q34.1065 575.881 34.1065 567.861 Q34.1065 560.667 38.7535 556.498 Q43.3686 552.296 51.3257 552.296 M49.607 558.153 Q44.8009 558.217 41.9363 560.858 Q39.0718 563.468 39.0718 567.797 Q39.0718 572.699 41.8408 575.659 Q44.6099 578.587 49.6388 579.032 L49.607 558.153 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip960)" d="M26.363 481.086 Q27.5546 481.151 27.619 481.956 Q27.6834 483.18 27.8444 483.92 Q27.9733 484.661 28.4564 485.82 Q28.9394 486.98 30.0989 488.107 Q31.2583 489.234 33.094 490.394 L70.8715 514.129 Q71.58 514.548 71.8054 514.902 Q72.0631 515.224 72.0631 515.965 Q72.0631 516.641 71.7732 516.899 Q71.5156 517.157 70.5494 517.286 L29.8412 522.503 Q29.1005 522.6 28.7784 522.696 Q28.4564 522.793 28.1343 523.179 Q27.8122 523.534 27.7156 524.306 Q27.619 525.079 27.619 526.464 Q27.619 527.108 27.5868 527.398 Q27.5546 527.656 27.3936 527.881 Q27.2003 528.107 26.8139 528.107 Q26.2342 528.107 25.9443 527.881 Q25.6222 527.624 25.59 527.43 Q25.5578 527.205 25.5578 526.851 Q25.5578 526.303 25.6222 525.112 Q25.6867 523.92 25.6867 523.308 Q25.6867 522.728 25.7189 521.505 Q25.7511 520.281 25.7511 519.669 Q25.7511 518.316 25.6545 515.579 Q25.5578 512.809 25.5578 511.489 Q25.5578 510.587 26.2986 510.587 Q27.2003 510.587 27.4258 510.973 Q27.619 511.36 27.619 512.229 Q27.619 514.419 28.1665 515.611 Q28.714 516.77 29.5836 516.77 L64.4947 512.294 L32.2889 492.036 Q30.7752 491.038 29.7768 491.038 Q27.8444 491.038 27.619 494.097 Q27.619 495.128 26.8139 495.128 Q26.2342 495.128 25.9443 494.87 Q25.6222 494.613 25.59 494.419 Q25.5578 494.194 25.5578 493.872 Q25.5578 492.809 25.6545 490.651 Q25.7511 488.461 25.7511 487.366 Q25.7511 486.465 25.6545 484.629 Q25.5578 482.793 25.5578 481.956 Q25.5578 481.086 26.363 481.086 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip960)" d="M54.1244 472.365 Q42.9812 472.365 33.9958 468.211 Q30.2277 466.439 27.0715 463.96 Q23.9153 461.48 22.5305 459.837 Q21.1456 458.195 21.1456 457.744 Q21.1456 457.1 21.7897 457.068 Q22.1118 457.068 22.917 457.937 Q33.7381 468.565 54.1244 468.533 Q74.5752 468.533 84.9776 458.195 Q86.1049 457.068 86.4591 457.068 Q87.1032 457.068 87.1032 457.744 Q87.1032 458.195 85.7828 459.773 Q84.4624 461.351 81.435 463.799 Q78.4077 466.246 74.704 468.018 Q65.7185 472.365 54.1244 472.365 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip960)" d="M45.6221 421.144 Q47.4578 421.144 48.5528 422.271 Q49.6478 423.366 49.6478 424.751 Q49.6478 425.975 48.9393 426.619 Q48.2308 427.263 47.329 427.263 Q46.9425 427.263 46.4594 427.102 Q45.9441 426.941 45.3322 426.587 Q44.7203 426.2 44.2694 425.395 Q43.8186 424.59 43.7541 423.495 Q43.5287 423.721 43.4965 423.785 Q43.11 424.268 42.9812 425.17 Q42.9168 425.299 42.9168 425.75 Q42.9168 427.972 44.5593 430.226 Q46.1696 432.448 49.2291 435.186 Q52.804 438.632 54.1244 440.854 Q55.4127 431.096 61.0487 431.096 Q61.9827 431.096 63.1099 431.353 Q65.2355 431.869 66.7813 431.869 Q69.8731 431.869 69.8731 429.775 Q69.8731 427.746 67.8119 426.458 Q65.7507 425.138 61.725 424.043 Q60.9843 423.882 60.7588 423.721 Q60.5334 423.56 60.5334 423.109 Q60.5334 422.304 61.1775 422.304 Q64.9456 423.044 67.8441 424.687 Q71.3546 426.78 71.3546 429.904 Q71.3546 432.513 69.551 434.252 Q67.7153 435.959 64.8168 435.959 Q64.1082 435.959 62.498 435.701 Q61.8538 435.508 61.1131 435.508 Q59.5994 435.508 58.4722 436.345 Q57.3128 437.183 56.7331 438.535 Q56.1534 439.888 55.8958 441.015 Q55.6059 442.11 55.5093 443.173 Q69.1324 446.394 69.9697 446.844 Q70.5494 447.134 70.9359 447.778 Q71.3546 448.422 71.3546 449.099 Q71.3546 449.743 70.9037 450.387 Q70.485 450.999 69.4866 450.999 Q68.9713 450.999 68.0374 450.741 L30.0344 441.176 L28.7462 440.983 Q28.3597 440.983 28.1665 441.144 Q27.9411 441.273 27.78 442.046 Q27.619 442.786 27.619 444.268 Q27.619 444.88 27.5868 445.17 Q27.5546 445.427 27.3936 445.653 Q27.2003 445.878 26.8139 445.878 Q26.2664 445.878 25.9765 445.653 Q25.6545 445.395 25.59 445.202 Q25.5256 445.009 25.4934 444.622 Q25.4612 444.075 25.3002 442.239 Q25.107 440.403 24.9781 438.825 Q24.8493 437.247 24.8493 436.571 Q24.8493 436.184 25.0425 435.991 Q25.2036 435.766 25.3968 435.733 L25.5578 435.701 L53.3837 442.561 Q52.2565 439.727 47.2646 435.25 Q41.4675 430.065 41.4675 425.621 Q41.4675 423.527 42.7558 422.336 Q44.0118 421.144 45.6221 421.144 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip960)" d="M86.4591 414.061 Q86.1371 414.061 85.3319 413.223 Q74.5107 402.595 54.1244 402.595 Q33.6737 402.595 23.3356 412.805 Q22.144 414.061 21.7897 414.061 Q21.1456 414.061 21.1456 413.417 Q21.1456 412.966 22.4661 411.388 Q23.7865 409.777 26.8139 407.362 Q29.8412 404.914 33.5449 403.111 Q42.5303 398.763 54.1244 398.763 Q65.2677 398.763 74.2531 402.917 Q78.0212 404.689 81.1774 407.169 Q84.3335 409.648 85.7184 411.291 Q87.1032 412.933 87.1032 413.417 Q87.1032 414.061 86.4591 414.061 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip962)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="327.242,1039.9 343.024,1007.15 358.805,976.711 374.587,948.339 390.369,921.775 406.15,896.656 421.932,872.988 437.714,850.455 453.496,829.073 469.277,808.601 485.059,789.047 500.841,770.329 516.622,752.283 532.404,734.947 548.186,718.26 563.967,702.097 579.749,686.484 595.531,671.386 611.312,656.756 627.094,642.524 642.876,628.714 658.657,615.299 674.439,602.246 690.221,589.519 706.003,577.109 721.784,565 737.566,553.178 753.348,541.638 769.129,530.363 784.911,519.325 800.693,508.526 816.474,497.971 832.256,487.663 848.038,477.592 863.819,467.747 879.601,458.118 895.383,448.695 911.164,439.454 926.946,430.396 942.728,421.521 958.51,412.822 974.291,404.292 990.073,395.922 1005.85,387.686 1021.64,379.602 1037.42,371.664 1053.2,363.866 1068.98,356.202 1084.76,348.648 1100.54,341.222 1116.33,333.919 1132.11,326.735 1147.89,319.654 1163.67,312.676 1179.45,305.806 1195.23,299.042 1211.02,292.374 1226.8,285.79 1242.58,279.305 1258.36,272.913 1274.14,266.606 1289.92,260.375 1305.71,254.231 1321.49,248.172 1337.27,242.184 1353.05,236.268 1368.83,230.431 1384.62,224.671 1400.4,218.969 1416.18,213.337 1431.96,207.791 1447.74,202.345 1463.52,196.995 1479.31,191.737 1495.09,186.57 1510.87,181.488 1526.65,176.491 1542.43,171.575 1558.21,166.737 1574,161.975 1589.78,157.287 1605.56,152.67 1621.34,148.123 1637.12,143.643 1652.9,139.228 1668.69,134.877 1684.47,130.587 1700.25,126.358 1716.03,122.186 1731.81,118.072 1747.59,114.012 1763.38,110.006 1779.16,106.053 1794.94,102.15 1810.72,98.2974 1826.5,94.4929 1842.28,90.7357 1858.07,87.0246 1873.85,83.3583 1889.63,79.7359 1905.41,76.1564 "></polyline>
</svg>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-vfi-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: Value Function Iteration
</figcaption>
</figure>
</div>
</div>
<p>なお, 各イタレーションでは, <span class="math inline">\(k\)</span> に対する最適な <span class="math inline">\(k'\)</span> や <span class="math inline">\(c\)</span> を求めています. それらを記録しておくことで, 政策関数 <span class="math inline">\(c = h(k)\)</span> や <span class="math inline">\(k' = g(k)\)</span> を求めることができます.</p>
</section>
<section id="policy-function-iteration" class="level3">
<h3 class="anchored" data-anchor-id="policy-function-iteration">Policy Function Iteration</h3>
<p>上記のベルマン方程式から, 以下のオイラー方程式が導出されます.</p>
<p><span class="math display">\[
u'(c) = \beta u'(c')\left(f'(k') + (1-\delta)\right).
\]</span></p>
<p>ここで, 政策関数 <span class="math inline">\(c' = h(k')\)</span> と予算制約 <span class="math inline">\(k' = f(k) + (1-\delta)k - c\)</span> を導入すると, 上記のオイラー方程式は以下のように書き換えられます.</p>
<p><span class="math display">\[
u'(c) = \beta u'(h(f(k) + (1-\delta)k - c))\left(f'(f(k) + (1-\delta)k - c) + (1-\delta)\right).
\]</span></p>
<p>この時, <span class="math inline">\(h(k)\)</span> を所与とした時に <span class="math inline">\(c\)</span> について解くと新しい政策関数 <span class="math inline">\(h(k)\)</span> が得られます. この政策関数繰り返し更新することで, 政策関数の不動点を求めることができます.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Policy Function Iteration
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li><span class="math inline">\(k\)</span> の定義域を <span class="math inline">\([k_{\min}, k_{\max}]\)</span> を <span class="math inline">\(n\)</span> 個のグリッドポイントに分割する</li>
<li><span class="math inline">\(h(k)\)</span> の初期値 <span class="math inline">\(h^0\)</span> を適当に設定する. つまり, <span class="math inline">\(h^0 = (h_0^0, h_1^0, \dots, h_n^0)\)</span> に適当な値を設定する.</li>
<li><span class="math inline">\(h^0\)</span> をオイラー方程式の右辺に代入し, 各 <span class="math inline">\(k_i\)</span> に対して <span class="math inline">\(h_i^1\)</span> を計算する.</li>
<li>2-3を繰り返す. 収束条件は以下のように設定する.
<ul>
<li><span class="math inline">\(|h^N - h^{N-1}| &lt; \varepsilon\)</span></li>
<li><span class="math inline">\(|h^N - h^{N-1}|\)</span> はベクトルのノルム</li>
<li><span class="math inline">\(\varepsilon\)</span> は十分小さな値を設定する. 例えば, <span class="math inline">\(\epsilon = 10^{-6}\)</span> とする</li>
</ul></li>
</ol>
</div>
</div>
<div id="cell-fig-pfi" class="cell" data-execution_count="1">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb16"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">euler_eq</span>(c, k, h; m)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>    (; β, δ, k_grid) <span class="op">=</span> m</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>    k′ <span class="op">=</span> <span class="fu">max</span>(<span class="fu">f</span>(k; m) <span class="op">+</span> (<span class="fl">1</span> <span class="op">-</span> δ) <span class="op">*</span> k <span class="op">-</span> c, k_grid[begin])</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>    h_interp <span class="op">=</span> <span class="fu">linear_interpolation</span>(k_grid, h)</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>    c′ <span class="op">=</span> <span class="fu">h_interp</span>(k′)</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fu">u′</span>(c; m) <span class="op">-</span> β <span class="op">*</span> <span class="fu">u′</span>(c′; m) <span class="op">*</span> (<span class="fu">f′</span>(k′; m) <span class="op">+</span> <span class="fl">1</span> <span class="op">-</span> δ)</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">pfi!</span>(m<span class="op">::</span><span class="dt">Model</span>; tol<span class="op">=</span><span class="fl">1e-6</span>, max_iter<span class="op">=</span><span class="fl">1000</span>, verbose<span class="op">=</span><span class="cn">true</span>)</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>    (; k_min, k_max, k_grid, α, β, δ) <span class="op">=</span> m</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>    h_new <span class="op">=</span> <span class="fu">similar</span>(m.h)</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>    iter, dist <span class="op">=</span> <span class="fl">0</span>, <span class="cn">Inf</span></span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> dist <span class="op">&gt;</span> tol <span class="op">&amp;&amp;</span> iter <span class="op">&lt;</span> max_iter</span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> (i_k, k) <span class="kw">in</span> <span class="fu">enumerate</span>(k_grid)</span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>            c_min <span class="op">=</span> <span class="fu">max</span>(<span class="fl">1e-9</span>, <span class="fu">f</span>(k; m) <span class="op">+</span> (<span class="fl">1</span> <span class="op">-</span> δ) <span class="op">*</span> k <span class="op">-</span> k_grid[<span class="kw">end</span>])</span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>            c_max <span class="op">=</span> <span class="fu">f</span>(k; m) <span class="op">+</span> (<span class="fl">1</span> <span class="op">-</span> δ) <span class="op">*</span> k <span class="op">-</span> k_grid[begin]</span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>            ee_left <span class="op">=</span> <span class="fu">euler_eq</span>(c_min, k, m.h; m)</span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>            ee_right <span class="op">=</span> <span class="fu">euler_eq</span>(c_max, k, m.h; m)</span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> ee_left <span class="op">&gt;</span> <span class="fl">0</span> <span class="op">&amp;&amp;</span> ee_right <span class="op">&gt;</span> <span class="fl">0</span></span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a>                h_new[i_k] <span class="op">=</span> c_max</span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a>            <span class="cf">elseif</span> ee_left <span class="op">&lt;</span> <span class="fl">0</span> <span class="op">&amp;&amp;</span> ee_right <span class="op">&lt;</span> <span class="fl">0</span></span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a>                h_new[i_k] <span class="op">=</span> c_min</span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span></span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true" tabindex="-1"></a>                h_new[i_k] <span class="op">=</span> <span class="fu">find_zero</span>(c <span class="op">-&gt;</span> <span class="fu">euler_eq</span>(c, k, m.h; m), (c_min, c_max))</span>
<span id="cb16-29"><a href="#cb16-29" aria-hidden="true" tabindex="-1"></a>            <span class="cf">end</span></span>
<span id="cb16-30"><a href="#cb16-30" aria-hidden="true" tabindex="-1"></a>        <span class="cf">end</span></span>
<span id="cb16-31"><a href="#cb16-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-32"><a href="#cb16-32" aria-hidden="true" tabindex="-1"></a>        dist <span class="op">=</span> <span class="fu">maximum</span>(abs, h_new <span class="op">.-</span> m.h)</span>
<span id="cb16-33"><a href="#cb16-33" aria-hidden="true" tabindex="-1"></a>        m.h <span class="op">.=</span> h_new</span>
<span id="cb16-34"><a href="#cb16-34" aria-hidden="true" tabindex="-1"></a>        iter <span class="op">+=</span> <span class="fl">1</span></span>
<span id="cb16-35"><a href="#cb16-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb16-36"><a href="#cb16-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-37"><a href="#cb16-37" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> verbose</span>
<span id="cb16-38"><a href="#cb16-38" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> iter <span class="op">==</span> max_iter</span>
<span id="cb16-39"><a href="#cb16-39" aria-hidden="true" tabindex="-1"></a>            <span class="fu">println</span>(<span class="st">"Warning: Maximum iterations reached."</span>)</span>
<span id="cb16-40"><a href="#cb16-40" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span></span>
<span id="cb16-41"><a href="#cb16-41" aria-hidden="true" tabindex="-1"></a>            <span class="fu">println</span>(<span class="st">"Converged in </span><span class="sc">$</span>iter<span class="st"> iterations."</span>)</span>
<span id="cb16-42"><a href="#cb16-42" aria-hidden="true" tabindex="-1"></a>        <span class="cf">end</span></span>
<span id="cb16-43"><a href="#cb16-43" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb16-44"><a href="#cb16-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-45"><a href="#cb16-45" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="cn">nothing</span></span>
<span id="cb16-46"><a href="#cb16-46" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb16-47"><a href="#cb16-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-48"><a href="#cb16-48" aria-hidden="true" tabindex="-1"></a>m <span class="op">=</span> <span class="fu">Model</span>()</span>
<span id="cb16-49"><a href="#cb16-49" aria-hidden="true" tabindex="-1"></a><span class="fu">pfi!</span>(m)</span>
<span id="cb16-50"><a href="#cb16-50" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(m.k_grid, m.h, label<span class="op">=</span><span class="cn">false</span>, xlabel<span class="op">=</span>L<span class="st">"Capital </span><span class="sc">$</span>k<span class="sc">$</span><span class="st">", </span>ylabel<span class="st">=L"</span>Policy <span class="op">$</span><span class="fu">h</span>(k)<span class="op">$</span><span class="st">")</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Converged in 5 iterations.</code></pre>
</div>
<div id="fig-pfi" class="cell-output cell-output-display quarto-float quarto-figure quarto-figure-center anchored" data-execution_count="1">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-pfi-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<!--?xml version="1.0" encoding="utf-8"?-->
<svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" width="500" height="309" viewbox="0 0 2000 1236">
<defs>
  <clippath id="clip020">
    <rect x="0" y="0" width="2000" height="1236"></rect>
  </clippath>
</defs>
<path clip-path="url(#clip020)" d="M0 1236 L2000 1236 L2000 1.24345e-14 L0 1.24345e-14  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<defs>
  <clippath id="clip021">
    <rect x="400" y="0" width="1401" height="1236"></rect>
  </clippath>
</defs>
<path clip-path="url(#clip020)" d="M212.397 1068.81 L1952.76 1068.81 L1952.76 47.2441 L212.397 47.2441  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<defs>
  <clippath id="clip022">
    <rect x="212" y="47" width="1741" height="1023"></rect>
  </clippath>
</defs>
<polyline clip-path="url(#clip022)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="444.08,1068.81 444.08,47.2441 "></polyline>
<polyline clip-path="url(#clip022)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="808.935,1068.81 808.935,47.2441 "></polyline>
<polyline clip-path="url(#clip022)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1173.79,1068.81 1173.79,47.2441 "></polyline>
<polyline clip-path="url(#clip022)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1538.65,1068.81 1538.65,47.2441 "></polyline>
<polyline clip-path="url(#clip022)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1903.5,1068.81 1903.5,47.2441 "></polyline>
<polyline clip-path="url(#clip022)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="212.397,973.671 1952.76,973.671 "></polyline>
<polyline clip-path="url(#clip022)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="212.397,796.945 1952.76,796.945 "></polyline>
<polyline clip-path="url(#clip022)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="212.397,620.22 1952.76,620.22 "></polyline>
<polyline clip-path="url(#clip022)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="212.397,443.495 1952.76,443.495 "></polyline>
<polyline clip-path="url(#clip022)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="212.397,266.769 1952.76,266.769 "></polyline>
<polyline clip-path="url(#clip022)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="212.397,90.044 1952.76,90.044 "></polyline>
<polyline clip-path="url(#clip020)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="212.397,1068.81 1952.76,1068.81 "></polyline>
<polyline clip-path="url(#clip020)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="444.08,1068.81 444.08,1049.91 "></polyline>
<polyline clip-path="url(#clip020)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="808.935,1068.81 808.935,1049.91 "></polyline>
<polyline clip-path="url(#clip020)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1173.79,1068.81 1173.79,1049.91 "></polyline>
<polyline clip-path="url(#clip020)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1538.65,1068.81 1538.65,1049.91 "></polyline>
<polyline clip-path="url(#clip020)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1903.5,1068.81 1903.5,1049.91 "></polyline>
<path clip-path="url(#clip020)" d="M422.078 1096.53 Q418.467 1096.53 416.638 1100.1 Q414.833 1103.64 414.833 1110.77 Q414.833 1117.87 416.638 1121.44 Q418.467 1124.98 422.078 1124.98 Q425.712 1124.98 427.518 1121.44 Q429.347 1117.87 429.347 1110.77 Q429.347 1103.64 427.518 1100.1 Q425.712 1096.53 422.078 1096.53 M422.078 1092.83 Q427.888 1092.83 430.944 1097.43 Q434.022 1102.02 434.022 1110.77 Q434.022 1119.49 430.944 1124.1 Q427.888 1128.68 422.078 1128.68 Q416.268 1128.68 413.189 1124.1 Q410.134 1119.49 410.134 1110.77 Q410.134 1102.02 413.189 1097.43 Q416.268 1092.83 422.078 1092.83 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip020)" d="M442.24 1122.13 L447.124 1122.13 L447.124 1128.01 L442.24 1128.01 L442.24 1122.13 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip020)" d="M458.12 1124.08 L465.758 1124.08 L465.758 1097.71 L457.448 1099.38 L457.448 1095.12 L465.712 1093.45 L470.388 1093.45 L470.388 1124.08 L478.027 1124.08 L478.027 1128.01 L458.12 1128.01 L458.12 1124.08 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip020)" d="M787.118 1096.53 Q783.507 1096.53 781.679 1100.1 Q779.873 1103.64 779.873 1110.77 Q779.873 1117.87 781.679 1121.44 Q783.507 1124.98 787.118 1124.98 Q790.753 1124.98 792.558 1121.44 Q794.387 1117.87 794.387 1110.77 Q794.387 1103.64 792.558 1100.1 Q790.753 1096.53 787.118 1096.53 M787.118 1092.83 Q792.928 1092.83 795.984 1097.43 Q799.063 1102.02 799.063 1110.77 Q799.063 1119.49 795.984 1124.1 Q792.928 1128.68 787.118 1128.68 Q781.308 1128.68 778.229 1124.1 Q775.174 1119.49 775.174 1110.77 Q775.174 1102.02 778.229 1097.43 Q781.308 1092.83 787.118 1092.83 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip020)" d="M807.28 1122.13 L812.164 1122.13 L812.164 1128.01 L807.28 1128.01 L807.28 1122.13 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip020)" d="M826.377 1124.08 L842.697 1124.08 L842.697 1128.01 L820.752 1128.01 L820.752 1124.08 Q823.414 1121.32 827.998 1116.69 Q832.604 1112.04 833.785 1110.7 Q836.03 1108.17 836.91 1106.44 Q837.812 1104.68 837.812 1102.99 Q837.812 1100.23 835.868 1098.5 Q833.947 1096.76 830.845 1096.76 Q828.646 1096.76 826.192 1097.53 Q823.762 1098.29 820.984 1099.84 L820.984 1095.12 Q823.808 1093.98 826.262 1093.41 Q828.715 1092.83 830.752 1092.83 Q836.123 1092.83 839.317 1095.51 Q842.512 1098.2 842.512 1102.69 Q842.512 1104.82 841.701 1106.74 Q840.914 1108.64 838.808 1111.23 Q838.229 1111.9 835.127 1115.12 Q832.025 1118.31 826.377 1124.08 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip020)" d="M1151.5 1096.53 Q1147.89 1096.53 1146.06 1100.1 Q1144.25 1103.64 1144.25 1110.77 Q1144.25 1117.87 1146.06 1121.44 Q1147.89 1124.98 1151.5 1124.98 Q1155.13 1124.98 1156.94 1121.44 Q1158.77 1117.87 1158.77 1110.77 Q1158.77 1103.64 1156.94 1100.1 Q1155.13 1096.53 1151.5 1096.53 M1151.5 1092.83 Q1157.31 1092.83 1160.36 1097.43 Q1163.44 1102.02 1163.44 1110.77 Q1163.44 1119.49 1160.36 1124.1 Q1157.31 1128.68 1151.5 1128.68 Q1145.69 1128.68 1142.61 1124.1 Q1139.55 1119.49 1139.55 1110.77 Q1139.55 1102.02 1142.61 1097.43 Q1145.69 1092.83 1151.5 1092.83 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip020)" d="M1171.66 1122.13 L1176.54 1122.13 L1176.54 1128.01 L1171.66 1128.01 L1171.66 1122.13 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip020)" d="M1200.9 1109.38 Q1204.25 1110.1 1206.13 1112.36 Q1208.03 1114.63 1208.03 1117.97 Q1208.03 1123.08 1204.51 1125.88 Q1200.99 1128.68 1194.51 1128.68 Q1192.33 1128.68 1190.02 1128.24 Q1187.73 1127.83 1185.27 1126.97 L1185.27 1122.46 Q1187.22 1123.59 1189.53 1124.17 Q1191.85 1124.75 1194.37 1124.75 Q1198.77 1124.75 1201.06 1123.01 Q1203.37 1121.28 1203.37 1117.97 Q1203.37 1114.91 1201.22 1113.2 Q1199.09 1111.46 1195.27 1111.46 L1191.24 1111.46 L1191.24 1107.62 L1195.46 1107.62 Q1198.91 1107.62 1200.73 1106.25 Q1202.56 1104.86 1202.56 1102.27 Q1202.56 1099.61 1200.67 1098.2 Q1198.79 1096.76 1195.27 1096.76 Q1193.35 1096.76 1191.15 1097.18 Q1188.95 1097.6 1186.31 1098.47 L1186.31 1094.31 Q1188.98 1093.57 1191.29 1093.2 Q1193.63 1092.83 1195.69 1092.83 Q1201.01 1092.83 1204.11 1095.26 Q1207.22 1097.66 1207.22 1101.78 Q1207.22 1104.66 1205.57 1106.65 Q1203.93 1108.61 1200.9 1109.38 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip020)" d="M1515.79 1096.53 Q1512.18 1096.53 1510.35 1100.1 Q1508.54 1103.64 1508.54 1110.77 Q1508.54 1117.87 1510.35 1121.44 Q1512.18 1124.98 1515.79 1124.98 Q1519.42 1124.98 1521.23 1121.44 Q1523.06 1117.87 1523.06 1110.77 Q1523.06 1103.64 1521.23 1100.1 Q1519.42 1096.53 1515.79 1096.53 M1515.79 1092.83 Q1521.6 1092.83 1524.65 1097.43 Q1527.73 1102.02 1527.73 1110.77 Q1527.73 1119.49 1524.65 1124.1 Q1521.6 1128.68 1515.79 1128.68 Q1509.98 1128.68 1506.9 1124.1 Q1503.84 1119.49 1503.84 1110.77 Q1503.84 1102.02 1506.9 1097.43 Q1509.98 1092.83 1515.79 1092.83 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip020)" d="M1535.95 1122.13 L1540.83 1122.13 L1540.83 1128.01 L1535.95 1128.01 L1535.95 1122.13 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip020)" d="M1563.87 1097.53 L1552.06 1115.97 L1563.87 1115.97 L1563.87 1097.53 M1562.64 1093.45 L1568.52 1093.45 L1568.52 1115.97 L1573.45 1115.97 L1573.45 1119.86 L1568.52 1119.86 L1568.52 1128.01 L1563.87 1128.01 L1563.87 1119.86 L1548.26 1119.86 L1548.26 1115.35 L1562.64 1093.45 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip020)" d="M1881.38 1096.53 Q1877.77 1096.53 1875.94 1100.1 Q1874.14 1103.64 1874.14 1110.77 Q1874.14 1117.87 1875.94 1121.44 Q1877.77 1124.98 1881.38 1124.98 Q1885.02 1124.98 1886.82 1121.44 Q1888.65 1117.87 1888.65 1110.77 Q1888.65 1103.64 1886.82 1100.1 Q1885.02 1096.53 1881.38 1096.53 M1881.38 1092.83 Q1887.19 1092.83 1890.25 1097.43 Q1893.33 1102.02 1893.33 1110.77 Q1893.33 1119.49 1890.25 1124.1 Q1887.19 1128.68 1881.38 1128.68 Q1875.57 1128.68 1872.49 1124.1 Q1869.44 1119.49 1869.44 1110.77 Q1869.44 1102.02 1872.49 1097.43 Q1875.57 1092.83 1881.38 1092.83 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip020)" d="M1901.54 1122.13 L1906.43 1122.13 L1906.43 1128.01 L1901.54 1128.01 L1901.54 1122.13 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip020)" d="M1916.66 1093.45 L1935.02 1093.45 L1935.02 1097.39 L1920.94 1097.39 L1920.94 1105.86 Q1921.96 1105.51 1922.98 1105.35 Q1924 1105.16 1925.02 1105.16 Q1930.8 1105.16 1934.18 1108.34 Q1937.56 1111.51 1937.56 1116.92 Q1937.56 1122.5 1934.09 1125.6 Q1930.62 1128.68 1924.3 1128.68 Q1922.12 1128.68 1919.85 1128.31 Q1917.61 1127.94 1915.2 1127.2 L1915.2 1122.5 Q1917.29 1123.64 1919.51 1124.19 Q1921.73 1124.75 1924.21 1124.75 Q1928.21 1124.75 1930.55 1122.64 Q1932.89 1120.53 1932.89 1116.92 Q1932.89 1113.31 1930.55 1111.21 Q1928.21 1109.1 1924.21 1109.1 Q1922.33 1109.1 1920.46 1109.52 Q1918.6 1109.93 1916.66 1110.81 L1916.66 1093.45 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip020)" d="M981.071 1157.6 L981.071 1164.38 Q977.824 1161.36 974.132 1159.86 Q970.472 1158.37 966.334 1158.37 Q958.186 1158.37 953.857 1163.36 Q949.529 1168.33 949.529 1177.75 Q949.529 1187.14 953.857 1192.14 Q958.186 1197.1 966.334 1197.1 Q970.472 1197.1 974.132 1195.61 Q977.824 1194.11 981.071 1191.09 L981.071 1197.8 Q977.697 1200.09 973.909 1201.24 Q970.153 1202.38 965.952 1202.38 Q955.162 1202.38 948.956 1195.8 Q942.749 1189.18 942.749 1177.75 Q942.749 1166.29 948.956 1159.7 Q955.162 1153.08 965.952 1153.08 Q970.217 1153.08 973.973 1154.23 Q977.76 1155.34 981.071 1157.6 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip020)" d="M1006.95 1183.54 Q999.849 1183.54 997.112 1185.17 Q994.375 1186.79 994.375 1190.7 Q994.375 1193.82 996.412 1195.67 Q998.481 1197.48 1002.01 1197.48 Q1006.88 1197.48 1009.81 1194.05 Q1012.77 1190.58 1012.77 1184.85 L1012.77 1183.54 L1006.95 1183.54 M1018.63 1181.12 L1018.63 1201.46 L1012.77 1201.46 L1012.77 1196.05 Q1010.77 1199.3 1007.77 1200.86 Q1004.78 1202.38 1000.45 1202.38 Q994.98 1202.38 991.733 1199.33 Q988.518 1196.24 988.518 1191.09 Q988.518 1185.07 992.529 1182.01 Q996.571 1178.96 1004.56 1178.96 L1012.77 1178.96 L1012.77 1178.39 Q1012.77 1174.34 1010.1 1172.15 Q1007.46 1169.92 1002.65 1169.92 Q999.595 1169.92 996.698 1170.65 Q993.802 1171.38 991.128 1172.85 L991.128 1167.44 Q994.343 1166.2 997.367 1165.59 Q1000.39 1164.95 1003.26 1164.95 Q1010.99 1164.95 1014.81 1168.96 Q1018.63 1172.98 1018.63 1181.12 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip020)" d="M1036.36 1196.11 L1036.36 1215.02 L1030.47 1215.02 L1030.47 1165.81 L1036.36 1165.81 L1036.36 1171.22 Q1038.2 1168.04 1041 1166.51 Q1043.84 1164.95 1047.75 1164.95 Q1054.24 1164.95 1058.29 1170.11 Q1062.36 1175.27 1062.36 1183.67 Q1062.36 1192.07 1058.29 1197.23 Q1054.24 1202.38 1047.75 1202.38 Q1043.84 1202.38 1041 1200.86 Q1038.2 1199.3 1036.36 1196.11 M1056.28 1183.67 Q1056.28 1177.21 1053.61 1173.55 Q1050.97 1169.86 1046.32 1169.86 Q1041.67 1169.86 1039 1173.55 Q1036.36 1177.21 1036.36 1183.67 Q1036.36 1190.13 1039 1193.82 Q1041.67 1197.48 1046.32 1197.48 Q1050.97 1197.48 1053.61 1193.82 Q1056.28 1190.13 1056.28 1183.67 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip020)" d="M1072.07 1165.81 L1077.92 1165.81 L1077.92 1201.46 L1072.07 1201.46 L1072.07 1165.81 M1072.07 1151.94 L1077.92 1151.94 L1077.92 1159.35 L1072.07 1159.35 L1072.07 1151.94 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip020)" d="M1095.97 1155.69 L1095.97 1165.81 L1108.03 1165.81 L1108.03 1170.37 L1095.97 1170.37 L1095.97 1189.72 Q1095.97 1194.08 1097.15 1195.32 Q1098.36 1196.56 1102.02 1196.56 L1108.03 1196.56 L1108.03 1201.46 L1102.02 1201.46 Q1095.24 1201.46 1092.66 1198.95 Q1090.08 1196.4 1090.08 1189.72 L1090.08 1170.37 L1085.79 1170.37 L1085.79 1165.81 L1090.08 1165.81 L1090.08 1155.69 L1095.97 1155.69 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip020)" d="M1131.94 1183.54 Q1124.84 1183.54 1122.1 1185.17 Q1119.37 1186.79 1119.37 1190.7 Q1119.37 1193.82 1121.4 1195.67 Q1123.47 1197.48 1127 1197.48 Q1131.87 1197.48 1134.8 1194.05 Q1137.76 1190.58 1137.76 1184.85 L1137.76 1183.54 L1131.94 1183.54 M1143.62 1181.12 L1143.62 1201.46 L1137.76 1201.46 L1137.76 1196.05 Q1135.76 1199.3 1132.77 1200.86 Q1129.77 1202.38 1125.44 1202.38 Q1119.97 1202.38 1116.72 1199.33 Q1113.51 1196.24 1113.51 1191.09 Q1113.51 1185.07 1117.52 1182.01 Q1121.56 1178.96 1129.55 1178.96 L1137.76 1178.96 L1137.76 1178.39 Q1137.76 1174.34 1135.09 1172.15 Q1132.45 1169.92 1127.64 1169.92 Q1124.59 1169.92 1121.69 1170.65 Q1118.79 1171.38 1116.12 1172.85 L1116.12 1167.44 Q1119.33 1166.2 1122.36 1165.59 Q1125.38 1164.95 1128.25 1164.95 Q1135.98 1164.95 1139.8 1168.96 Q1143.62 1172.98 1143.62 1181.12 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip020)" d="M1155.68 1151.94 L1161.54 1151.94 L1161.54 1201.46 L1155.68 1201.46 L1155.68 1151.94 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip020)" d="M1218.22 1176.47 Q1218.22 1178.31 1217.1 1179.4 Q1216 1180.5 1214.62 1180.5 Q1213.39 1180.5 1212.75 1179.79 Q1212.11 1179.08 1212.11 1178.18 Q1212.11 1177.79 1212.27 1177.31 Q1212.43 1176.79 1212.78 1176.18 Q1213.17 1175.57 1213.97 1175.12 Q1214.78 1174.67 1215.87 1174.6 Q1215.65 1174.38 1215.58 1174.34 Q1215.1 1173.96 1214.2 1173.83 Q1214.07 1173.76 1213.62 1173.76 Q1211.4 1173.76 1209.14 1175.41 Q1206.92 1177.02 1204.18 1180.08 Q1200.74 1183.65 1198.51 1184.97 Q1208.27 1186.26 1208.27 1191.9 Q1208.27 1192.83 1208.02 1193.96 Q1207.5 1196.08 1207.5 1197.63 Q1207.5 1200.72 1209.59 1200.72 Q1211.62 1200.72 1212.91 1198.66 Q1214.23 1196.6 1215.33 1192.57 Q1215.49 1191.83 1215.65 1191.61 Q1215.81 1191.38 1216.26 1191.38 Q1217.07 1191.38 1217.07 1192.03 Q1216.32 1195.79 1214.68 1198.69 Q1212.59 1202.2 1209.46 1202.2 Q1206.86 1202.2 1205.12 1200.4 Q1203.41 1198.56 1203.41 1195.66 Q1203.41 1194.96 1203.67 1193.35 Q1203.86 1192.7 1203.86 1191.96 Q1203.86 1190.45 1203.02 1189.32 Q1202.19 1188.16 1200.83 1187.58 Q1199.48 1187 1198.35 1186.74 Q1197.26 1186.45 1196.2 1186.36 Q1192.98 1199.98 1192.52 1200.82 Q1192.23 1201.4 1191.59 1201.78 Q1190.95 1202.2 1190.27 1202.2 Q1189.63 1202.2 1188.98 1201.75 Q1188.37 1201.33 1188.37 1200.33 Q1188.37 1199.82 1188.63 1198.89 L1198.19 1160.88 L1198.39 1159.59 Q1198.39 1159.21 1198.22 1159.01 Q1198.1 1158.79 1197.32 1158.63 Q1196.58 1158.47 1195.1 1158.47 Q1194.49 1158.47 1194.2 1158.43 Q1193.94 1158.4 1193.72 1158.24 Q1193.49 1158.05 1193.49 1157.66 Q1193.49 1157.11 1193.72 1156.82 Q1193.97 1156.5 1194.17 1156.44 Q1194.36 1156.37 1194.75 1156.34 Q1195.29 1156.31 1197.13 1156.15 Q1198.97 1155.95 1200.54 1155.83 Q1202.12 1155.7 1202.8 1155.7 Q1203.18 1155.7 1203.38 1155.89 Q1203.6 1156.05 1203.64 1156.24 L1203.67 1156.41 L1196.81 1184.23 Q1199.64 1183.1 1204.12 1178.11 Q1209.3 1172.32 1213.75 1172.32 Q1215.84 1172.32 1217.03 1173.6 Q1218.22 1174.86 1218.22 1176.47 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip020)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="212.397,1068.81 212.397,47.2441 "></polyline>
<polyline clip-path="url(#clip020)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="212.397,973.671 231.295,973.671 "></polyline>
<polyline clip-path="url(#clip020)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="212.397,796.945 231.295,796.945 "></polyline>
<polyline clip-path="url(#clip020)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="212.397,620.22 231.295,620.22 "></polyline>
<polyline clip-path="url(#clip020)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="212.397,443.495 231.295,443.495 "></polyline>
<polyline clip-path="url(#clip020)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="212.397,266.769 231.295,266.769 "></polyline>
<polyline clip-path="url(#clip020)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="212.397,90.044 231.295,90.044 "></polyline>
<path clip-path="url(#clip020)" d="M126.819 959.469 Q123.208 959.469 121.379 963.034 Q119.574 966.576 119.574 973.705 Q119.574 980.812 121.379 984.377 Q123.208 987.918 126.819 987.918 Q130.453 987.918 132.259 984.377 Q134.087 980.812 134.087 973.705 Q134.087 966.576 132.259 963.034 Q130.453 959.469 126.819 959.469 M126.819 955.766 Q132.629 955.766 135.685 960.372 Q138.763 964.955 138.763 973.705 Q138.763 982.432 135.685 987.039 Q132.629 991.622 126.819 991.622 Q121.009 991.622 117.93 987.039 Q114.875 982.432 114.875 973.705 Q114.875 964.955 117.93 960.372 Q121.009 955.766 126.819 955.766 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip020)" d="M146.981 985.071 L151.865 985.071 L151.865 990.951 L146.981 990.951 L146.981 985.071 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip020)" d="M166.078 987.015 L182.397 987.015 L182.397 990.951 L160.453 990.951 L160.453 987.015 Q163.115 984.261 167.698 979.631 Q172.305 974.978 173.485 973.636 Q175.731 971.113 176.61 969.377 Q177.513 967.617 177.513 965.928 Q177.513 963.173 175.569 961.437 Q173.647 959.701 170.546 959.701 Q168.346 959.701 165.893 960.465 Q163.462 961.229 160.684 962.779 L160.684 958.057 Q163.509 956.923 165.962 956.344 Q168.416 955.766 170.453 955.766 Q175.823 955.766 179.018 958.451 Q182.212 961.136 182.212 965.627 Q182.212 967.756 181.402 969.678 Q180.615 971.576 178.508 974.168 Q177.93 974.84 174.828 978.057 Q171.726 981.252 166.078 987.015 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip020)" d="M125.87 782.744 Q122.259 782.744 120.43 786.309 Q118.624 789.85 118.624 796.98 Q118.624 804.086 120.43 807.651 Q122.259 811.193 125.87 811.193 Q129.504 811.193 131.31 807.651 Q133.138 804.086 133.138 796.98 Q133.138 789.85 131.31 786.309 Q129.504 782.744 125.87 782.744 M125.87 779.04 Q131.68 779.04 134.736 783.647 Q137.814 788.23 137.814 796.98 Q137.814 805.707 134.736 810.313 Q131.68 814.897 125.87 814.897 Q120.06 814.897 116.981 810.313 Q113.925 805.707 113.925 796.98 Q113.925 788.23 116.981 783.647 Q120.06 779.04 125.87 779.04 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip020)" d="M146.032 808.346 L150.916 808.346 L150.916 814.225 L146.032 814.225 L146.032 808.346 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip020)" d="M175.268 795.591 Q178.624 796.309 180.499 798.577 Q182.397 800.846 182.397 804.179 Q182.397 809.295 178.879 812.096 Q175.36 814.897 168.879 814.897 Q166.703 814.897 164.388 814.457 Q162.096 814.04 159.643 813.184 L159.643 808.67 Q161.587 809.804 163.902 810.383 Q166.217 810.961 168.74 810.961 Q173.138 810.961 175.43 809.225 Q177.745 807.489 177.745 804.179 Q177.745 801.123 175.592 799.411 Q173.462 797.674 169.643 797.674 L165.615 797.674 L165.615 793.832 L169.828 793.832 Q173.277 793.832 175.106 792.466 Q176.934 791.077 176.934 788.485 Q176.934 785.823 175.036 784.411 Q173.161 782.975 169.643 782.975 Q167.721 782.975 165.522 783.392 Q163.323 783.809 160.684 784.688 L160.684 780.522 Q163.346 779.781 165.661 779.411 Q167.999 779.04 170.059 779.04 Q175.383 779.04 178.485 781.471 Q181.587 783.878 181.587 787.999 Q181.587 790.869 179.944 792.86 Q178.3 794.827 175.268 795.591 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip020)" d="M124.736 606.019 Q121.124 606.019 119.296 609.583 Q117.49 613.125 117.49 620.255 Q117.49 627.361 119.296 630.926 Q121.124 634.468 124.736 634.468 Q128.37 634.468 130.175 630.926 Q132.004 627.361 132.004 620.255 Q132.004 613.125 130.175 609.583 Q128.37 606.019 124.736 606.019 M124.736 602.315 Q130.546 602.315 133.601 606.921 Q136.68 611.505 136.68 620.255 Q136.68 628.981 133.601 633.588 Q130.546 638.171 124.736 638.171 Q118.925 638.171 115.847 633.588 Q112.791 628.981 112.791 620.255 Q112.791 611.505 115.847 606.921 Q118.925 602.315 124.736 602.315 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip020)" d="M144.898 631.62 L149.782 631.62 L149.782 637.5 L144.898 637.5 L144.898 631.62 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip020)" d="M172.814 607.014 L161.009 625.463 L172.814 625.463 L172.814 607.014 M171.587 602.94 L177.467 602.94 L177.467 625.463 L182.397 625.463 L182.397 629.352 L177.467 629.352 L177.467 637.5 L172.814 637.5 L172.814 629.352 L157.212 629.352 L157.212 624.838 L171.587 602.94 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip020)" d="M126.217 429.293 Q122.606 429.293 120.777 432.858 Q118.972 436.4 118.972 443.529 Q118.972 450.636 120.777 454.201 Q122.606 457.742 126.217 457.742 Q129.851 457.742 131.657 454.201 Q133.486 450.636 133.486 443.529 Q133.486 436.4 131.657 432.858 Q129.851 429.293 126.217 429.293 M126.217 425.59 Q132.027 425.59 135.083 430.196 Q138.161 434.779 138.161 443.529 Q138.161 452.256 135.083 456.863 Q132.027 461.446 126.217 461.446 Q120.407 461.446 117.328 456.863 Q114.273 452.256 114.273 443.529 Q114.273 434.779 117.328 430.196 Q120.407 425.59 126.217 425.59 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip020)" d="M146.379 454.895 L151.263 454.895 L151.263 460.775 L146.379 460.775 L146.379 454.895 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip020)" d="M161.495 426.215 L179.851 426.215 L179.851 430.15 L165.777 430.15 L165.777 438.622 Q166.796 438.275 167.814 438.113 Q168.833 437.928 169.851 437.928 Q175.638 437.928 179.018 441.099 Q182.397 444.27 182.397 449.687 Q182.397 455.265 178.925 458.367 Q175.453 461.446 169.133 461.446 Q166.958 461.446 164.689 461.076 Q162.444 460.705 160.036 459.964 L160.036 455.265 Q162.12 456.4 164.342 456.955 Q166.564 457.511 169.041 457.511 Q173.046 457.511 175.383 455.404 Q177.721 453.298 177.721 449.687 Q177.721 446.076 175.383 443.969 Q173.046 441.863 169.041 441.863 Q167.166 441.863 165.291 442.279 Q163.439 442.696 161.495 443.576 L161.495 426.215 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip020)" d="M125.06 252.568 Q121.449 252.568 119.62 256.133 Q117.814 259.674 117.814 266.804 Q117.814 273.91 119.62 277.475 Q121.449 281.017 125.06 281.017 Q128.694 281.017 130.499 277.475 Q132.328 273.91 132.328 266.804 Q132.328 259.674 130.499 256.133 Q128.694 252.568 125.06 252.568 M125.06 248.864 Q130.87 248.864 133.925 253.471 Q137.004 258.054 137.004 266.804 Q137.004 275.531 133.925 280.137 Q130.87 284.721 125.06 284.721 Q119.249 284.721 116.171 280.137 Q113.115 275.531 113.115 266.804 Q113.115 258.054 116.171 253.471 Q119.249 248.864 125.06 248.864 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip020)" d="M145.222 278.17 L150.106 278.17 L150.106 284.049 L145.222 284.049 L145.222 278.17 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip020)" d="M170.87 264.906 Q167.721 264.906 165.87 267.059 Q164.041 269.211 164.041 272.961 Q164.041 276.688 165.87 278.864 Q167.721 281.017 170.87 281.017 Q174.018 281.017 175.846 278.864 Q177.698 276.688 177.698 272.961 Q177.698 269.211 175.846 267.059 Q174.018 264.906 170.87 264.906 M180.152 250.253 L180.152 254.512 Q178.393 253.679 176.587 253.239 Q174.805 252.799 173.046 252.799 Q168.416 252.799 165.962 255.924 Q163.532 259.049 163.184 265.369 Q164.55 263.355 166.61 262.29 Q168.671 261.202 171.147 261.202 Q176.356 261.202 179.365 264.373 Q182.397 267.522 182.397 272.961 Q182.397 278.285 179.249 281.503 Q176.101 284.721 170.87 284.721 Q164.874 284.721 161.703 280.137 Q158.532 275.531 158.532 266.804 Q158.532 258.61 162.421 253.749 Q166.309 248.864 172.86 248.864 Q174.62 248.864 176.402 249.212 Q178.208 249.559 180.152 250.253 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip020)" d="M126.124 75.8426 Q122.513 75.8426 120.685 79.4074 Q118.879 82.9491 118.879 90.0787 Q118.879 97.1851 120.685 100.75 Q122.513 104.292 126.124 104.292 Q129.759 104.292 131.564 100.75 Q133.393 97.1851 133.393 90.0787 Q133.393 82.9491 131.564 79.4074 Q129.759 75.8426 126.124 75.8426 M126.124 72.139 Q131.935 72.139 134.99 76.7454 Q138.069 81.3287 138.069 90.0787 Q138.069 98.8055 134.99 103.412 Q131.935 107.995 126.124 107.995 Q120.314 107.995 117.236 103.412 Q114.18 98.8055 114.18 90.0787 Q114.18 81.3287 117.236 76.7454 Q120.314 72.139 126.124 72.139 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip020)" d="M146.286 101.444 L151.171 101.444 L151.171 107.324 L146.286 107.324 L146.286 101.444 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip020)" d="M160.175 72.764 L182.397 72.764 L182.397 74.7547 L169.851 107.324 L164.967 107.324 L176.772 76.6991 L160.175 76.6991 L160.175 72.764 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip020)" d="M28.3774 714.582 L46.2332 714.582 L46.2332 706.497 Q46.2332 702.01 43.9097 699.559 Q41.5862 697.108 37.2894 697.108 Q33.0243 697.108 30.7009 699.559 Q28.3774 702.01 28.3774 706.497 L28.3774 714.582 M23.0938 721.011 L23.0938 706.497 Q23.0938 698.508 26.7223 694.434 Q30.3189 690.329 37.2894 690.329 Q44.3235 690.329 47.9201 694.434 Q51.5167 698.508 51.5167 706.497 L51.5167 714.582 L70.6138 714.582 L70.6138 721.011 L23.0938 721.011 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip020)" d="M39.0718 670.468 Q39.0718 675.178 42.7639 677.915 Q46.4241 680.653 52.8217 680.653 Q59.2192 680.653 62.9113 677.947 Q66.5716 675.21 66.5716 670.468 Q66.5716 665.789 62.8795 663.051 Q59.1874 660.314 52.8217 660.314 Q46.4878 660.314 42.7957 663.051 Q39.0718 665.789 39.0718 670.468 M34.1065 670.468 Q34.1065 662.829 39.0718 658.468 Q44.037 654.108 52.8217 654.108 Q61.5745 654.108 66.5716 658.468 Q71.5369 662.829 71.5369 670.468 Q71.5369 678.138 66.5716 682.499 Q61.5745 686.827 52.8217 686.827 Q44.037 686.827 39.0718 682.499 Q34.1065 678.138 34.1065 670.468 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip020)" d="M21.0886 644.4 L21.0886 638.544 L70.6138 638.544 L70.6138 644.4 L21.0886 644.4 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip020)" d="M34.9659 626.29 L34.9659 620.433 L70.6138 620.433 L70.6138 626.29 L34.9659 626.29 M21.0886 626.29 L21.0886 620.433 L28.5047 620.433 L28.5047 626.29 L21.0886 626.29 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip020)" d="M36.3345 582.525 L41.809 582.525 Q40.4404 585.008 39.772 587.522 Q39.0718 590.005 39.0718 592.551 Q39.0718 598.249 42.7002 601.4 Q46.2968 604.551 52.8217 604.551 Q59.3465 604.551 62.975 601.4 Q66.5716 598.249 66.5716 592.551 Q66.5716 590.005 65.9032 587.522 Q65.203 585.008 63.8344 582.525 L69.2452 582.525 Q70.391 584.976 70.9639 587.618 Q71.5369 590.228 71.5369 593.188 Q71.5369 601.24 66.4761 605.983 Q61.4154 610.725 52.8217 610.725 Q44.1007 610.725 39.1036 605.951 Q34.1065 601.145 34.1065 592.806 Q34.1065 590.1 34.6794 587.522 Q35.2205 584.944 36.3345 582.525 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip020)" d="M73.924 557.508 Q80.2897 559.991 82.2312 562.346 Q84.1728 564.701 84.1728 568.648 L84.1728 573.327 L79.2712 573.327 L79.2712 569.889 Q79.2712 567.47 78.1254 566.134 Q76.9795 564.797 72.7145 563.174 L70.0409 562.123 L34.9659 576.542 L34.9659 570.335 L62.8477 559.195 L34.9659 548.055 L34.9659 541.848 L73.924 557.508 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip020)" d="M61.1775 486.82 Q61.4352 486.82 62.4335 487.109 Q63.4319 487.399 64.9778 488.108 Q66.5237 488.784 67.9407 489.718 Q69.3256 490.652 70.3562 492.198 Q71.3546 493.712 71.3546 495.451 Q71.3546 497.77 69.8087 499.315 Q68.2628 500.861 65.944 500.861 Q65.6219 500.861 65.2999 500.829 Q64.9778 500.797 64.7846 500.765 Q64.5591 500.733 64.2049 500.636 Q63.8184 500.507 63.6574 500.475 Q63.4963 500.41 63.0132 500.249 Q62.498 500.056 62.3047 499.992 Q51.87 495.902 47.5222 495.902 Q42.9168 495.902 42.9168 499.477 Q42.9168 502.665 45.2356 505.821 Q46.395 507.27 48.4562 508.655 Q50.5174 510.04 51.2903 510.298 Q52.965 510.588 54.2533 511.006 Q55.155 511.199 58.6655 512.133 L64.6235 513.583 L69.6155 514.839 Q70.324 515.096 70.8393 515.805 Q71.3546 516.513 71.3546 517.286 Q71.3546 517.93 70.9037 518.575 Q70.485 519.187 69.4866 519.187 Q68.9713 519.187 68.0374 518.929 L30.0344 509.364 L28.7462 509.17 Q28.3597 509.17 28.1665 509.332 Q27.9411 509.46 27.78 510.233 Q27.619 510.974 27.619 512.455 Q27.619 513.067 27.5868 513.357 Q27.5546 513.615 27.3936 513.84 Q27.2003 514.066 26.8139 514.066 Q26.2664 514.066 25.9765 513.84 Q25.6545 513.583 25.59 513.389 Q25.5256 513.196 25.4934 512.81 Q25.4612 512.262 25.3002 510.427 Q25.107 508.591 24.9781 507.013 Q24.8493 505.435 24.8493 504.758 Q24.8493 504.372 25.0425 504.179 Q25.2036 503.953 25.3968 503.921 L25.5578 503.889 L46.5238 509.042 Q41.4675 504.952 41.4675 499.283 Q41.4675 495.612 43.3677 493.647 Q45.2356 491.683 48.5206 491.683 Q52.2887 491.683 63.0132 495.708 Q66.0084 496.9 67.7153 496.9 Q68.8425 496.9 69.3578 496.546 Q69.8731 496.159 69.8731 495.322 Q69.8731 494.034 69.1324 492.907 Q68.3594 491.747 67.1034 490.942 Q65.8152 490.137 64.5269 489.589 Q63.2065 489.01 61.725 488.591 Q60.9199 488.333 60.7266 488.204 Q60.5334 488.043 60.5334 487.593 Q60.5334 486.82 61.1775 486.82 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip020)" d="M54.1244 478.676 Q42.9812 478.676 33.9958 474.521 Q30.2277 472.75 27.0715 470.27 Q23.9153 467.79 22.5305 466.148 Q21.1456 464.505 21.1456 464.054 Q21.1456 463.41 21.7897 463.378 Q22.1118 463.378 22.917 464.247 Q33.7381 474.875 54.1244 474.843 Q74.5752 474.843 84.9776 464.505 Q86.1049 463.378 86.4591 463.378 Q87.1032 463.378 87.1032 464.054 Q87.1032 464.505 85.7828 466.083 Q84.4624 467.661 81.435 470.109 Q78.4077 472.557 74.704 474.328 Q65.7185 478.676 54.1244 478.676 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip020)" d="M45.6221 427.454 Q47.4578 427.454 48.5528 428.582 Q49.6478 429.677 49.6478 431.062 Q49.6478 432.285 48.9393 432.929 Q48.2308 433.574 47.329 433.574 Q46.9425 433.574 46.4594 433.413 Q45.9441 433.252 45.3322 432.897 Q44.7203 432.511 44.2694 431.706 Q43.8186 430.9 43.7541 429.805 Q43.5287 430.031 43.4965 430.095 Q43.11 430.578 42.9812 431.48 Q42.9168 431.609 42.9168 432.06 Q42.9168 434.282 44.5593 436.536 Q46.1696 438.759 49.2291 441.496 Q52.804 444.942 54.1244 447.164 Q55.4127 437.406 61.0487 437.406 Q61.9827 437.406 63.1099 437.664 Q65.2355 438.179 66.7813 438.179 Q69.8731 438.179 69.8731 436.086 Q69.8731 434.057 67.8119 432.768 Q65.7507 431.448 61.725 430.353 Q60.9843 430.192 60.7588 430.031 Q60.5334 429.87 60.5334 429.419 Q60.5334 428.614 61.1775 428.614 Q64.9456 429.355 67.8441 430.997 Q71.3546 433.09 71.3546 436.214 Q71.3546 438.823 69.551 440.562 Q67.7153 442.269 64.8168 442.269 Q64.1082 442.269 62.498 442.011 Q61.8538 441.818 61.1131 441.818 Q59.5994 441.818 58.4722 442.656 Q57.3128 443.493 56.7331 444.846 Q56.1534 446.198 55.8958 447.325 Q55.6059 448.42 55.5093 449.483 Q69.1324 452.704 69.9697 453.155 Q70.5494 453.445 70.9359 454.089 Q71.3546 454.733 71.3546 455.409 Q71.3546 456.053 70.9037 456.697 Q70.485 457.309 69.4866 457.309 Q68.9713 457.309 68.0374 457.052 L30.0344 447.486 L28.7462 447.293 Q28.3597 447.293 28.1665 447.454 Q27.9411 447.583 27.78 448.356 Q27.619 449.097 27.619 450.578 Q27.619 451.19 27.5868 451.48 Q27.5546 451.738 27.3936 451.963 Q27.2003 452.189 26.8139 452.189 Q26.2664 452.189 25.9765 451.963 Q25.6545 451.705 25.59 451.512 Q25.5256 451.319 25.4934 450.933 Q25.4612 450.385 25.3002 448.549 Q25.107 446.714 24.9781 445.135 Q24.8493 443.557 24.8493 442.881 Q24.8493 442.495 25.0425 442.301 Q25.2036 442.076 25.3968 442.044 L25.5578 442.011 L53.3837 448.871 Q52.2565 446.037 47.2646 441.561 Q41.4675 436.375 41.4675 431.931 Q41.4675 429.838 42.7558 428.646 Q44.0118 427.454 45.6221 427.454 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip020)" d="M86.4591 420.371 Q86.1371 420.371 85.3319 419.534 Q74.5107 408.906 54.1244 408.906 Q33.6737 408.906 23.3356 419.115 Q22.144 420.371 21.7897 420.371 Q21.1456 420.371 21.1456 419.727 Q21.1456 419.276 22.4661 417.698 Q23.7865 416.088 26.8139 413.672 Q29.8412 411.224 33.5449 409.421 Q42.5303 405.073 54.1244 405.073 Q65.2677 405.073 74.2531 409.228 Q78.0212 410.999 81.1774 413.479 Q84.3335 415.959 85.7184 417.601 Q87.1032 419.244 87.1032 419.727 Q87.1032 420.371 86.4591 420.371 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip022)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="261.653,1039.9 278.071,1027.9 294.49,1016.29 310.908,1005.06 327.327,994.192 343.745,983.629 360.164,973.352 376.582,963.327 393.001,953.539 409.419,943.963 425.838,934.585 442.256,925.391 458.674,916.366 475.093,907.5 491.511,898.783 507.93,890.203 524.348,881.754 540.767,873.429 557.185,865.22 573.604,857.119 590.022,849.122 606.441,841.226 622.859,833.423 639.278,825.709 655.696,818.08 672.115,810.533 688.533,803.063 704.952,795.669 721.37,788.346 737.789,781.092 754.207,773.157 770.626,764.294 787.044,755.477 803.462,746.726 819.881,738.04 836.299,729.414 852.718,720.847 869.136,712.336 885.555,703.88 901.973,695.477 918.392,687.128 934.81,678.828 951.229,670.577 967.647,662.372 984.066,654.213 1000.48,646.099 1016.9,638.029 1033.32,630.001 1049.74,622.014 1066.16,614.066 1082.58,606.158 1099,598.288 1115.41,590.454 1131.83,582.656 1148.25,574.893 1164.67,567.166 1181.09,559.472 1197.51,551.81 1213.92,544.18 1230.34,536.582 1246.76,529.014 1263.18,521.476 1279.6,513.967 1296.02,506.488 1312.44,499.036 1328.85,491.611 1345.27,484.214 1361.69,476.844 1378.11,469.498 1394.53,462.178 1410.95,449.298 1427.36,436.338 1443.78,423.421 1460.2,410.545 1476.62,397.709 1493.04,384.914 1509.46,372.158 1525.88,359.44 1542.29,346.76 1558.71,334.117 1575.13,321.51 1591.55,308.939 1607.97,296.403 1624.39,283.902 1640.8,271.435 1657.22,259.001 1673.64,246.6 1690.06,234.232 1706.48,221.895 1722.9,209.589 1739.32,197.314 1755.73,185.07 1772.15,172.855 1788.57,160.669 1804.99,148.513 1821.41,136.385 1837.83,124.285 1854.25,112.212 1870.66,100.167 1887.08,88.1484 1903.5,76.1564 "></polyline>
</svg>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-pfi-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4: Policy Function Iteration.
</figcaption>
</figure>
</div>
</div>
<p>ここから <span class="math inline">\(k' := g(k) = f(k) + (1-\delta)k - h(k)\)</span> が求められます. さらに, <span class="math inline">\(h(k), g(k)\)</span> から価値関数 <span class="math inline">\(V(k)\)</span> を求める方法は主に2つあります.</p>
<ol type="1">
<li><span class="math inline">\(V(k) \leftarrow u(h(k)) + \beta V(g(k))\)</span> を用いて <span class="math inline">\(V(k)\)</span> の不動点を求める方法 (VFI)</li>
<li>線形方程式
<ol type="1">
<li>離散化された <span class="math inline">\(k\)</span> から <span class="math inline">\(k'\)</span> への遷移行列 <span class="math inline">\(P\)</span> を求める. グリッド <span class="math inline">\(k_i\)</span> が <span class="math inline">\(k_j\)</span> と <span class="math inline">\(k_{j+1}\)</span> の間に遷移する場合, 以下のように定義します.
<ul>
<li><span class="math inline">\(P_{i, j} = \frac{k_{j+1} - g(k_i)}{k_{j+1} - k_j}\)</span></li>
<li><span class="math inline">\(P_{i, j+1} = \frac{g(k_i) - k_j}{k_{j+1} - k_j}\)</span></li>
<li><span class="math inline">\(P_{i, k} = 0\)</span>, <span class="math inline">\(k \neq j, j+1\)</span></li>
</ul></li>
<li><span class="math inline">\(u, V\)</span> を <span class="math inline">\(u(h(k)), V(k)\)</span> からなる離散化されたベクトルとすると, <span class="math inline">\(V = u + \beta P V\)</span> となる</li>
<li><span class="math inline">\(V = (I - \beta P)^{-1} u\)</span> により <span class="math inline">\(V\)</span> を求めることができる</li>
</ol></li>
</ol>
<p>ここでは, より高速な線型方程式を用いる方法を実装します. より速度を求める場合, 遷移行列はほとんどの要素がゼロであるため, 疎行列 (Sparse Matrix) を用いることで高速化する可能性があります. Juliaの場合, <code>SparseArrays.jl</code> で実装されています.</p>
<div id="cell-fig-pfi-vf" class="cell" data-execution_count="1">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb18"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">compute_vf!</span>(m<span class="op">::</span><span class="dt">Model</span>)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>    (; h, n_k, k_grid, h, β, δ) <span class="op">=</span> m</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>    P <span class="op">=</span> <span class="fu">zeros</span>(n_k, n_k)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i_k, k) <span class="kw">in</span> <span class="fu">enumerate</span>(k_grid)</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>        g <span class="op">=</span> <span class="fu">f</span>(k; m) <span class="op">+</span> (<span class="fl">1</span> <span class="op">-</span> δ) <span class="op">*</span> k <span class="op">-</span> h[i_k]</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>        j <span class="op">=</span> <span class="fu">searchsortedlast</span>(k_grid, g)</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> j <span class="op">==</span> <span class="fl">1</span> <span class="op">||</span> j <span class="op">==</span> n_k</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>            P[i_k, j] <span class="op">=</span> <span class="fl">1.0</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>            P[i_k, j] <span class="op">=</span> (k_grid[j<span class="op">+</span><span class="fl">1</span>] <span class="op">-</span> g) <span class="op">/</span> (k_grid[j<span class="op">+</span><span class="fl">1</span>] <span class="op">-</span> k_grid[j])</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>            P[i_k, j<span class="op">+</span><span class="fl">1</span>] <span class="op">=</span> (g <span class="op">-</span> k_grid[j]) <span class="op">/</span> (k_grid[j<span class="op">+</span><span class="fl">1</span>] <span class="op">-</span> k_grid[j])</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">end</span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>    m.V <span class="op">.=</span> (I <span class="op">-</span> β <span class="op">*</span> P) <span class="op">\</span> (<span class="fu">u</span>.(h; m))</span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="cn">nothing</span></span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a><span class="fu">compute_vf!</span>(m)</span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(m.k_grid, m.V, label<span class="op">=</span><span class="cn">false</span>, xlabel<span class="op">=</span>L<span class="st">"Capital </span><span class="sc">$</span>k<span class="sc">$</span><span class="st">", </span>ylabel<span class="st">=L"</span>Value <span class="op">$</span><span class="fu">V</span>(k)<span class="op">$</span><span class="st">")</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div id="fig-pfi-vf" class="cell-output cell-output-display quarto-float quarto-figure quarto-figure-center anchored" data-execution_count="1">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-pfi-vf-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<!--?xml version="1.0" encoding="utf-8"?-->
<svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" width="500" height="309" viewbox="0 0 2000 1236">
<defs>
  <clippath id="clip080">
    <rect x="0" y="0" width="2000" height="1236"></rect>
  </clippath>
</defs>
<path clip-path="url(#clip080)" d="M0 1236 L2000 1236 L2000 1.24345e-14 L0 1.24345e-14  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<defs>
  <clippath id="clip081">
    <rect x="400" y="0" width="1401" height="1236"></rect>
  </clippath>
</defs>
<path clip-path="url(#clip080)" d="M279.897 1068.81 L1952.76 1068.81 L1952.76 47.2441 L279.897 47.2441  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<defs>
  <clippath id="clip082">
    <rect x="279" y="47" width="1674" height="1023"></rect>
  </clippath>
</defs>
<polyline clip-path="url(#clip082)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="502.594,1068.81 502.594,47.2441 "></polyline>
<polyline clip-path="url(#clip082)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="853.298,1068.81 853.298,47.2441 "></polyline>
<polyline clip-path="url(#clip082)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1204,1068.81 1204,47.2441 "></polyline>
<polyline clip-path="url(#clip082)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1554.71,1068.81 1554.71,47.2441 "></polyline>
<polyline clip-path="url(#clip082)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1905.41,1068.81 1905.41,47.2441 "></polyline>
<polyline clip-path="url(#clip082)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="279.897,953.981 1952.76,953.981 "></polyline>
<polyline clip-path="url(#clip082)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="279.897,768.176 1952.76,768.176 "></polyline>
<polyline clip-path="url(#clip082)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="279.897,582.37 1952.76,582.37 "></polyline>
<polyline clip-path="url(#clip082)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="279.897,396.565 1952.76,396.565 "></polyline>
<polyline clip-path="url(#clip082)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="279.897,210.76 1952.76,210.76 "></polyline>
<polyline clip-path="url(#clip080)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="279.897,1068.81 1952.76,1068.81 "></polyline>
<polyline clip-path="url(#clip080)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="502.594,1068.81 502.594,1049.91 "></polyline>
<polyline clip-path="url(#clip080)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="853.298,1068.81 853.298,1049.91 "></polyline>
<polyline clip-path="url(#clip080)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1204,1068.81 1204,1049.91 "></polyline>
<polyline clip-path="url(#clip080)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1554.71,1068.81 1554.71,1049.91 "></polyline>
<polyline clip-path="url(#clip080)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1905.41,1068.81 1905.41,1049.91 "></polyline>
<path clip-path="url(#clip080)" d="M480.592 1096.53 Q476.981 1096.53 475.152 1100.1 Q473.347 1103.64 473.347 1110.77 Q473.347 1117.87 475.152 1121.44 Q476.981 1124.98 480.592 1124.98 Q484.226 1124.98 486.032 1121.44 Q487.86 1117.87 487.86 1110.77 Q487.86 1103.64 486.032 1100.1 Q484.226 1096.53 480.592 1096.53 M480.592 1092.83 Q486.402 1092.83 489.458 1097.43 Q492.536 1102.02 492.536 1110.77 Q492.536 1119.49 489.458 1124.1 Q486.402 1128.68 480.592 1128.68 Q474.782 1128.68 471.703 1124.1 Q468.648 1119.49 468.648 1110.77 Q468.648 1102.02 471.703 1097.43 Q474.782 1092.83 480.592 1092.83 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip080)" d="M500.754 1122.13 L505.638 1122.13 L505.638 1128.01 L500.754 1128.01 L500.754 1122.13 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip080)" d="M516.633 1124.08 L524.272 1124.08 L524.272 1097.71 L515.962 1099.38 L515.962 1095.12 L524.226 1093.45 L528.902 1093.45 L528.902 1124.08 L536.541 1124.08 L536.541 1128.01 L516.633 1128.01 L516.633 1124.08 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip080)" d="M831.481 1096.53 Q827.87 1096.53 826.041 1100.1 Q824.236 1103.64 824.236 1110.77 Q824.236 1117.87 826.041 1121.44 Q827.87 1124.98 831.481 1124.98 Q835.116 1124.98 836.921 1121.44 Q838.75 1117.87 838.75 1110.77 Q838.75 1103.64 836.921 1100.1 Q835.116 1096.53 831.481 1096.53 M831.481 1092.83 Q837.291 1092.83 840.347 1097.43 Q843.426 1102.02 843.426 1110.77 Q843.426 1119.49 840.347 1124.1 Q837.291 1128.68 831.481 1128.68 Q825.671 1128.68 822.592 1124.1 Q819.537 1119.49 819.537 1110.77 Q819.537 1102.02 822.592 1097.43 Q825.671 1092.83 831.481 1092.83 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip080)" d="M851.643 1122.13 L856.527 1122.13 L856.527 1128.01 L851.643 1128.01 L851.643 1122.13 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip080)" d="M870.74 1124.08 L887.06 1124.08 L887.06 1128.01 L865.115 1128.01 L865.115 1124.08 Q867.777 1121.32 872.361 1116.69 Q876.967 1112.04 878.148 1110.7 Q880.393 1108.17 881.273 1106.44 Q882.175 1104.68 882.175 1102.99 Q882.175 1100.23 880.231 1098.5 Q878.31 1096.76 875.208 1096.76 Q873.009 1096.76 870.555 1097.53 Q868.125 1098.29 865.347 1099.84 L865.347 1095.12 Q868.171 1093.98 870.625 1093.41 Q873.078 1092.83 875.115 1092.83 Q880.486 1092.83 883.68 1095.51 Q886.874 1098.2 886.874 1102.69 Q886.874 1104.82 886.064 1106.74 Q885.277 1108.64 883.171 1111.23 Q882.592 1111.9 879.49 1115.12 Q876.388 1118.31 870.74 1124.08 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip080)" d="M1181.71 1096.53 Q1178.1 1096.53 1176.27 1100.1 Q1174.47 1103.64 1174.47 1110.77 Q1174.47 1117.87 1176.27 1121.44 Q1178.1 1124.98 1181.71 1124.98 Q1185.35 1124.98 1187.15 1121.44 Q1188.98 1117.87 1188.98 1110.77 Q1188.98 1103.64 1187.15 1100.1 Q1185.35 1096.53 1181.71 1096.53 M1181.71 1092.83 Q1187.52 1092.83 1190.58 1097.43 Q1193.66 1102.02 1193.66 1110.77 Q1193.66 1119.49 1190.58 1124.1 Q1187.52 1128.68 1181.71 1128.68 Q1175.9 1128.68 1172.82 1124.1 Q1169.77 1119.49 1169.77 1110.77 Q1169.77 1102.02 1172.82 1097.43 Q1175.9 1092.83 1181.71 1092.83 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip080)" d="M1201.87 1122.13 L1206.76 1122.13 L1206.76 1128.01 L1201.87 1128.01 L1201.87 1122.13 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip080)" d="M1231.11 1109.38 Q1234.47 1110.1 1236.34 1112.36 Q1238.24 1114.63 1238.24 1117.97 Q1238.24 1123.08 1234.72 1125.88 Q1231.2 1128.68 1224.72 1128.68 Q1222.54 1128.68 1220.23 1128.24 Q1217.94 1127.83 1215.48 1126.97 L1215.48 1122.46 Q1217.43 1123.59 1219.74 1124.17 Q1222.06 1124.75 1224.58 1124.75 Q1228.98 1124.75 1231.27 1123.01 Q1233.59 1121.28 1233.59 1117.97 Q1233.59 1114.91 1231.43 1113.2 Q1229.3 1111.46 1225.48 1111.46 L1221.46 1111.46 L1221.46 1107.62 L1225.67 1107.62 Q1229.12 1107.62 1230.95 1106.25 Q1232.78 1104.86 1232.78 1102.27 Q1232.78 1099.61 1230.88 1098.2 Q1229 1096.76 1225.48 1096.76 Q1223.56 1096.76 1221.36 1097.18 Q1219.16 1097.6 1216.53 1098.47 L1216.53 1094.31 Q1219.19 1093.57 1221.5 1093.2 Q1223.84 1092.83 1225.9 1092.83 Q1231.22 1092.83 1234.33 1095.26 Q1237.43 1097.66 1237.43 1101.78 Q1237.43 1104.66 1235.78 1106.65 Q1234.14 1108.61 1231.11 1109.38 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip080)" d="M1531.85 1096.53 Q1528.24 1096.53 1526.41 1100.1 Q1524.6 1103.64 1524.6 1110.77 Q1524.6 1117.87 1526.41 1121.44 Q1528.24 1124.98 1531.85 1124.98 Q1535.48 1124.98 1537.29 1121.44 Q1539.12 1117.87 1539.12 1110.77 Q1539.12 1103.64 1537.29 1100.1 Q1535.48 1096.53 1531.85 1096.53 M1531.85 1092.83 Q1537.66 1092.83 1540.71 1097.43 Q1543.79 1102.02 1543.79 1110.77 Q1543.79 1119.49 1540.71 1124.1 Q1537.66 1128.68 1531.85 1128.68 Q1526.04 1128.68 1522.96 1124.1 Q1519.9 1119.49 1519.9 1110.77 Q1519.9 1102.02 1522.96 1097.43 Q1526.04 1092.83 1531.85 1092.83 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip080)" d="M1552.01 1122.13 L1556.89 1122.13 L1556.89 1128.01 L1552.01 1128.01 L1552.01 1122.13 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip080)" d="M1579.93 1097.53 L1568.12 1115.97 L1579.93 1115.97 L1579.93 1097.53 M1578.7 1093.45 L1584.58 1093.45 L1584.58 1115.97 L1589.51 1115.97 L1589.51 1119.86 L1584.58 1119.86 L1584.58 1128.01 L1579.93 1128.01 L1579.93 1119.86 L1564.32 1119.86 L1564.32 1115.35 L1578.7 1093.45 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip080)" d="M1883.29 1096.53 Q1879.68 1096.53 1877.85 1100.1 Q1876.05 1103.64 1876.05 1110.77 Q1876.05 1117.87 1877.85 1121.44 Q1879.68 1124.98 1883.29 1124.98 Q1886.93 1124.98 1888.73 1121.44 Q1890.56 1117.87 1890.56 1110.77 Q1890.56 1103.64 1888.73 1100.1 Q1886.93 1096.53 1883.29 1096.53 M1883.29 1092.83 Q1889.1 1092.83 1892.16 1097.43 Q1895.24 1102.02 1895.24 1110.77 Q1895.24 1119.49 1892.16 1124.1 Q1889.1 1128.68 1883.29 1128.68 Q1877.48 1128.68 1874.4 1124.1 Q1871.35 1119.49 1871.35 1110.77 Q1871.35 1102.02 1874.4 1097.43 Q1877.48 1092.83 1883.29 1092.83 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip080)" d="M1903.45 1122.13 L1908.34 1122.13 L1908.34 1128.01 L1903.45 1128.01 L1903.45 1122.13 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip080)" d="M1918.57 1093.45 L1936.93 1093.45 L1936.93 1097.39 L1922.85 1097.39 L1922.85 1105.86 Q1923.87 1105.51 1924.89 1105.35 Q1925.91 1105.16 1926.93 1105.16 Q1932.71 1105.16 1936.09 1108.34 Q1939.47 1111.51 1939.47 1116.92 Q1939.47 1122.5 1936 1125.6 Q1932.53 1128.68 1926.21 1128.68 Q1924.03 1128.68 1921.76 1128.31 Q1919.52 1127.94 1917.11 1127.2 L1917.11 1122.5 Q1919.2 1123.64 1921.42 1124.19 Q1923.64 1124.75 1926.12 1124.75 Q1930.12 1124.75 1932.46 1122.64 Q1934.8 1120.53 1934.8 1116.92 Q1934.8 1113.31 1932.46 1111.21 Q1930.12 1109.1 1926.12 1109.1 Q1924.24 1109.1 1922.37 1109.52 Q1920.51 1109.93 1918.57 1110.81 L1918.57 1093.45 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip080)" d="M1014.82 1157.6 L1014.82 1164.38 Q1011.57 1161.36 1007.88 1159.86 Q1004.22 1158.37 1000.08 1158.37 Q991.936 1158.37 987.607 1163.36 Q983.278 1168.33 983.278 1177.75 Q983.278 1187.14 987.607 1192.14 Q991.936 1197.1 1000.08 1197.1 Q1004.22 1197.1 1007.88 1195.61 Q1011.57 1194.11 1014.82 1191.09 L1014.82 1197.8 Q1011.45 1200.09 1007.66 1201.24 Q1003.9 1202.38 999.702 1202.38 Q988.912 1202.38 982.705 1195.8 Q976.499 1189.18 976.499 1177.75 Q976.499 1166.29 982.705 1159.7 Q988.912 1153.08 999.702 1153.08 Q1003.97 1153.08 1007.72 1154.23 Q1011.51 1155.34 1014.82 1157.6 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip080)" d="M1040.7 1183.54 Q1033.6 1183.54 1030.86 1185.17 Q1028.12 1186.79 1028.12 1190.7 Q1028.12 1193.82 1030.16 1195.67 Q1032.23 1197.48 1035.76 1197.48 Q1040.63 1197.48 1043.56 1194.05 Q1046.52 1190.58 1046.52 1184.85 L1046.52 1183.54 L1040.7 1183.54 M1052.38 1181.12 L1052.38 1201.46 L1046.52 1201.46 L1046.52 1196.05 Q1044.52 1199.3 1041.52 1200.86 Q1038.53 1202.38 1034.2 1202.38 Q1028.73 1202.38 1025.48 1199.33 Q1022.27 1196.24 1022.27 1191.09 Q1022.27 1185.07 1026.28 1182.01 Q1030.32 1178.96 1038.31 1178.96 L1046.52 1178.96 L1046.52 1178.39 Q1046.52 1174.34 1043.85 1172.15 Q1041.21 1169.92 1036.4 1169.92 Q1033.34 1169.92 1030.45 1170.65 Q1027.55 1171.38 1024.88 1172.85 L1024.88 1167.44 Q1028.09 1166.2 1031.12 1165.59 Q1034.14 1164.95 1037 1164.95 Q1044.74 1164.95 1048.56 1168.96 Q1052.38 1172.98 1052.38 1181.12 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip080)" d="M1070.11 1196.11 L1070.11 1215.02 L1064.22 1215.02 L1064.22 1165.81 L1070.11 1165.81 L1070.11 1171.22 Q1071.95 1168.04 1074.75 1166.51 Q1077.59 1164.95 1081.5 1164.95 Q1087.99 1164.95 1092.04 1170.11 Q1096.11 1175.27 1096.11 1183.67 Q1096.11 1192.07 1092.04 1197.23 Q1087.99 1202.38 1081.5 1202.38 Q1077.59 1202.38 1074.75 1200.86 Q1071.95 1199.3 1070.11 1196.11 M1090.03 1183.67 Q1090.03 1177.21 1087.36 1173.55 Q1084.72 1169.86 1080.07 1169.86 Q1075.42 1169.86 1072.75 1173.55 Q1070.11 1177.21 1070.11 1183.67 Q1070.11 1190.13 1072.75 1193.82 Q1075.42 1197.48 1080.07 1197.48 Q1084.72 1197.48 1087.36 1193.82 Q1090.03 1190.13 1090.03 1183.67 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip080)" d="M1105.82 1165.81 L1111.67 1165.81 L1111.67 1201.46 L1105.82 1201.46 L1105.82 1165.81 M1105.82 1151.94 L1111.67 1151.94 L1111.67 1159.35 L1105.82 1159.35 L1105.82 1151.94 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip080)" d="M1129.72 1155.69 L1129.72 1165.81 L1141.78 1165.81 L1141.78 1170.37 L1129.72 1170.37 L1129.72 1189.72 Q1129.72 1194.08 1130.9 1195.32 Q1132.11 1196.56 1135.77 1196.56 L1141.78 1196.56 L1141.78 1201.46 L1135.77 1201.46 Q1128.99 1201.46 1126.41 1198.95 Q1123.83 1196.4 1123.83 1189.72 L1123.83 1170.37 L1119.54 1170.37 L1119.54 1165.81 L1123.83 1165.81 L1123.83 1155.69 L1129.72 1155.69 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip080)" d="M1165.69 1183.54 Q1158.59 1183.54 1155.85 1185.17 Q1153.12 1186.79 1153.12 1190.7 Q1153.12 1193.82 1155.15 1195.67 Q1157.22 1197.48 1160.75 1197.48 Q1165.62 1197.48 1168.55 1194.05 Q1171.51 1190.58 1171.51 1184.85 L1171.51 1183.54 L1165.69 1183.54 M1177.37 1181.12 L1177.37 1201.46 L1171.51 1201.46 L1171.51 1196.05 Q1169.51 1199.3 1166.52 1200.86 Q1163.52 1202.38 1159.19 1202.38 Q1153.72 1202.38 1150.47 1199.33 Q1147.26 1196.24 1147.26 1191.09 Q1147.26 1185.07 1151.27 1182.01 Q1155.31 1178.96 1163.3 1178.96 L1171.51 1178.96 L1171.51 1178.39 Q1171.51 1174.34 1168.84 1172.15 Q1166.2 1169.92 1161.39 1169.92 Q1158.34 1169.92 1155.44 1170.65 Q1152.54 1171.38 1149.87 1172.85 L1149.87 1167.44 Q1153.08 1166.2 1156.11 1165.59 Q1159.13 1164.95 1162 1164.95 Q1169.73 1164.95 1173.55 1168.96 Q1177.37 1172.98 1177.37 1181.12 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip080)" d="M1189.43 1151.94 L1195.29 1151.94 L1195.29 1201.46 L1189.43 1201.46 L1189.43 1151.94 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip080)" d="M1251.97 1176.47 Q1251.97 1178.31 1250.85 1179.4 Q1249.75 1180.5 1248.37 1180.5 Q1247.14 1180.5 1246.5 1179.79 Q1245.86 1179.08 1245.86 1178.18 Q1245.86 1177.79 1246.02 1177.31 Q1246.18 1176.79 1246.53 1176.18 Q1246.92 1175.57 1247.72 1175.12 Q1248.53 1174.67 1249.62 1174.6 Q1249.4 1174.38 1249.33 1174.34 Q1248.85 1173.96 1247.95 1173.83 Q1247.82 1173.76 1247.37 1173.76 Q1245.15 1173.76 1242.89 1175.41 Q1240.67 1177.02 1237.93 1180.08 Q1234.49 1183.65 1232.26 1184.97 Q1242.02 1186.26 1242.02 1191.9 Q1242.02 1192.83 1241.77 1193.96 Q1241.25 1196.08 1241.25 1197.63 Q1241.25 1200.72 1243.34 1200.72 Q1245.37 1200.72 1246.66 1198.66 Q1247.98 1196.6 1249.08 1192.57 Q1249.24 1191.83 1249.4 1191.61 Q1249.56 1191.38 1250.01 1191.38 Q1250.82 1191.38 1250.82 1192.03 Q1250.07 1195.79 1248.43 1198.69 Q1246.34 1202.2 1243.21 1202.2 Q1240.61 1202.2 1238.87 1200.4 Q1237.16 1198.56 1237.16 1195.66 Q1237.16 1194.96 1237.42 1193.35 Q1237.61 1192.7 1237.61 1191.96 Q1237.61 1190.45 1236.77 1189.32 Q1235.94 1188.16 1234.58 1187.58 Q1233.23 1187 1232.1 1186.74 Q1231.01 1186.45 1229.95 1186.36 Q1226.73 1199.98 1226.27 1200.82 Q1225.98 1201.4 1225.34 1201.78 Q1224.7 1202.2 1224.02 1202.2 Q1223.38 1202.2 1222.73 1201.75 Q1222.12 1201.33 1222.12 1200.33 Q1222.12 1199.82 1222.38 1198.89 L1231.94 1160.88 L1232.14 1159.59 Q1232.14 1159.21 1231.97 1159.01 Q1231.85 1158.79 1231.07 1158.63 Q1230.33 1158.47 1228.85 1158.47 Q1228.24 1158.47 1227.95 1158.43 Q1227.69 1158.4 1227.47 1158.24 Q1227.24 1158.05 1227.24 1157.66 Q1227.24 1157.11 1227.47 1156.82 Q1227.72 1156.5 1227.92 1156.44 Q1228.11 1156.37 1228.5 1156.34 Q1229.04 1156.31 1230.88 1156.15 Q1232.72 1155.95 1234.29 1155.83 Q1235.87 1155.7 1236.55 1155.7 Q1236.93 1155.7 1237.13 1155.89 Q1237.35 1156.05 1237.39 1156.24 L1237.42 1156.41 L1230.56 1184.23 Q1233.39 1183.1 1237.87 1178.11 Q1243.05 1172.32 1247.5 1172.32 Q1249.59 1172.32 1250.78 1173.6 Q1251.97 1174.86 1251.97 1176.47 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip080)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="279.897,1068.81 279.897,47.2441 "></polyline>
<polyline clip-path="url(#clip080)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="279.897,953.981 298.795,953.981 "></polyline>
<polyline clip-path="url(#clip080)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="279.897,768.176 298.795,768.176 "></polyline>
<polyline clip-path="url(#clip080)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="279.897,582.37 298.795,582.37 "></polyline>
<polyline clip-path="url(#clip080)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="279.897,396.565 298.795,396.565 "></polyline>
<polyline clip-path="url(#clip080)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="279.897,210.76 298.795,210.76 "></polyline>
<path clip-path="url(#clip080)" d="M112.791 954.433 L142.467 954.433 L142.467 958.368 L112.791 958.368 L112.791 954.433 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip080)" d="M153.37 967.326 L161.009 967.326 L161.009 940.96 L152.698 942.627 L152.698 938.368 L160.962 936.701 L165.638 936.701 L165.638 967.326 L173.277 967.326 L173.277 971.261 L153.37 971.261 L153.37 967.326 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip080)" d="M183.532 967.326 L191.17 967.326 L191.17 940.96 L182.86 942.627 L182.86 938.368 L191.124 936.701 L195.8 936.701 L195.8 967.326 L203.439 967.326 L203.439 971.261 L183.532 971.261 L183.532 967.326 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip080)" d="M212.883 965.382 L217.767 965.382 L217.767 971.261 L212.883 971.261 L212.883 965.382 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip080)" d="M237.953 939.78 Q234.341 939.78 232.513 943.345 Q230.707 946.886 230.707 954.016 Q230.707 961.122 232.513 964.687 Q234.341 968.229 237.953 968.229 Q241.587 968.229 243.392 964.687 Q245.221 961.122 245.221 954.016 Q245.221 946.886 243.392 943.345 Q241.587 939.78 237.953 939.78 M237.953 936.076 Q243.763 936.076 246.818 940.683 Q249.897 945.266 249.897 954.016 Q249.897 962.743 246.818 967.349 Q243.763 971.932 237.953 971.932 Q232.142 971.932 229.064 967.349 Q226.008 962.743 226.008 954.016 Q226.008 945.266 229.064 940.683 Q232.142 936.076 237.953 936.076 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip080)" d="M113.787 768.627 L143.462 768.627 L143.462 772.562 L113.787 772.562 L113.787 768.627 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip080)" d="M154.365 781.521 L162.004 781.521 L162.004 755.155 L153.694 756.822 L153.694 752.562 L161.958 750.896 L166.634 750.896 L166.634 781.521 L174.272 781.521 L174.272 785.456 L154.365 785.456 L154.365 781.521 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip080)" d="M193.717 753.974 Q190.106 753.974 188.277 757.539 Q186.471 761.081 186.471 768.211 Q186.471 775.317 188.277 778.882 Q190.106 782.423 193.717 782.423 Q197.351 782.423 199.156 778.882 Q200.985 775.317 200.985 768.211 Q200.985 761.081 199.156 757.539 Q197.351 753.974 193.717 753.974 M193.717 750.271 Q199.527 750.271 202.582 754.877 Q205.661 759.461 205.661 768.211 Q205.661 776.937 202.582 781.544 Q199.527 786.127 193.717 786.127 Q187.907 786.127 184.828 781.544 Q181.772 776.937 181.772 768.211 Q181.772 759.461 184.828 754.877 Q187.907 750.271 193.717 750.271 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip080)" d="M213.879 779.576 L218.763 779.576 L218.763 785.456 L213.879 785.456 L213.879 779.576 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip080)" d="M228.994 750.896 L247.351 750.896 L247.351 754.831 L233.277 754.831 L233.277 763.303 Q234.295 762.956 235.314 762.794 Q236.332 762.609 237.351 762.609 Q243.138 762.609 246.517 765.78 Q249.897 768.951 249.897 774.368 Q249.897 779.947 246.425 783.048 Q242.953 786.127 236.633 786.127 Q234.457 786.127 232.189 785.757 Q229.943 785.386 227.536 784.646 L227.536 779.947 Q229.619 781.081 231.841 781.636 Q234.064 782.192 236.541 782.192 Q240.545 782.192 242.883 780.085 Q245.221 777.979 245.221 774.368 Q245.221 770.757 242.883 768.65 Q240.545 766.544 236.541 766.544 Q234.666 766.544 232.791 766.961 Q230.939 767.377 228.994 768.257 L228.994 750.896 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip080)" d="M112.791 582.822 L142.467 582.822 L142.467 586.757 L112.791 586.757 L112.791 582.822 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip080)" d="M153.37 595.715 L161.009 595.715 L161.009 569.35 L152.698 571.016 L152.698 566.757 L160.962 565.09 L165.638 565.09 L165.638 595.715 L173.277 595.715 L173.277 599.65 L153.37 599.65 L153.37 595.715 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip080)" d="M192.721 568.169 Q189.11 568.169 187.282 571.734 Q185.476 575.276 185.476 582.405 Q185.476 589.512 187.282 593.076 Q189.11 596.618 192.721 596.618 Q196.356 596.618 198.161 593.076 Q199.99 589.512 199.99 582.405 Q199.99 575.276 198.161 571.734 Q196.356 568.169 192.721 568.169 M192.721 564.465 Q198.531 564.465 201.587 569.072 Q204.666 573.655 204.666 582.405 Q204.666 591.132 201.587 595.738 Q198.531 600.322 192.721 600.322 Q186.911 600.322 183.832 595.738 Q180.777 591.132 180.777 582.405 Q180.777 573.655 183.832 569.072 Q186.911 564.465 192.721 564.465 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip080)" d="M212.883 593.771 L217.767 593.771 L217.767 599.65 L212.883 599.65 L212.883 593.771 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip080)" d="M237.953 568.169 Q234.341 568.169 232.513 571.734 Q230.707 575.276 230.707 582.405 Q230.707 589.512 232.513 593.076 Q234.341 596.618 237.953 596.618 Q241.587 596.618 243.392 593.076 Q245.221 589.512 245.221 582.405 Q245.221 575.276 243.392 571.734 Q241.587 568.169 237.953 568.169 M237.953 564.465 Q243.763 564.465 246.818 569.072 Q249.897 573.655 249.897 582.405 Q249.897 591.132 246.818 595.738 Q243.763 600.322 237.953 600.322 Q232.142 600.322 229.064 595.738 Q226.008 591.132 226.008 582.405 Q226.008 573.655 229.064 569.072 Q232.142 564.465 237.953 564.465 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip080)" d="M143.948 397.016 L173.624 397.016 L173.624 400.952 L143.948 400.952 L143.948 397.016 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip080)" d="M183.856 413.127 L183.856 408.868 Q185.615 409.702 187.42 410.141 Q189.226 410.581 190.962 410.581 Q195.592 410.581 198.022 407.479 Q200.476 404.354 200.823 398.012 Q199.481 400.003 197.42 401.067 Q195.36 402.132 192.86 402.132 Q187.675 402.132 184.643 399.007 Q181.633 395.859 181.633 390.419 Q181.633 385.095 184.782 381.878 Q187.93 378.66 193.161 378.66 Q199.156 378.66 202.305 383.266 Q205.476 387.85 205.476 396.6 Q205.476 404.771 201.587 409.655 Q197.721 414.516 191.17 414.516 Q189.411 414.516 187.606 414.169 Q185.8 413.822 183.856 413.127 M193.161 398.475 Q196.309 398.475 198.138 396.322 Q199.99 394.169 199.99 390.419 Q199.99 386.692 198.138 384.54 Q196.309 382.364 193.161 382.364 Q190.013 382.364 188.161 384.54 Q186.332 386.692 186.332 390.419 Q186.332 394.169 188.161 396.322 Q190.013 398.475 193.161 398.475 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip080)" d="M213.879 407.965 L218.763 407.965 L218.763 413.845 L213.879 413.845 L213.879 407.965 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip080)" d="M228.994 379.285 L247.351 379.285 L247.351 383.22 L233.277 383.22 L233.277 391.692 Q234.295 391.345 235.314 391.183 Q236.332 390.998 237.351 390.998 Q243.138 390.998 246.517 394.169 Q249.897 397.34 249.897 402.757 Q249.897 408.336 246.425 411.438 Q242.953 414.516 236.633 414.516 Q234.457 414.516 232.189 414.146 Q229.943 413.776 227.536 413.035 L227.536 408.336 Q229.619 409.47 231.841 410.026 Q234.064 410.581 236.541 410.581 Q240.545 410.581 242.883 408.475 Q245.221 406.368 245.221 402.757 Q245.221 399.146 242.883 397.04 Q240.545 394.933 236.541 394.933 Q234.666 394.933 232.791 395.35 Q230.939 395.766 228.994 396.646 L228.994 379.285 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip080)" d="M142.953 211.211 L172.629 211.211 L172.629 215.146 L142.953 215.146 L142.953 211.211 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip080)" d="M182.86 227.322 L182.86 223.063 Q184.62 223.896 186.425 224.336 Q188.231 224.776 189.967 224.776 Q194.596 224.776 197.027 221.674 Q199.481 218.549 199.828 212.206 Q198.485 214.197 196.425 215.262 Q194.365 216.327 191.865 216.327 Q186.68 216.327 183.647 213.202 Q180.638 210.054 180.638 204.614 Q180.638 199.29 183.786 196.072 Q186.934 192.855 192.166 192.855 Q198.161 192.855 201.309 197.461 Q204.481 202.044 204.481 210.794 Q204.481 218.966 200.592 223.85 Q196.726 228.711 190.175 228.711 Q188.416 228.711 186.61 228.364 Q184.805 228.017 182.86 227.322 M192.166 212.669 Q195.314 212.669 197.143 210.517 Q198.994 208.364 198.994 204.614 Q198.994 200.887 197.143 198.734 Q195.314 196.558 192.166 196.558 Q189.018 196.558 187.166 198.734 Q185.337 200.887 185.337 204.614 Q185.337 208.364 187.166 210.517 Q189.018 212.669 192.166 212.669 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip080)" d="M212.883 222.16 L217.767 222.16 L217.767 228.04 L212.883 228.04 L212.883 222.16 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip080)" d="M237.953 196.558 Q234.341 196.558 232.513 200.123 Q230.707 203.665 230.707 210.794 Q230.707 217.901 232.513 221.466 Q234.341 225.007 237.953 225.007 Q241.587 225.007 243.392 221.466 Q245.221 217.901 245.221 210.794 Q245.221 203.665 243.392 200.123 Q241.587 196.558 237.953 196.558 M237.953 192.855 Q243.763 192.855 246.818 197.461 Q249.897 202.044 249.897 210.794 Q249.897 219.521 246.818 224.128 Q243.763 228.711 237.953 228.711 Q232.142 228.711 229.064 224.128 Q226.008 219.521 226.008 210.794 Q226.008 202.044 229.064 197.461 Q232.142 192.855 237.953 192.855 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip080)" d="M70.6138 709.179 L23.0938 727.322 L23.0938 720.606 L63.1023 705.551 L23.0938 690.464 L23.0938 683.78 L70.6138 701.891 L70.6138 709.179 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip080)" d="M52.6944 665.956 Q52.6944 673.054 54.3176 675.791 Q55.9409 678.528 59.8558 678.528 Q62.975 678.528 64.821 676.491 Q66.6353 674.423 66.6353 670.89 Q66.6353 666.02 63.1978 663.092 Q59.7285 660.132 53.9993 660.132 L52.6944 660.132 L52.6944 665.956 M50.2754 654.275 L70.6138 654.275 L70.6138 660.132 L65.203 660.132 Q68.4495 662.137 70.0091 665.129 Q71.5369 668.12 71.5369 672.449 Q71.5369 677.924 68.4813 681.17 Q65.394 684.385 60.2377 684.385 Q54.2221 684.385 51.1666 680.374 Q48.1111 676.332 48.1111 668.343 L48.1111 660.132 L47.5381 660.132 Q43.4959 660.132 41.2998 662.805 Q39.0718 665.447 39.0718 670.253 Q39.0718 673.309 39.8038 676.205 Q40.5359 679.101 42 681.775 L36.5891 681.775 Q35.3478 678.56 34.7431 675.537 Q34.1065 672.513 34.1065 669.648 Q34.1065 661.914 38.1169 658.094 Q42.1273 654.275 50.2754 654.275 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip080)" d="M21.0886 642.212 L21.0886 636.356 L70.6138 636.356 L70.6138 642.212 L21.0886 642.212 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip080)" d="M56.5456 624.706 L34.9659 624.706 L34.9659 618.85 L56.3228 618.85 Q61.3836 618.85 63.9298 616.877 Q66.4443 614.903 66.4443 610.956 Q66.4443 606.214 63.4206 603.477 Q60.3969 600.708 55.177 600.708 L34.9659 600.708 L34.9659 594.851 L70.6138 594.851 L70.6138 600.708 L65.1393 600.708 Q68.3858 602.84 69.9773 605.673 Q71.5369 608.474 71.5369 612.198 Q71.5369 618.341 67.7174 621.523 Q63.898 624.706 56.5456 624.706 M34.1065 609.97 L34.1065 609.97 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip080)" d="M51.3257 552.296 L54.1903 552.296 L54.1903 579.223 Q60.2377 578.841 63.4206 575.595 Q66.5716 572.317 66.5716 566.492 Q66.5716 563.118 65.7441 559.967 Q64.9165 556.784 63.2614 553.665 L68.7996 553.665 Q70.1364 556.816 70.8366 560.126 Q71.5369 563.436 71.5369 566.842 Q71.5369 575.372 66.5716 580.369 Q61.6064 585.334 53.14 585.334 Q44.3871 585.334 39.2627 580.624 Q34.1065 575.881 34.1065 567.861 Q34.1065 560.667 38.7535 556.498 Q43.3686 552.296 51.3257 552.296 M49.607 558.153 Q44.8009 558.217 41.9363 560.858 Q39.0718 563.468 39.0718 567.797 Q39.0718 572.699 41.8408 575.659 Q44.6099 578.587 49.6388 579.032 L49.607 558.153 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip080)" d="M26.363 481.086 Q27.5546 481.151 27.619 481.956 Q27.6834 483.18 27.8444 483.92 Q27.9733 484.661 28.4564 485.82 Q28.9394 486.98 30.0989 488.107 Q31.2583 489.234 33.094 490.394 L70.8715 514.129 Q71.58 514.548 71.8054 514.902 Q72.0631 515.224 72.0631 515.965 Q72.0631 516.641 71.7732 516.899 Q71.5156 517.157 70.5494 517.286 L29.8412 522.503 Q29.1005 522.6 28.7784 522.696 Q28.4564 522.793 28.1343 523.179 Q27.8122 523.534 27.7156 524.306 Q27.619 525.079 27.619 526.464 Q27.619 527.108 27.5868 527.398 Q27.5546 527.656 27.3936 527.881 Q27.2003 528.107 26.8139 528.107 Q26.2342 528.107 25.9443 527.881 Q25.6222 527.624 25.59 527.43 Q25.5578 527.205 25.5578 526.851 Q25.5578 526.303 25.6222 525.112 Q25.6867 523.92 25.6867 523.308 Q25.6867 522.728 25.7189 521.505 Q25.7511 520.281 25.7511 519.669 Q25.7511 518.316 25.6545 515.579 Q25.5578 512.809 25.5578 511.489 Q25.5578 510.587 26.2986 510.587 Q27.2003 510.587 27.4258 510.973 Q27.619 511.36 27.619 512.229 Q27.619 514.419 28.1665 515.611 Q28.714 516.77 29.5836 516.77 L64.4947 512.294 L32.2889 492.036 Q30.7752 491.038 29.7768 491.038 Q27.8444 491.038 27.619 494.097 Q27.619 495.128 26.8139 495.128 Q26.2342 495.128 25.9443 494.87 Q25.6222 494.613 25.59 494.419 Q25.5578 494.194 25.5578 493.872 Q25.5578 492.809 25.6545 490.651 Q25.7511 488.461 25.7511 487.366 Q25.7511 486.465 25.6545 484.629 Q25.5578 482.793 25.5578 481.956 Q25.5578 481.086 26.363 481.086 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip080)" d="M54.1244 472.365 Q42.9812 472.365 33.9958 468.211 Q30.2277 466.439 27.0715 463.96 Q23.9153 461.48 22.5305 459.837 Q21.1456 458.195 21.1456 457.744 Q21.1456 457.1 21.7897 457.068 Q22.1118 457.068 22.917 457.937 Q33.7381 468.565 54.1244 468.533 Q74.5752 468.533 84.9776 458.195 Q86.1049 457.068 86.4591 457.068 Q87.1032 457.068 87.1032 457.744 Q87.1032 458.195 85.7828 459.773 Q84.4624 461.351 81.435 463.799 Q78.4077 466.246 74.704 468.018 Q65.7185 472.365 54.1244 472.365 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip080)" d="M45.6221 421.144 Q47.4578 421.144 48.5528 422.271 Q49.6478 423.366 49.6478 424.751 Q49.6478 425.975 48.9393 426.619 Q48.2308 427.263 47.329 427.263 Q46.9425 427.263 46.4594 427.102 Q45.9441 426.941 45.3322 426.587 Q44.7203 426.2 44.2694 425.395 Q43.8186 424.59 43.7541 423.495 Q43.5287 423.721 43.4965 423.785 Q43.11 424.268 42.9812 425.17 Q42.9168 425.299 42.9168 425.75 Q42.9168 427.972 44.5593 430.226 Q46.1696 432.448 49.2291 435.186 Q52.804 438.632 54.1244 440.854 Q55.4127 431.096 61.0487 431.096 Q61.9827 431.096 63.1099 431.353 Q65.2355 431.869 66.7813 431.869 Q69.8731 431.869 69.8731 429.775 Q69.8731 427.746 67.8119 426.458 Q65.7507 425.138 61.725 424.043 Q60.9843 423.882 60.7588 423.721 Q60.5334 423.56 60.5334 423.109 Q60.5334 422.304 61.1775 422.304 Q64.9456 423.044 67.8441 424.687 Q71.3546 426.78 71.3546 429.904 Q71.3546 432.513 69.551 434.252 Q67.7153 435.959 64.8168 435.959 Q64.1082 435.959 62.498 435.701 Q61.8538 435.508 61.1131 435.508 Q59.5994 435.508 58.4722 436.345 Q57.3128 437.183 56.7331 438.535 Q56.1534 439.888 55.8958 441.015 Q55.6059 442.11 55.5093 443.173 Q69.1324 446.394 69.9697 446.844 Q70.5494 447.134 70.9359 447.778 Q71.3546 448.422 71.3546 449.099 Q71.3546 449.743 70.9037 450.387 Q70.485 450.999 69.4866 450.999 Q68.9713 450.999 68.0374 450.741 L30.0344 441.176 L28.7462 440.983 Q28.3597 440.983 28.1665 441.144 Q27.9411 441.273 27.78 442.046 Q27.619 442.786 27.619 444.268 Q27.619 444.88 27.5868 445.17 Q27.5546 445.427 27.3936 445.653 Q27.2003 445.878 26.8139 445.878 Q26.2664 445.878 25.9765 445.653 Q25.6545 445.395 25.59 445.202 Q25.5256 445.009 25.4934 444.622 Q25.4612 444.075 25.3002 442.239 Q25.107 440.403 24.9781 438.825 Q24.8493 437.247 24.8493 436.571 Q24.8493 436.184 25.0425 435.991 Q25.2036 435.766 25.3968 435.733 L25.5578 435.701 L53.3837 442.561 Q52.2565 439.727 47.2646 435.25 Q41.4675 430.065 41.4675 425.621 Q41.4675 423.527 42.7558 422.336 Q44.0118 421.144 45.6221 421.144 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip080)" d="M86.4591 414.061 Q86.1371 414.061 85.3319 413.223 Q74.5107 402.595 54.1244 402.595 Q33.6737 402.595 23.3356 412.805 Q22.144 414.061 21.7897 414.061 Q21.1456 414.061 21.1456 413.417 Q21.1456 412.966 22.4661 411.388 Q23.7865 409.777 26.8139 407.362 Q29.8412 404.914 33.5449 403.111 Q42.5303 398.763 54.1244 398.763 Q65.2677 398.763 74.2531 402.917 Q78.0212 404.689 81.1774 407.169 Q84.3335 409.648 85.7184 411.291 Q87.1032 412.933 87.1032 413.417 Q87.1032 414.061 86.4591 414.061 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip082)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="327.242,1039.9 343.024,1007.13 358.805,976.711 374.587,948.341 390.369,921.745 406.15,896.654 421.932,872.962 437.714,850.452 453.496,829.052 469.277,808.603 485.059,789.049 500.841,770.308 516.622,752.283 532.404,734.947 548.186,718.239 563.967,702.096 579.749,686.483 595.531,671.383 611.312,656.742 627.094,642.525 642.876,628.711 658.657,615.298 674.439,602.236 690.221,589.509 706.003,577.104 721.784,564.999 737.566,553.176 753.348,541.638 769.129,530.358 784.911,519.319 800.693,508.521 816.474,497.97 832.256,487.663 848.038,477.589 863.819,467.748 879.601,458.117 895.383,448.687 911.164,439.45 926.946,430.397 942.728,421.52 958.51,412.822 974.291,404.29 990.073,395.913 1005.85,387.686 1021.64,379.602 1037.42,371.664 1053.2,363.865 1068.98,356.195 1084.76,348.648 1100.54,341.221 1116.33,333.919 1132.11,326.732 1147.89,319.652 1163.67,312.676 1179.45,305.806 1195.23,299.041 1211.02,292.37 1226.8,285.791 1242.58,279.304 1258.36,272.912 1274.14,266.603 1289.92,260.375 1305.71,254.231 1321.49,248.17 1337.27,242.183 1353.05,236.268 1368.83,230.432 1384.62,224.667 1400.4,218.969 1416.18,213.336 1431.96,207.79 1447.74,202.344 1463.52,196.994 1479.31,191.737 1495.09,186.569 1510.87,181.488 1526.65,176.49 1542.43,171.574 1558.21,166.736 1574,161.974 1589.78,157.286 1605.56,152.67 1621.34,148.122 1637.12,143.642 1652.9,139.228 1668.69,134.876 1684.47,130.587 1700.25,126.357 1716.03,122.186 1731.81,118.071 1747.59,114.012 1763.38,110.006 1779.16,106.053 1794.94,102.15 1810.72,98.2972 1826.5,94.4928 1842.28,90.7356 1858.07,87.0245 1873.85,83.3583 1889.63,79.7359 1905.41,76.1564 "></polyline>
</svg>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-pfi-vf-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5: Value Function from PFI and Linear Equation
</figcaption>
</figure>
</div>
</div>
<p>また, VFIよりもPFIの方が収束速度が速いことも確認できますが, 実行速度も速いことも確認できます.</p>
<div id="cell-bm-vfi" class="cell" data-execution_count="1">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb19"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">BenchmarkTools</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="pp">@benchmark</span> <span class="fu">vfi!</span>(m, verbose<span class="op">=</span><span class="cn">false</span>) setup <span class="op">=</span> (m <span class="op">=</span> <span class="fu">Model</span>())</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div id="bm-vfi" class="cell-output cell-output-display" data-execution_count="1">
<div class="ansi-escaped-output">
<pre>BenchmarkTools.Trial: 66 samples with 1 evaluation per sample.
 Range <span class="ansi-bright-black-fg">(</span><span class="ansi-cyan-fg ansi-bold">min</span> … <span class="ansi-magenta-fg">max</span><span class="ansi-bright-black-fg">):  </span><span class="ansi-cyan-fg ansi-bold">74.393 ms</span> … <span class="ansi-magenta-fg"> 77.433 ms</span>  <span class="ansi-bright-black-fg">┊</span> GC <span class="ansi-bright-black-fg">(</span>min … max<span class="ansi-bright-black-fg">): </span>0.00% … 0.00%
 Time  <span class="ansi-bright-black-fg">(</span><span class="ansi-blue-fg ansi-bold">median</span><span class="ansi-bright-black-fg">):     </span><span class="ansi-blue-fg ansi-bold">76.274 ms               </span><span class="ansi-bright-black-fg">┊</span> GC <span class="ansi-bright-black-fg">(</span>median<span class="ansi-bright-black-fg">):    </span>0.00%
 Time  <span class="ansi-bright-black-fg">(</span><span class="ansi-green-fg ansi-bold">mean</span> ± <span class="ansi-green-fg">σ</span><span class="ansi-bright-black-fg">):   </span><span class="ansi-green-fg ansi-bold">76.230 ms</span> ± <span class="ansi-green-fg">561.599 μs</span>  <span class="ansi-bright-black-fg">┊</span> GC <span class="ansi-bright-black-fg">(</span>mean ± σ<span class="ansi-bright-black-fg">):  </span>0.00% ± 0.00%

                              ▅    ▂▂    <span class="ansi-green-fg">█</span><span class="ansi-blue-fg">▂</span> ▂█ ▂▂    ▂          
  ▅▁▁▁▁▁▁▁▁▁▁▅▁▁▁▁▅▅▁▁▁█▁▁▅▅▁▁██▅▁▁████▅▅<span class="ansi-green-fg">█</span><span class="ansi-blue-fg">█</span>███▁██▅▁▅▅█▅█▅▁▁█▅▅ ▁
  74.4 ms<span class="ansi-bright-black-fg">         Histogram: frequency by time</span>         77.2 ms <span class="ansi-bold">&lt;</span>

 Memory estimate<span class="ansi-bright-black-fg">: </span><span class="ansi-yellow-fg">286.38 KiB</span>, allocs estimate<span class="ansi-bright-black-fg">: </span><span class="ansi-yellow-fg">632</span>.</pre>
</div>
</div>
</div>
<div id="cell-bm-pfi" class="cell" data-execution_count="1">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb20"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="pp">@benchmark</span> (<span class="fu">pfi!</span>(m, verbose<span class="op">=</span><span class="cn">false</span>); <span class="fu">compute_vf!</span>(m)) setup <span class="op">=</span> (m <span class="op">=</span> <span class="fu">Model</span>())</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div id="bm-pfi" class="cell-output cell-output-display" data-execution_count="1">
<div class="ansi-escaped-output">
<pre>BenchmarkTools.Trial: 917 samples with 1 evaluation per sample.
 Range <span class="ansi-bright-black-fg">(</span><span class="ansi-cyan-fg ansi-bold">min</span> … <span class="ansi-magenta-fg">max</span><span class="ansi-bright-black-fg">):  </span><span class="ansi-cyan-fg ansi-bold">4.818 ms</span> … <span class="ansi-magenta-fg"> 16.852 ms</span>  <span class="ansi-bright-black-fg">┊</span> GC <span class="ansi-bright-black-fg">(</span>min … max<span class="ansi-bright-black-fg">): </span>0.00% … 69.74%
 Time  <span class="ansi-bright-black-fg">(</span><span class="ansi-blue-fg ansi-bold">median</span><span class="ansi-bright-black-fg">):     </span><span class="ansi-blue-fg ansi-bold">5.380 ms               </span><span class="ansi-bright-black-fg">┊</span> GC <span class="ansi-bright-black-fg">(</span>median<span class="ansi-bright-black-fg">):    </span>7.12%
 Time  <span class="ansi-bright-black-fg">(</span><span class="ansi-green-fg ansi-bold">mean</span> ± <span class="ansi-green-fg">σ</span><span class="ansi-bright-black-fg">):   </span><span class="ansi-green-fg ansi-bold">5.452 ms</span> ± <span class="ansi-green-fg">690.859 μs</span>  <span class="ansi-bright-black-fg">┊</span> GC <span class="ansi-bright-black-fg">(</span>mean ± σ<span class="ansi-bright-black-fg">):  </span>6.57% ±  5.49%

              ▁▄█▅▃▄▅<span class="ansi-blue-fg">▄</span> <span class="ansi-green-fg">▂</span>▂▄▂▁                                   
  ▄▅▄▆▅▅▆▆▆▆▄▆███████<span class="ansi-blue-fg">█</span>█<span class="ansi-green-fg">█</span>████▇█▆▇▄▅▅▆▃▄▂▃▃▃▂▂▄▂▂▂▃▂▁▂▁▂▂▁▁▂▁▁▂ ▄
  4.82 ms<span class="ansi-bright-black-fg">         Histogram: frequency by time</span>        6.59 ms <span class="ansi-bold">&lt;</span>

 Memory estimate<span class="ansi-bright-black-fg">: </span><span class="ansi-yellow-fg">17.28 MiB</span>, allocs estimate<span class="ansi-bright-black-fg">: </span><span class="ansi-yellow-fg">38533</span>.</pre>
</div>
</div>
</div>
</section>
</section>
<section id="確率的動学モデル" class="level2">
<h2 class="anchored" data-anchor-id="確率的動学モデル">確率的動学モデル</h2>
<p>この節では確率的な不確実性を導入する. 生産関数 <span class="math inline">\(f(k, z) = z k^\alpha\)</span> とし, 生産性 <span class="math inline">\(z\)</span> が確率的に変化するモデルを考えます. 生産性 <span class="math inline">\(z\)</span> は以下のような AR(1) 過程に従うとします.</p>
<p><span class="math display">\[
\log z' = (1 - \rho) \mu + \rho \log z + \sigma \varepsilon, \quad \varepsilon \sim \mathcal{N}(0, 1).
\]</span></p>
<p>この時, ベルマン方程式は以下のように書き換えられます.</p>
<p><span class="math display">\[
V(k, z) = \max_{k'} \left\{u(f(k, z) + (1-\delta)k - k') + \beta \mathbb{E}[V(k', z')| z]\right\}.
\]</span></p>
<p>この <span class="math inline">\(V(k, z)\)</span> の数値計算するためには, <span class="math inline">\(z\)</span> の状態空間を離散化する必要があります. ここでは, Tauchen Method <span class="citation" data-cites="tauchen1986">(<a href="#ref-tauchen1986" role="doc-biblioref">Tauchen 1986</a>)</span> を用いて <span class="math inline">\(z\)</span> の状態空間を離散化します.</p>
<section id="tauchen-method" class="level3">
<h3 class="anchored" data-anchor-id="tauchen-method">Tauchen Method</h3>
<p>実数列 <span class="math inline">\(x_t\)</span> が以下のAR(1)過程に従うとします.</p>
<p><span class="math display">\[
x_{t+1} = (1 - \rho) \mu + \rho x_t + \sigma \varepsilon_{t+1}, \quad \varepsilon_{t+1} \sim \mathcal{N}(0, 1).
\]</span></p>
<p>これを <span class="math inline">\(n\)</span> 個のグリッドポイント <span class="math inline">\(\{x_1, \dots, x_n\}\)</span> におけるマルコフ過程として離散化することを考えます. すなわち, 以下のような遷移確率行列 <span class="math inline">\(\Lambda\)</span> を考えます.</p>
<p><span class="math display">\[
\begin{pmatrix}
x_{1, t+1} \\
\vdots \\
x_{n, t+1}
\end{pmatrix} =
\begin{pmatrix}
\lambda_{1, 1} &amp; \cdots &amp; \lambda_{1, n} \\
\vdots &amp; \ddots &amp; \vdots \\
\lambda_{n, 1} &amp; \cdots &amp; \lambda_{n, n}
\end{pmatrix}
\begin{pmatrix}
x_{1, t} \\
\vdots \\
x_{n, t}
\end{pmatrix}
\]</span></p>
<p>ここで, <span class="math inline">\(\lambda_{i, j} = \Pr(x_{t+1} = x_j \mid x_t = x_i)\)</span> であり, <span class="math inline">\(\sum_{j=1}^{n} \lambda_{i, j} = 1\)</span> が成り立ちます. この遷移確率行列を求める方法として, Tauchen Method が知られています.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Tauchen Method
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li><span class="math inline">\(x\)</span> の定義域 を <span class="math inline">\([x_{\min}, x_{\max}]\)</span> を <span class="math inline">\(n\)</span> 個のグリッドポイントに分割する. 通常は <span class="math inline">\(x\)</span> が従う分布の <span class="math inline">\(3\sigma\)</span> 程度の範囲を考える.</li>
<li>グリッドポイント <span class="math inline">\(x_i\)</span> から <span class="math inline">\(x_j\)</span> に遷移する確率を以下のように定義する.</li>
</ol>
<p><span class="math display">\[
\begin{aligned}
\lambda_{i, 1} &amp;= \Phi\left(\frac{x_1 + \frac{d}{2} - (1 - \rho) \mu - \rho x_i}{\sigma}\right) \\
\lambda_{i, j} &amp;= \Phi\left(\frac{x_j + \frac{d}{2} - (1 - \rho) \mu - \rho x_i}{\sigma}\right) - \Phi\left(\frac{x_{j} - \frac{d}{2} - (1 - \rho) \mu - \rho x_i}{\sigma}\right) &amp; (2 \leq j \leq n-1) \\
\lambda_{i, n} &amp;= 1 - \Phi\left(\frac{x_{n} - \frac{d}{2} - (1 - \rho) \mu - \rho x_i}{\sigma}\right)
\end{aligned}
\]</span></p>
</div>
</div>
<div id="fig-tauchen-method" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-tauchen-method-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="../static/cetz/tauchen_method.svg" class="img-fluid figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-tauchen-method-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6: <strong>Visualization of Tauchen Method</strong>. <span class="math inline">\(\mu = 0\)</span>.
</figcaption>
</figure>
</div>
<div id="cell-tauchen-method" class="cell" data-execution_count="1">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb21"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">tauchen_method</span>(; n_std<span class="op">=</span><span class="fl">3.0</span>, n<span class="op">=</span><span class="fl">5</span>, ρ<span class="op">=</span><span class="fl">0.9</span>, μ<span class="op">=</span><span class="fl">0.1</span>, σ<span class="op">=</span><span class="fl">1.0</span>)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>    x_min <span class="op">=</span> μ <span class="op">-</span> n_std <span class="op">*</span> <span class="fu">sqrt</span>(σ<span class="op">^</span><span class="fl">2</span> <span class="op">/</span> (<span class="fl">1</span> <span class="op">-</span> ρ<span class="op">^</span><span class="fl">2</span>))</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>    x_max <span class="op">=</span> μ <span class="op">+</span> n_std <span class="op">*</span> <span class="fu">sqrt</span>(σ<span class="op">^</span><span class="fl">2</span> <span class="op">/</span> (<span class="fl">1</span> <span class="op">-</span> ρ<span class="op">^</span><span class="fl">2</span>))</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> <span class="fu">range</span>(x_min, x_max, length<span class="op">=</span>n)</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>    d <span class="op">=</span> (x_max <span class="op">-</span> x_min) <span class="op">/</span> (n <span class="op">-</span> <span class="fl">1</span>)</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>    Λ <span class="op">=</span> <span class="fu">zeros</span>(n, n)</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span>n</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>        Λ[i, <span class="fl">1</span>] <span class="op">=</span> <span class="fu">cdf</span>(<span class="fu">Normal</span>(<span class="fl">0.0</span>, σ), x[<span class="fl">1</span>] <span class="op">+</span> d <span class="op">/</span> <span class="fl">2</span> <span class="op">-</span> (<span class="fl">1</span> <span class="op">-</span> ρ) <span class="op">*</span> μ <span class="op">-</span> ρ <span class="op">*</span> x[i])</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>        Λ[i, n] <span class="op">=</span> <span class="fl">1</span> <span class="op">-</span> <span class="fu">cdf</span>(<span class="fu">Normal</span>(<span class="fl">0.0</span>, σ), x[n] <span class="op">-</span> d <span class="op">/</span> <span class="fl">2</span> <span class="op">-</span> (<span class="fl">1</span> <span class="op">-</span> ρ) <span class="op">*</span> μ <span class="op">-</span> ρ <span class="op">*</span> x[i])</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="fl">2</span><span class="op">:</span>n<span class="op">-</span><span class="fl">1</span></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>            Λ[i, j] <span class="op">=</span> <span class="fu">cdf</span>(<span class="fu">Normal</span>(<span class="fl">0.0</span>, σ), x[j] <span class="op">+</span> d <span class="op">/</span> <span class="fl">2</span> <span class="op">-</span> (<span class="fl">1</span> <span class="op">-</span> ρ) <span class="op">*</span> μ <span class="op">-</span> ρ <span class="op">*</span> x[i]) <span class="op">-</span></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">cdf</span>(<span class="fu">Normal</span>(<span class="fl">0.0</span>, σ), x[j] <span class="op">-</span> d <span class="op">/</span> <span class="fl">2</span> <span class="op">-</span> (<span class="fl">1</span> <span class="op">-</span> ρ) <span class="op">*</span> μ <span class="op">-</span> ρ <span class="op">*</span> x[i])</span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">end</span></span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> x, Λ</span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a>x, Λ <span class="op">=</span> <span class="fu">tauchen_method</span>()</span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a><span class="pp">@show</span> x</span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a>Λ</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>x = -6.782472016116854:3.4412360080584268:6.982472016116853</code></pre>
</div>
<div id="tauchen-method" class="cell-output cell-output-display" data-execution_count="1">
<pre><code>5×5 Matrix{Float64}:
 0.849051     0.150945     3.84556e-6  1.22125e-15  0.0
 0.0194737    0.896192     0.0843336   7.26002e-7   1.11022e-16
 1.22258e-7   0.04266      0.91468     0.04266      1.22258e-7
 7.34696e-17  7.26002e-7   0.0843336   0.896192     0.0194737
 3.45903e-30  1.23783e-15  3.84556e-6  0.150945     0.849051</code></pre>
</div>
</div>
<p>実用上は <code>QuantEcon.jl</code> の <code>tauchen</code> 関数を利用するのがいいでしょう.</p>
<div id="34" class="cell" data-execution_count="1">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb24"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">QuantEcon</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>mc <span class="op">=</span> <span class="fu">tauchen</span>(<span class="fl">5</span>, <span class="fl">0.9</span>, <span class="fl">1.0</span>, <span class="fl">0.1</span>) <span class="co"># tauchen(N, ρ, σ, μ)</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="pp">@show</span> mc.state_values</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>mc.p</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>mc.state_values = -5.8824720161168536:3.4412360080584268:7.8824720161168536</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>5×5 Matrix{Float64}:
 0.849051     0.150945     3.84556e-6  1.22125e-15  0.0
 0.0194737    0.896192     0.0843336   7.26002e-7   1.11022e-16
 1.22258e-7   0.04266      0.91468     0.04266      1.22258e-7
 7.34696e-17  7.26002e-7   0.0843336   0.896192     0.0194737
 3.45903e-30  1.23783e-15  3.84556e-6  0.150945     0.849051</code></pre>
</div>
</div>
<p>ただし, ここでは AR(1) process が以下のように定義されていることに注意してください.</p>
<p><span class="math display">\[
y_{t+1} = \mu + \rho y_{t} + \varepsilon_{t+1}, \quad \varepsilon_{t+1} \sim \mathcal{N}(0, \sigma^2).
\]</span></p>
<p>そのため, <span class="math inline">\(\mathbb{E}[y_{t}] = \frac{\mu}{1-\rho}\)</span> となります. 上の例では, <span class="math inline">\(\mu = 0.1\)</span>, <span class="math inline">\(\rho = 0.9\)</span>, <span class="math inline">\(\sigma = 1.0\)</span> としているため, <span class="math inline">\(\mathbb{E}[y_{t}] = 1.0\)</span> となります.</p>
<div id="36" class="cell" data-execution_count="1">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb27"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>ps <span class="op">=</span> <span class="fu">vcat</span>(<span class="fu">stationary_distributions</span>(mc)<span class="op">...</span>)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>ps<span class="op">'</span> <span class="op">*</span> <span class="fu">collect</span>(mc.state_values)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>1.0</code></pre>
</div>
</div>
<p>AR(1) processの期待値を任意の値 <span class="math inline">\(\tilde{\mu}\)</span> に設定するためには, <span class="math inline">\(\mu = (1-\rho)\tilde{\mu}\)</span> とすればよいです.</p>
<div id="38" class="cell" data-execution_count="1">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb29"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>mc <span class="op">=</span> <span class="fu">tauchen</span>(<span class="fl">5</span>, <span class="fl">0.9</span>, <span class="fl">1.0</span>, <span class="fl">0.01</span>)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="pp">@show</span> mc.state_values</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>mc.p</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>mc.state_values = -6.782472016116854:3.4412360080584268:6.982472016116853</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>5×5 Matrix{Float64}:
 0.849051     0.150945     3.84556e-6  1.22125e-15  0.0
 0.0194737    0.896192     0.0843336   7.26002e-7   1.11022e-16
 1.22258e-7   0.04266      0.91468     0.04266      1.22258e-7
 7.34696e-17  7.26002e-7   0.0843336   0.896192     0.0194737
 3.45903e-30  1.23783e-15  3.84556e-6  0.150945     0.849051</code></pre>
</div>
</div>
</section>
<section id="value-function-iteration-2" class="level3">
<h3 class="anchored" data-anchor-id="value-function-iteration-2">Value Function Iteration</h3>
<p>AR(1) process を <span class="math inline">\(\Lambda\)</span> で離散化した後のベルマン方程式は以下のようになります.</p>
<p><span class="math display">\[
V(k, z) = \max_{k'} \left\{u(f(k, z) + (1-\delta)k - k') + \beta \sum_{z'} \Lambda(z, z') V(k', z')\right\}.
\]</span></p>
<p><span class="noindent">VFIを用いる場合, 実装は価値関数 <span class="math inline">\(V\)</span> の次元を <span class="math inline">\(z\)</span> のために1つ増やし, ベルマン方程式の通り実装するだけです.</span></p>
<div id="cell-fig-model-stochastic" class="cell" data-execution_count="1">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb32"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="pp">@kwdef</span> <span class="kw">struct</span> StochasticModel{TF<span class="op">&lt;:</span><span class="dt">AbstractFloat</span>,TI<span class="op">&lt;:</span><span class="dt">Integer</span>}</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Parameters</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>    α<span class="op">::</span><span class="dt">TF </span><span class="op">=</span> <span class="fl">0.4</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>    β<span class="op">::</span><span class="dt">TF </span><span class="op">=</span> <span class="fl">0.96</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>    δ<span class="op">::</span><span class="dt">TF </span><span class="op">=</span> <span class="fl">0.1</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># AR(1) process</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>    ρ<span class="op">::</span><span class="dt">TF </span><span class="op">=</span> <span class="fl">0.6</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>    μ<span class="op">::</span><span class="dt">TF </span><span class="op">=</span> <span class="fl">0.0</span></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>    σ<span class="op">::</span><span class="dt">TF </span><span class="op">=</span> <span class="fl">0.4</span></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Value Function</span></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>    n_k<span class="op">::</span><span class="dt">TI </span><span class="op">=</span> <span class="fl">101</span></span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>    n_z<span class="op">::</span><span class="dt">TI </span><span class="op">=</span> <span class="fl">5</span></span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>    k_min<span class="op">::</span><span class="dt">TF </span><span class="op">=</span> <span class="fl">0.05</span></span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>    k_max<span class="op">::</span><span class="dt">TF </span><span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>    k_grid<span class="op">::</span><span class="dt">Vector{TF} </span><span class="op">=</span> <span class="fu">collect</span>(<span class="fu">range</span>(k_min, k_max, length<span class="op">=</span>n_k))</span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>    mc<span class="op">::</span><span class="dt">MarkovChain </span><span class="op">=</span> <span class="fu">tauchen</span>(n_z, ρ, σ, μ)</span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>    z_grid<span class="op">::</span><span class="dt">Vector{TF} </span><span class="op">=</span> <span class="fu">collect</span>(<span class="fu">exp</span>.(mc.state_values))</span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a>    Λ<span class="op">::</span><span class="dt">Matrix{TF} </span><span class="op">=</span> mc.p</span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a>    V<span class="op">::</span><span class="dt">Matrix{TF} </span><span class="op">=</span> <span class="fu">zeros</span>(n_k, n_z)</span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a><span class="fu">f</span>(k, z; m) <span class="op">=</span> z <span class="op">*</span> k<span class="op">^</span>m.α</span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">vfi!</span>(m<span class="op">::</span><span class="dt">StochasticModel</span>; tol<span class="op">=</span><span class="fl">1e-6</span>, max_iter<span class="op">=</span><span class="fl">1000</span>)</span>
<span id="cb32-25"><a href="#cb32-25" aria-hidden="true" tabindex="-1"></a>    (; k_grid, z_grid, β, δ, Λ) <span class="op">=</span> m</span>
<span id="cb32-26"><a href="#cb32-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-27"><a href="#cb32-27" aria-hidden="true" tabindex="-1"></a>    iter, dist <span class="op">=</span> <span class="fl">0</span>, <span class="cn">Inf</span></span>
<span id="cb32-28"><a href="#cb32-28" aria-hidden="true" tabindex="-1"></a>    V_new <span class="op">=</span> <span class="fu">similar</span>(m.V)</span>
<span id="cb32-29"><a href="#cb32-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> dist <span class="op">&gt;</span> tol <span class="op">&amp;&amp;</span> iter <span class="op">&lt;</span> max_iter</span>
<span id="cb32-30"><a href="#cb32-30" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> (i_z, z) <span class="kw">in</span> <span class="fu">enumerate</span>(z_grid), (i_k, k) <span class="kw">in</span> <span class="fu">enumerate</span>(k_grid)</span>
<span id="cb32-31"><a href="#cb32-31" aria-hidden="true" tabindex="-1"></a>            c_min <span class="op">=</span> <span class="fl">1e-9</span> <span class="co"># consumption cannot be negative</span></span>
<span id="cb32-32"><a href="#cb32-32" aria-hidden="true" tabindex="-1"></a>            V_new[i_k, i_z] <span class="op">=</span> <span class="fu">maximum</span>(</span>
<span id="cb32-33"><a href="#cb32-33" aria-hidden="true" tabindex="-1"></a>                <span class="fu">log</span>(<span class="fu">max</span>(<span class="fu">f</span>(k, z; m) <span class="op">+</span> (<span class="fl">1</span> <span class="op">-</span> δ) <span class="op">*</span> k <span class="op">-</span> k′, c_min)) <span class="op">+</span></span>
<span id="cb32-34"><a href="#cb32-34" aria-hidden="true" tabindex="-1"></a>                β <span class="op">*</span> <span class="fu">sum</span>(Λ[i_z, i_z′] <span class="op">*</span> m.V[i_k′, i_z′]</span>
<span id="cb32-35"><a href="#cb32-35" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">for</span> (i_z′, z′) <span class="kw">in</span> <span class="fu">enumerate</span>(z_grid))</span>
<span id="cb32-36"><a href="#cb32-36" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> (i_k′, k′) <span class="kw">in</span> <span class="fu">enumerate</span>(k_grid)</span>
<span id="cb32-37"><a href="#cb32-37" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb32-38"><a href="#cb32-38" aria-hidden="true" tabindex="-1"></a>        <span class="cf">end</span></span>
<span id="cb32-39"><a href="#cb32-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-40"><a href="#cb32-40" aria-hidden="true" tabindex="-1"></a>        dist <span class="op">=</span> <span class="fu">maximum</span>(abs, V_new <span class="op">.-</span> m.V)</span>
<span id="cb32-41"><a href="#cb32-41" aria-hidden="true" tabindex="-1"></a>        m.V <span class="op">.=</span> V_new</span>
<span id="cb32-42"><a href="#cb32-42" aria-hidden="true" tabindex="-1"></a>        iter <span class="op">+=</span> <span class="fl">1</span></span>
<span id="cb32-43"><a href="#cb32-43" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb32-44"><a href="#cb32-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-45"><a href="#cb32-45" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> iter <span class="op">==</span> max_iter</span>
<span id="cb32-46"><a href="#cb32-46" aria-hidden="true" tabindex="-1"></a>        <span class="fu">println</span>(<span class="st">"Warning: Maximum iterations reached."</span>)</span>
<span id="cb32-47"><a href="#cb32-47" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span></span>
<span id="cb32-48"><a href="#cb32-48" aria-hidden="true" tabindex="-1"></a>        <span class="fu">println</span>(<span class="st">"Converged in </span><span class="sc">$</span>iter<span class="st"> iterations."</span>)</span>
<span id="cb32-49"><a href="#cb32-49" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb32-50"><a href="#cb32-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-51"><a href="#cb32-51" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="cn">nothing</span></span>
<span id="cb32-52"><a href="#cb32-52" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb32-53"><a href="#cb32-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-54"><a href="#cb32-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-55"><a href="#cb32-55" aria-hidden="true" tabindex="-1"></a>m <span class="op">=</span> <span class="fu">StochasticModel</span>()</span>
<span id="cb32-56"><a href="#cb32-56" aria-hidden="true" tabindex="-1"></a><span class="fu">vfi!</span>(m)</span>
<span id="cb32-57"><a href="#cb32-57" aria-hidden="true" tabindex="-1"></a>p <span class="op">=</span> <span class="fu">plot</span>(m.k_grid, m.V[<span class="op">:</span>, <span class="fl">5</span>], label<span class="op">=</span>L<span class="st">"z_5"</span>, xlabel<span class="op">=</span>L<span class="st">"Capital </span><span class="sc">$</span>k<span class="sc">$</span><span class="st">", </span>ylabel<span class="st">=L"</span>Value <span class="op">$</span><span class="fu">V</span>(k, z)<span class="op">$</span><span class="st">")</span></span>
<span id="cb32-58"><a href="#cb32-58" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="fl">4</span><span class="op">:-</span><span class="fl">1</span><span class="op">:</span><span class="fl">1</span></span>
<span id="cb32-59"><a href="#cb32-59" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot!</span>(m.k_grid, m.V[<span class="op">:</span>, i], label<span class="op">=</span>L<span class="st">"z_%</span><span class="sc">$</span>i<span class="st">"</span>)</span>
<span id="cb32-60"><a href="#cb32-60" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb32-61"><a href="#cb32-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-62"><a href="#cb32-62" aria-hidden="true" tabindex="-1"></a>p</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Converged in 316 iterations.</code></pre>
</div>
<div id="fig-model-stochastic" class="cell-output cell-output-display quarto-float quarto-figure quarto-figure-center anchored" data-execution_count="1">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-model-stochastic-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<!--?xml version="1.0" encoding="utf-8"?-->
<svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" width="500" height="309" viewbox="0 0 2000 1236">
<defs>
  <clippath id="clip140">
    <rect x="0" y="0" width="2000" height="1236"></rect>
  </clippath>
</defs>
<path clip-path="url(#clip140)" d="M0 1236 L2000 1236 L2000 1.24345e-14 L0 1.24345e-14  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<defs>
  <clippath id="clip141">
    <rect x="400" y="0" width="1401" height="1236"></rect>
  </clippath>
</defs>
<path clip-path="url(#clip140)" d="M279.897 1068.81 L1952.76 1068.81 L1952.76 47.2441 L279.897 47.2441  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<defs>
  <clippath id="clip142">
    <rect x="279" y="47" width="1674" height="1023"></rect>
  </clippath>
</defs>
<polyline clip-path="url(#clip142)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="502.594,1068.81 502.594,47.2441 "></polyline>
<polyline clip-path="url(#clip142)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="853.298,1068.81 853.298,47.2441 "></polyline>
<polyline clip-path="url(#clip142)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1204,1068.81 1204,47.2441 "></polyline>
<polyline clip-path="url(#clip142)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1554.71,1068.81 1554.71,47.2441 "></polyline>
<polyline clip-path="url(#clip142)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1905.41,1068.81 1905.41,47.2441 "></polyline>
<polyline clip-path="url(#clip142)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="279.897,885.857 1952.76,885.857 "></polyline>
<polyline clip-path="url(#clip142)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="279.897,679.866 1952.76,679.866 "></polyline>
<polyline clip-path="url(#clip142)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="279.897,473.875 1952.76,473.875 "></polyline>
<polyline clip-path="url(#clip142)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="279.897,267.884 1952.76,267.884 "></polyline>
<polyline clip-path="url(#clip142)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="279.897,61.8931 1952.76,61.8931 "></polyline>
<polyline clip-path="url(#clip140)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="279.897,1068.81 1952.76,1068.81 "></polyline>
<polyline clip-path="url(#clip140)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="502.594,1068.81 502.594,1049.91 "></polyline>
<polyline clip-path="url(#clip140)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="853.298,1068.81 853.298,1049.91 "></polyline>
<polyline clip-path="url(#clip140)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1204,1068.81 1204,1049.91 "></polyline>
<polyline clip-path="url(#clip140)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1554.71,1068.81 1554.71,1049.91 "></polyline>
<polyline clip-path="url(#clip140)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1905.41,1068.81 1905.41,1049.91 "></polyline>
<path clip-path="url(#clip140)" d="M480.592 1096.53 Q476.981 1096.53 475.152 1100.1 Q473.347 1103.64 473.347 1110.77 Q473.347 1117.87 475.152 1121.44 Q476.981 1124.98 480.592 1124.98 Q484.226 1124.98 486.032 1121.44 Q487.86 1117.87 487.86 1110.77 Q487.86 1103.64 486.032 1100.1 Q484.226 1096.53 480.592 1096.53 M480.592 1092.83 Q486.402 1092.83 489.458 1097.43 Q492.536 1102.02 492.536 1110.77 Q492.536 1119.49 489.458 1124.1 Q486.402 1128.68 480.592 1128.68 Q474.782 1128.68 471.703 1124.1 Q468.648 1119.49 468.648 1110.77 Q468.648 1102.02 471.703 1097.43 Q474.782 1092.83 480.592 1092.83 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M500.754 1122.13 L505.638 1122.13 L505.638 1128.01 L500.754 1128.01 L500.754 1122.13 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M516.633 1124.08 L524.272 1124.08 L524.272 1097.71 L515.962 1099.38 L515.962 1095.12 L524.226 1093.45 L528.902 1093.45 L528.902 1124.08 L536.541 1124.08 L536.541 1128.01 L516.633 1128.01 L516.633 1124.08 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M831.481 1096.53 Q827.87 1096.53 826.041 1100.1 Q824.236 1103.64 824.236 1110.77 Q824.236 1117.87 826.041 1121.44 Q827.87 1124.98 831.481 1124.98 Q835.116 1124.98 836.921 1121.44 Q838.75 1117.87 838.75 1110.77 Q838.75 1103.64 836.921 1100.1 Q835.116 1096.53 831.481 1096.53 M831.481 1092.83 Q837.291 1092.83 840.347 1097.43 Q843.426 1102.02 843.426 1110.77 Q843.426 1119.49 840.347 1124.1 Q837.291 1128.68 831.481 1128.68 Q825.671 1128.68 822.592 1124.1 Q819.537 1119.49 819.537 1110.77 Q819.537 1102.02 822.592 1097.43 Q825.671 1092.83 831.481 1092.83 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M851.643 1122.13 L856.527 1122.13 L856.527 1128.01 L851.643 1128.01 L851.643 1122.13 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M870.74 1124.08 L887.06 1124.08 L887.06 1128.01 L865.115 1128.01 L865.115 1124.08 Q867.777 1121.32 872.361 1116.69 Q876.967 1112.04 878.148 1110.7 Q880.393 1108.17 881.273 1106.44 Q882.175 1104.68 882.175 1102.99 Q882.175 1100.23 880.231 1098.5 Q878.31 1096.76 875.208 1096.76 Q873.009 1096.76 870.555 1097.53 Q868.125 1098.29 865.347 1099.84 L865.347 1095.12 Q868.171 1093.98 870.625 1093.41 Q873.078 1092.83 875.115 1092.83 Q880.486 1092.83 883.68 1095.51 Q886.874 1098.2 886.874 1102.69 Q886.874 1104.82 886.064 1106.74 Q885.277 1108.64 883.171 1111.23 Q882.592 1111.9 879.49 1115.12 Q876.388 1118.31 870.74 1124.08 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M1181.71 1096.53 Q1178.1 1096.53 1176.27 1100.1 Q1174.47 1103.64 1174.47 1110.77 Q1174.47 1117.87 1176.27 1121.44 Q1178.1 1124.98 1181.71 1124.98 Q1185.35 1124.98 1187.15 1121.44 Q1188.98 1117.87 1188.98 1110.77 Q1188.98 1103.64 1187.15 1100.1 Q1185.35 1096.53 1181.71 1096.53 M1181.71 1092.83 Q1187.52 1092.83 1190.58 1097.43 Q1193.66 1102.02 1193.66 1110.77 Q1193.66 1119.49 1190.58 1124.1 Q1187.52 1128.68 1181.71 1128.68 Q1175.9 1128.68 1172.82 1124.1 Q1169.77 1119.49 1169.77 1110.77 Q1169.77 1102.02 1172.82 1097.43 Q1175.9 1092.83 1181.71 1092.83 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M1201.87 1122.13 L1206.76 1122.13 L1206.76 1128.01 L1201.87 1128.01 L1201.87 1122.13 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M1231.11 1109.38 Q1234.47 1110.1 1236.34 1112.36 Q1238.24 1114.63 1238.24 1117.97 Q1238.24 1123.08 1234.72 1125.88 Q1231.2 1128.68 1224.72 1128.68 Q1222.54 1128.68 1220.23 1128.24 Q1217.94 1127.83 1215.48 1126.97 L1215.48 1122.46 Q1217.43 1123.59 1219.74 1124.17 Q1222.06 1124.75 1224.58 1124.75 Q1228.98 1124.75 1231.27 1123.01 Q1233.59 1121.28 1233.59 1117.97 Q1233.59 1114.91 1231.43 1113.2 Q1229.3 1111.46 1225.48 1111.46 L1221.46 1111.46 L1221.46 1107.62 L1225.67 1107.62 Q1229.12 1107.62 1230.95 1106.25 Q1232.78 1104.86 1232.78 1102.27 Q1232.78 1099.61 1230.88 1098.2 Q1229 1096.76 1225.48 1096.76 Q1223.56 1096.76 1221.36 1097.18 Q1219.16 1097.6 1216.53 1098.47 L1216.53 1094.31 Q1219.19 1093.57 1221.5 1093.2 Q1223.84 1092.83 1225.9 1092.83 Q1231.22 1092.83 1234.33 1095.26 Q1237.43 1097.66 1237.43 1101.78 Q1237.43 1104.66 1235.78 1106.65 Q1234.14 1108.61 1231.11 1109.38 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M1531.85 1096.53 Q1528.24 1096.53 1526.41 1100.1 Q1524.6 1103.64 1524.6 1110.77 Q1524.6 1117.87 1526.41 1121.44 Q1528.24 1124.98 1531.85 1124.98 Q1535.48 1124.98 1537.29 1121.44 Q1539.12 1117.87 1539.12 1110.77 Q1539.12 1103.64 1537.29 1100.1 Q1535.48 1096.53 1531.85 1096.53 M1531.85 1092.83 Q1537.66 1092.83 1540.71 1097.43 Q1543.79 1102.02 1543.79 1110.77 Q1543.79 1119.49 1540.71 1124.1 Q1537.66 1128.68 1531.85 1128.68 Q1526.04 1128.68 1522.96 1124.1 Q1519.9 1119.49 1519.9 1110.77 Q1519.9 1102.02 1522.96 1097.43 Q1526.04 1092.83 1531.85 1092.83 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M1552.01 1122.13 L1556.89 1122.13 L1556.89 1128.01 L1552.01 1128.01 L1552.01 1122.13 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M1579.93 1097.53 L1568.12 1115.97 L1579.93 1115.97 L1579.93 1097.53 M1578.7 1093.45 L1584.58 1093.45 L1584.58 1115.97 L1589.51 1115.97 L1589.51 1119.86 L1584.58 1119.86 L1584.58 1128.01 L1579.93 1128.01 L1579.93 1119.86 L1564.32 1119.86 L1564.32 1115.35 L1578.7 1093.45 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M1883.29 1096.53 Q1879.68 1096.53 1877.85 1100.1 Q1876.05 1103.64 1876.05 1110.77 Q1876.05 1117.87 1877.85 1121.44 Q1879.68 1124.98 1883.29 1124.98 Q1886.93 1124.98 1888.73 1121.44 Q1890.56 1117.87 1890.56 1110.77 Q1890.56 1103.64 1888.73 1100.1 Q1886.93 1096.53 1883.29 1096.53 M1883.29 1092.83 Q1889.1 1092.83 1892.16 1097.43 Q1895.24 1102.02 1895.24 1110.77 Q1895.24 1119.49 1892.16 1124.1 Q1889.1 1128.68 1883.29 1128.68 Q1877.48 1128.68 1874.4 1124.1 Q1871.35 1119.49 1871.35 1110.77 Q1871.35 1102.02 1874.4 1097.43 Q1877.48 1092.83 1883.29 1092.83 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M1903.45 1122.13 L1908.34 1122.13 L1908.34 1128.01 L1903.45 1128.01 L1903.45 1122.13 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M1918.57 1093.45 L1936.93 1093.45 L1936.93 1097.39 L1922.85 1097.39 L1922.85 1105.86 Q1923.87 1105.51 1924.89 1105.35 Q1925.91 1105.16 1926.93 1105.16 Q1932.71 1105.16 1936.09 1108.34 Q1939.47 1111.51 1939.47 1116.92 Q1939.47 1122.5 1936 1125.6 Q1932.53 1128.68 1926.21 1128.68 Q1924.03 1128.68 1921.76 1128.31 Q1919.52 1127.94 1917.11 1127.2 L1917.11 1122.5 Q1919.2 1123.64 1921.42 1124.19 Q1923.64 1124.75 1926.12 1124.75 Q1930.12 1124.75 1932.46 1122.64 Q1934.8 1120.53 1934.8 1116.92 Q1934.8 1113.31 1932.46 1111.21 Q1930.12 1109.1 1926.12 1109.1 Q1924.24 1109.1 1922.37 1109.52 Q1920.51 1109.93 1918.57 1110.81 L1918.57 1093.45 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M1014.82 1157.6 L1014.82 1164.38 Q1011.57 1161.36 1007.88 1159.86 Q1004.22 1158.37 1000.08 1158.37 Q991.936 1158.37 987.607 1163.36 Q983.278 1168.33 983.278 1177.75 Q983.278 1187.14 987.607 1192.14 Q991.936 1197.1 1000.08 1197.1 Q1004.22 1197.1 1007.88 1195.61 Q1011.57 1194.11 1014.82 1191.09 L1014.82 1197.8 Q1011.45 1200.09 1007.66 1201.24 Q1003.9 1202.38 999.702 1202.38 Q988.912 1202.38 982.705 1195.8 Q976.499 1189.18 976.499 1177.75 Q976.499 1166.29 982.705 1159.7 Q988.912 1153.08 999.702 1153.08 Q1003.97 1153.08 1007.72 1154.23 Q1011.51 1155.34 1014.82 1157.6 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M1040.7 1183.54 Q1033.6 1183.54 1030.86 1185.17 Q1028.12 1186.79 1028.12 1190.7 Q1028.12 1193.82 1030.16 1195.67 Q1032.23 1197.48 1035.76 1197.48 Q1040.63 1197.48 1043.56 1194.05 Q1046.52 1190.58 1046.52 1184.85 L1046.52 1183.54 L1040.7 1183.54 M1052.38 1181.12 L1052.38 1201.46 L1046.52 1201.46 L1046.52 1196.05 Q1044.52 1199.3 1041.52 1200.86 Q1038.53 1202.38 1034.2 1202.38 Q1028.73 1202.38 1025.48 1199.33 Q1022.27 1196.24 1022.27 1191.09 Q1022.27 1185.07 1026.28 1182.01 Q1030.32 1178.96 1038.31 1178.96 L1046.52 1178.96 L1046.52 1178.39 Q1046.52 1174.34 1043.85 1172.15 Q1041.21 1169.92 1036.4 1169.92 Q1033.34 1169.92 1030.45 1170.65 Q1027.55 1171.38 1024.88 1172.85 L1024.88 1167.44 Q1028.09 1166.2 1031.12 1165.59 Q1034.14 1164.95 1037 1164.95 Q1044.74 1164.95 1048.56 1168.96 Q1052.38 1172.98 1052.38 1181.12 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M1070.11 1196.11 L1070.11 1215.02 L1064.22 1215.02 L1064.22 1165.81 L1070.11 1165.81 L1070.11 1171.22 Q1071.95 1168.04 1074.75 1166.51 Q1077.59 1164.95 1081.5 1164.95 Q1087.99 1164.95 1092.04 1170.11 Q1096.11 1175.27 1096.11 1183.67 Q1096.11 1192.07 1092.04 1197.23 Q1087.99 1202.38 1081.5 1202.38 Q1077.59 1202.38 1074.75 1200.86 Q1071.95 1199.3 1070.11 1196.11 M1090.03 1183.67 Q1090.03 1177.21 1087.36 1173.55 Q1084.72 1169.86 1080.07 1169.86 Q1075.42 1169.86 1072.75 1173.55 Q1070.11 1177.21 1070.11 1183.67 Q1070.11 1190.13 1072.75 1193.82 Q1075.42 1197.48 1080.07 1197.48 Q1084.72 1197.48 1087.36 1193.82 Q1090.03 1190.13 1090.03 1183.67 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M1105.82 1165.81 L1111.67 1165.81 L1111.67 1201.46 L1105.82 1201.46 L1105.82 1165.81 M1105.82 1151.94 L1111.67 1151.94 L1111.67 1159.35 L1105.82 1159.35 L1105.82 1151.94 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M1129.72 1155.69 L1129.72 1165.81 L1141.78 1165.81 L1141.78 1170.37 L1129.72 1170.37 L1129.72 1189.72 Q1129.72 1194.08 1130.9 1195.32 Q1132.11 1196.56 1135.77 1196.56 L1141.78 1196.56 L1141.78 1201.46 L1135.77 1201.46 Q1128.99 1201.46 1126.41 1198.95 Q1123.83 1196.4 1123.83 1189.72 L1123.83 1170.37 L1119.54 1170.37 L1119.54 1165.81 L1123.83 1165.81 L1123.83 1155.69 L1129.72 1155.69 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M1165.69 1183.54 Q1158.59 1183.54 1155.85 1185.17 Q1153.12 1186.79 1153.12 1190.7 Q1153.12 1193.82 1155.15 1195.67 Q1157.22 1197.48 1160.75 1197.48 Q1165.62 1197.48 1168.55 1194.05 Q1171.51 1190.58 1171.51 1184.85 L1171.51 1183.54 L1165.69 1183.54 M1177.37 1181.12 L1177.37 1201.46 L1171.51 1201.46 L1171.51 1196.05 Q1169.51 1199.3 1166.52 1200.86 Q1163.52 1202.38 1159.19 1202.38 Q1153.72 1202.38 1150.47 1199.33 Q1147.26 1196.24 1147.26 1191.09 Q1147.26 1185.07 1151.27 1182.01 Q1155.31 1178.96 1163.3 1178.96 L1171.51 1178.96 L1171.51 1178.39 Q1171.51 1174.34 1168.84 1172.15 Q1166.2 1169.92 1161.39 1169.92 Q1158.34 1169.92 1155.44 1170.65 Q1152.54 1171.38 1149.87 1172.85 L1149.87 1167.44 Q1153.08 1166.2 1156.11 1165.59 Q1159.13 1164.95 1162 1164.95 Q1169.73 1164.95 1173.55 1168.96 Q1177.37 1172.98 1177.37 1181.12 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M1189.43 1151.94 L1195.29 1151.94 L1195.29 1201.46 L1189.43 1201.46 L1189.43 1151.94 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M1251.97 1176.47 Q1251.97 1178.31 1250.85 1179.4 Q1249.75 1180.5 1248.37 1180.5 Q1247.14 1180.5 1246.5 1179.79 Q1245.86 1179.08 1245.86 1178.18 Q1245.86 1177.79 1246.02 1177.31 Q1246.18 1176.79 1246.53 1176.18 Q1246.92 1175.57 1247.72 1175.12 Q1248.53 1174.67 1249.62 1174.6 Q1249.4 1174.38 1249.33 1174.34 Q1248.85 1173.96 1247.95 1173.83 Q1247.82 1173.76 1247.37 1173.76 Q1245.15 1173.76 1242.89 1175.41 Q1240.67 1177.02 1237.93 1180.08 Q1234.49 1183.65 1232.26 1184.97 Q1242.02 1186.26 1242.02 1191.9 Q1242.02 1192.83 1241.77 1193.96 Q1241.25 1196.08 1241.25 1197.63 Q1241.25 1200.72 1243.34 1200.72 Q1245.37 1200.72 1246.66 1198.66 Q1247.98 1196.6 1249.08 1192.57 Q1249.24 1191.83 1249.4 1191.61 Q1249.56 1191.38 1250.01 1191.38 Q1250.82 1191.38 1250.82 1192.03 Q1250.07 1195.79 1248.43 1198.69 Q1246.34 1202.2 1243.21 1202.2 Q1240.61 1202.2 1238.87 1200.4 Q1237.16 1198.56 1237.16 1195.66 Q1237.16 1194.96 1237.42 1193.35 Q1237.61 1192.7 1237.61 1191.96 Q1237.61 1190.45 1236.77 1189.32 Q1235.94 1188.16 1234.58 1187.58 Q1233.23 1187 1232.1 1186.74 Q1231.01 1186.45 1229.95 1186.36 Q1226.73 1199.98 1226.27 1200.82 Q1225.98 1201.4 1225.34 1201.78 Q1224.7 1202.2 1224.02 1202.2 Q1223.38 1202.2 1222.73 1201.75 Q1222.12 1201.33 1222.12 1200.33 Q1222.12 1199.82 1222.38 1198.89 L1231.94 1160.88 L1232.14 1159.59 Q1232.14 1159.21 1231.97 1159.01 Q1231.85 1158.79 1231.07 1158.63 Q1230.33 1158.47 1228.85 1158.47 Q1228.24 1158.47 1227.95 1158.43 Q1227.69 1158.4 1227.47 1158.24 Q1227.24 1158.05 1227.24 1157.66 Q1227.24 1157.11 1227.47 1156.82 Q1227.72 1156.5 1227.92 1156.44 Q1228.11 1156.37 1228.5 1156.34 Q1229.04 1156.31 1230.88 1156.15 Q1232.72 1155.95 1234.29 1155.83 Q1235.87 1155.7 1236.55 1155.7 Q1236.93 1155.7 1237.13 1155.89 Q1237.35 1156.05 1237.39 1156.24 L1237.42 1156.41 L1230.56 1184.23 Q1233.39 1183.1 1237.87 1178.11 Q1243.05 1172.32 1247.5 1172.32 Q1249.59 1172.32 1250.78 1173.6 Q1251.97 1174.86 1251.97 1176.47 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip140)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="279.897,1068.81 279.897,47.2441 "></polyline>
<polyline clip-path="url(#clip140)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="279.897,885.857 298.795,885.857 "></polyline>
<polyline clip-path="url(#clip140)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="279.897,679.866 298.795,679.866 "></polyline>
<polyline clip-path="url(#clip140)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="279.897,473.875 298.795,473.875 "></polyline>
<polyline clip-path="url(#clip140)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="279.897,267.884 298.795,267.884 "></polyline>
<polyline clip-path="url(#clip140)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="279.897,61.8931 298.795,61.8931 "></polyline>
<path clip-path="url(#clip140)" d="M112.791 886.308 L142.467 886.308 L142.467 890.244 L112.791 890.244 L112.791 886.308 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M153.37 899.202 L161.009 899.202 L161.009 872.836 L152.698 874.503 L152.698 870.244 L160.962 868.577 L165.638 868.577 L165.638 899.202 L173.277 899.202 L173.277 903.137 L153.37 903.137 L153.37 899.202 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M182.768 868.577 L201.124 868.577 L201.124 872.512 L187.05 872.512 L187.05 880.984 Q188.069 880.637 189.087 880.475 Q190.106 880.29 191.124 880.29 Q196.911 880.29 200.291 883.461 Q203.67 886.632 203.67 892.049 Q203.67 897.628 200.198 900.73 Q196.726 903.808 190.407 903.808 Q188.231 903.808 185.962 903.438 Q183.717 903.068 181.309 902.327 L181.309 897.628 Q183.393 898.762 185.615 899.318 Q187.837 899.873 190.314 899.873 Q194.319 899.873 196.656 897.767 Q198.994 895.66 198.994 892.049 Q198.994 888.438 196.656 886.332 Q194.319 884.225 190.314 884.225 Q188.439 884.225 186.564 884.642 Q184.712 885.058 182.768 885.938 L182.768 868.577 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M212.883 897.257 L217.767 897.257 L217.767 903.137 L212.883 903.137 L212.883 897.257 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M237.953 871.656 Q234.341 871.656 232.513 875.221 Q230.707 878.762 230.707 885.892 Q230.707 892.998 232.513 896.563 Q234.341 900.105 237.953 900.105 Q241.587 900.105 243.392 896.563 Q245.221 892.998 245.221 885.892 Q245.221 878.762 243.392 875.221 Q241.587 871.656 237.953 871.656 M237.953 867.952 Q243.763 867.952 246.818 872.558 Q249.897 877.142 249.897 885.892 Q249.897 894.619 246.818 899.225 Q243.763 903.808 237.953 903.808 Q232.142 903.808 229.064 899.225 Q226.008 894.619 226.008 885.892 Q226.008 877.142 229.064 872.558 Q232.142 867.952 237.953 867.952 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M113.787 680.317 L143.462 680.317 L143.462 684.253 L113.787 684.253 L113.787 680.317 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M154.365 693.211 L162.004 693.211 L162.004 666.845 L153.694 668.512 L153.694 664.253 L161.958 662.586 L166.634 662.586 L166.634 693.211 L174.272 693.211 L174.272 697.146 L154.365 697.146 L154.365 693.211 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M187.744 693.211 L204.064 693.211 L204.064 697.146 L182.12 697.146 L182.12 693.211 Q184.782 690.456 189.365 685.827 Q193.971 681.174 195.152 679.831 Q197.397 677.308 198.277 675.572 Q199.18 673.813 199.18 672.123 Q199.18 669.368 197.235 667.632 Q195.314 665.896 192.212 665.896 Q190.013 665.896 187.559 666.66 Q185.129 667.424 182.351 668.975 L182.351 664.253 Q185.175 663.118 187.629 662.54 Q190.082 661.961 192.119 661.961 Q197.49 661.961 200.684 664.646 Q203.879 667.331 203.879 671.822 Q203.879 673.952 203.068 675.873 Q202.281 677.771 200.175 680.364 Q199.596 681.035 196.494 684.253 Q193.393 687.447 187.744 693.211 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M213.879 691.266 L218.763 691.266 L218.763 697.146 L213.879 697.146 L213.879 691.266 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M228.994 662.586 L247.351 662.586 L247.351 666.521 L233.277 666.521 L233.277 674.993 Q234.295 674.646 235.314 674.484 Q236.332 674.299 237.351 674.299 Q243.138 674.299 246.517 677.47 Q249.897 680.641 249.897 686.058 Q249.897 691.637 246.425 694.739 Q242.953 697.817 236.633 697.817 Q234.457 697.817 232.189 697.447 Q229.943 697.077 227.536 696.336 L227.536 691.637 Q229.619 692.771 231.841 693.327 Q234.064 693.882 236.541 693.882 Q240.545 693.882 242.883 691.776 Q245.221 689.669 245.221 686.058 Q245.221 682.447 242.883 680.341 Q240.545 678.234 236.541 678.234 Q234.666 678.234 232.791 678.651 Q230.939 679.067 228.994 679.947 L228.994 662.586 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M112.791 474.326 L142.467 474.326 L142.467 478.262 L112.791 478.262 L112.791 474.326 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M153.37 487.22 L161.009 487.22 L161.009 460.854 L152.698 462.521 L152.698 458.262 L160.962 456.595 L165.638 456.595 L165.638 487.22 L173.277 487.22 L173.277 491.155 L153.37 491.155 L153.37 487.22 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M192.721 459.674 Q189.11 459.674 187.282 463.239 Q185.476 466.78 185.476 473.91 Q185.476 481.016 187.282 484.581 Q189.11 488.123 192.721 488.123 Q196.356 488.123 198.161 484.581 Q199.99 481.016 199.99 473.91 Q199.99 466.78 198.161 463.239 Q196.356 459.674 192.721 459.674 M192.721 455.97 Q198.531 455.97 201.587 460.577 Q204.666 465.16 204.666 473.91 Q204.666 482.637 201.587 487.243 Q198.531 491.826 192.721 491.826 Q186.911 491.826 183.832 487.243 Q180.777 482.637 180.777 473.91 Q180.777 465.16 183.832 460.577 Q186.911 455.97 192.721 455.97 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M212.883 485.275 L217.767 485.275 L217.767 491.155 L212.883 491.155 L212.883 485.275 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M237.953 459.674 Q234.341 459.674 232.513 463.239 Q230.707 466.78 230.707 473.91 Q230.707 481.016 232.513 484.581 Q234.341 488.123 237.953 488.123 Q241.587 488.123 243.392 484.581 Q245.221 481.016 245.221 473.91 Q245.221 466.78 243.392 463.239 Q241.587 459.674 237.953 459.674 M237.953 455.97 Q243.763 455.97 246.818 460.577 Q249.897 465.16 249.897 473.91 Q249.897 482.637 246.818 487.243 Q243.763 491.826 237.953 491.826 Q232.142 491.826 229.064 487.243 Q226.008 482.637 226.008 473.91 Q226.008 465.16 229.064 460.577 Q232.142 455.97 237.953 455.97 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M143.948 268.335 L173.624 268.335 L173.624 272.271 L143.948 272.271 L143.948 268.335 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M182.536 250.604 L204.758 250.604 L204.758 252.595 L192.212 285.164 L187.328 285.164 L199.133 254.539 L182.536 254.539 L182.536 250.604 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M213.879 279.284 L218.763 279.284 L218.763 285.164 L213.879 285.164 L213.879 279.284 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M228.994 250.604 L247.351 250.604 L247.351 254.539 L233.277 254.539 L233.277 263.011 Q234.295 262.664 235.314 262.502 Q236.332 262.317 237.351 262.317 Q243.138 262.317 246.517 265.488 Q249.897 268.66 249.897 274.076 Q249.897 279.655 246.425 282.757 Q242.953 285.835 236.633 285.835 Q234.457 285.835 232.189 285.465 Q229.943 285.095 227.536 284.354 L227.536 279.655 Q229.619 280.789 231.841 281.345 Q234.064 281.9 236.541 281.9 Q240.545 281.9 242.883 279.794 Q245.221 277.687 245.221 274.076 Q245.221 270.465 242.883 268.359 Q240.545 266.252 236.541 266.252 Q234.666 266.252 232.791 266.669 Q230.939 267.085 228.994 267.965 L228.994 250.604 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M142.953 62.3445 L172.629 62.3445 L172.629 66.2797 L142.953 66.2797 L142.953 62.3445 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M182.768 44.6131 L201.124 44.6131 L201.124 48.5483 L187.05 48.5483 L187.05 57.0204 Q188.069 56.6732 189.087 56.5112 Q190.106 56.326 191.124 56.326 Q196.911 56.326 200.291 59.4973 Q203.67 62.6686 203.67 68.0852 Q203.67 73.6639 200.198 76.7657 Q196.726 79.8444 190.407 79.8444 Q188.231 79.8444 185.962 79.474 Q183.717 79.1037 181.309 78.3629 L181.309 73.6639 Q183.393 74.7981 185.615 75.3537 Q187.837 75.9092 190.314 75.9092 Q194.319 75.9092 196.656 73.8028 Q198.994 71.6963 198.994 68.0852 Q198.994 64.4741 196.656 62.3676 Q194.319 60.2612 190.314 60.2612 Q188.439 60.2612 186.564 60.6778 Q184.712 61.0945 182.768 61.9741 L182.768 44.6131 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M212.883 73.2935 L217.767 73.2935 L217.767 79.1731 L212.883 79.1731 L212.883 73.2935 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M237.953 47.6918 Q234.341 47.6918 232.513 51.2566 Q230.707 54.7982 230.707 61.9278 Q230.707 69.0343 232.513 72.5991 Q234.341 76.1407 237.953 76.1407 Q241.587 76.1407 243.392 72.5991 Q245.221 69.0343 245.221 61.9278 Q245.221 54.7982 243.392 51.2566 Q241.587 47.6918 237.953 47.6918 M237.953 43.9881 Q243.763 43.9881 246.818 48.5946 Q249.897 53.1779 249.897 61.9278 Q249.897 70.6546 246.818 75.2611 Q243.763 79.8444 237.953 79.8444 Q232.142 79.8444 229.064 75.2611 Q226.008 70.6546 226.008 61.9278 Q226.008 53.1779 229.064 48.5946 Q232.142 43.9881 237.953 43.9881 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M70.6138 739.162 L23.0938 757.304 L23.0938 750.589 L63.1023 735.534 L23.0938 720.447 L23.0938 713.763 L70.6138 731.873 L70.6138 739.162 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M52.6944 695.939 Q52.6944 703.037 54.3176 705.774 Q55.9409 708.511 59.8558 708.511 Q62.975 708.511 64.821 706.474 Q66.6353 704.405 66.6353 700.872 Q66.6353 696.003 63.1978 693.074 Q59.7285 690.114 53.9993 690.114 L52.6944 690.114 L52.6944 695.939 M50.2754 684.258 L70.6138 684.258 L70.6138 690.114 L65.203 690.114 Q68.4495 692.119 70.0091 695.111 Q71.5369 698.103 71.5369 702.432 Q71.5369 707.906 68.4813 711.153 Q65.394 714.368 60.2377 714.368 Q54.2221 714.368 51.1666 710.357 Q48.1111 706.315 48.1111 698.326 L48.1111 690.114 L47.5381 690.114 Q43.4959 690.114 41.2998 692.788 Q39.0718 695.43 39.0718 700.236 Q39.0718 703.291 39.8038 706.188 Q40.5359 709.084 42 711.758 L36.5891 711.758 Q35.3478 708.543 34.7431 705.519 Q34.1065 702.496 34.1065 699.631 Q34.1065 691.897 38.1169 688.077 Q42.1273 684.258 50.2754 684.258 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M21.0886 672.195 L21.0886 666.338 L70.6138 666.338 L70.6138 672.195 L21.0886 672.195 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M56.5456 654.689 L34.9659 654.689 L34.9659 648.833 L56.3228 648.833 Q61.3836 648.833 63.9298 646.859 Q66.4443 644.886 66.4443 640.939 Q66.4443 636.197 63.4206 633.46 Q60.3969 630.69 55.177 630.69 L34.9659 630.69 L34.9659 624.834 L70.6138 624.834 L70.6138 630.69 L65.1393 630.69 Q68.3858 632.823 69.9773 635.656 Q71.5369 638.457 71.5369 642.181 Q71.5369 648.323 67.7174 651.506 Q63.898 654.689 56.5456 654.689 M34.1065 639.953 L34.1065 639.953 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M51.3257 582.279 L54.1903 582.279 L54.1903 609.206 Q60.2377 608.824 63.4206 605.578 Q66.5716 602.299 66.5716 596.475 Q66.5716 593.101 65.7441 589.95 Q64.9165 586.767 63.2614 583.648 L68.7996 583.648 Q70.1364 586.799 70.8366 590.109 Q71.5369 593.419 71.5369 596.825 Q71.5369 605.355 66.5716 610.352 Q61.6064 615.317 53.14 615.317 Q44.3871 615.317 39.2627 610.607 Q34.1065 605.864 34.1065 597.843 Q34.1065 590.65 38.7535 586.481 Q43.3686 582.279 51.3257 582.279 M49.607 588.136 Q44.8009 588.199 41.9363 590.841 Q39.0718 593.451 39.0718 597.78 Q39.0718 602.681 41.8408 605.641 Q44.6099 608.57 49.6388 609.015 L49.607 588.136 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M26.363 511.069 Q27.5546 511.133 27.619 511.939 Q27.6834 513.162 27.8444 513.903 Q27.9733 514.644 28.4564 515.803 Q28.9394 516.963 30.0989 518.09 Q31.2583 519.217 33.094 520.376 L70.8715 544.112 Q71.58 544.531 71.8054 544.885 Q72.0631 545.207 72.0631 545.948 Q72.0631 546.624 71.7732 546.882 Q71.5156 547.14 70.5494 547.268 L29.8412 552.486 Q29.1005 552.582 28.7784 552.679 Q28.4564 552.776 28.1343 553.162 Q27.8122 553.516 27.7156 554.289 Q27.619 555.062 27.619 556.447 Q27.619 557.091 27.5868 557.381 Q27.5546 557.639 27.3936 557.864 Q27.2003 558.09 26.8139 558.09 Q26.2342 558.09 25.9443 557.864 Q25.6222 557.606 25.59 557.413 Q25.5578 557.188 25.5578 556.834 Q25.5578 556.286 25.6222 555.094 Q25.6867 553.903 25.6867 553.291 Q25.6867 552.711 25.7189 551.487 Q25.7511 550.264 25.7511 549.652 Q25.7511 548.299 25.6545 545.561 Q25.5578 542.792 25.5578 541.471 Q25.5578 540.57 26.2986 540.57 Q27.2003 540.57 27.4258 540.956 Q27.619 541.342 27.619 542.212 Q27.619 544.402 28.1665 545.594 Q28.714 546.753 29.5836 546.753 L64.4947 542.276 L32.2889 522.019 Q30.7752 521.021 29.7768 521.021 Q27.8444 521.021 27.619 524.08 Q27.619 525.111 26.8139 525.111 Q26.2342 525.111 25.9443 524.853 Q25.6222 524.595 25.59 524.402 Q25.5578 524.177 25.5578 523.855 Q25.5578 522.792 25.6545 520.634 Q25.7511 518.444 25.7511 517.349 Q25.7511 516.447 25.6545 514.612 Q25.5578 512.776 25.5578 511.939 Q25.5578 511.069 26.363 511.069 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M54.1244 502.348 Q42.9812 502.348 33.9958 498.194 Q30.2277 496.422 27.0715 493.942 Q23.9153 491.463 22.5305 489.82 Q21.1456 488.178 21.1456 487.727 Q21.1456 487.083 21.7897 487.05 Q22.1118 487.05 22.917 487.92 Q33.7381 498.548 54.1244 498.516 Q74.5752 498.516 84.9776 488.178 Q86.1049 487.05 86.4591 487.05 Q87.1032 487.05 87.1032 487.727 Q87.1032 488.178 85.7828 489.756 Q84.4624 491.334 81.435 493.781 Q78.4077 496.229 74.704 498 Q65.7185 502.348 54.1244 502.348 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M45.6221 451.127 Q47.4578 451.127 48.5528 452.254 Q49.6478 453.349 49.6478 454.734 Q49.6478 455.958 48.9393 456.602 Q48.2308 457.246 47.329 457.246 Q46.9425 457.246 46.4594 457.085 Q45.9441 456.924 45.3322 456.57 Q44.7203 456.183 44.2694 455.378 Q43.8186 454.573 43.7541 453.478 Q43.5287 453.703 43.4965 453.768 Q43.11 454.251 42.9812 455.153 Q42.9168 455.281 42.9168 455.732 Q42.9168 457.955 44.5593 460.209 Q46.1696 462.431 49.2291 465.169 Q52.804 468.615 54.1244 470.837 Q55.4127 461.079 61.0487 461.079 Q61.9827 461.079 63.1099 461.336 Q65.2355 461.851 66.7813 461.851 Q69.8731 461.851 69.8731 459.758 Q69.8731 457.729 67.8119 456.441 Q65.7507 455.12 61.725 454.025 Q60.9843 453.864 60.7588 453.703 Q60.5334 453.542 60.5334 453.091 Q60.5334 452.286 61.1775 452.286 Q64.9456 453.027 67.8441 454.67 Q71.3546 456.763 71.3546 459.887 Q71.3546 462.496 69.551 464.235 Q67.7153 465.942 64.8168 465.942 Q64.1082 465.942 62.498 465.684 Q61.8538 465.491 61.1131 465.491 Q59.5994 465.491 58.4722 466.328 Q57.3128 467.165 56.7331 468.518 Q56.1534 469.871 55.8958 470.998 Q55.6059 472.093 55.5093 473.156 Q69.1324 476.376 69.9697 476.827 Q70.5494 477.117 70.9359 477.761 Q71.3546 478.405 71.3546 479.082 Q71.3546 479.726 70.9037 480.37 Q70.485 480.982 69.4866 480.982 Q68.9713 480.982 68.0374 480.724 L30.0344 471.159 L28.7462 470.966 Q28.3597 470.966 28.1665 471.127 Q27.9411 471.256 27.78 472.029 Q27.619 472.769 27.619 474.251 Q27.619 474.863 27.5868 475.152 Q27.5546 475.41 27.3936 475.636 Q27.2003 475.861 26.8139 475.861 Q26.2664 475.861 25.9765 475.636 Q25.6545 475.378 25.59 475.185 Q25.5256 474.991 25.4934 474.605 Q25.4612 474.057 25.3002 472.222 Q25.107 470.386 24.9781 468.808 Q24.8493 467.23 24.8493 466.554 Q24.8493 466.167 25.0425 465.974 Q25.2036 465.748 25.3968 465.716 L25.5578 465.684 L53.3837 472.544 Q52.2565 469.71 47.2646 465.233 Q41.4675 460.048 41.4675 455.604 Q41.4675 453.51 42.7558 452.319 Q44.0118 451.127 45.6221 451.127 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M69.551 446.013 Q68.4882 446.947 67.1034 446.947 Q65.7185 446.947 64.688 446.046 Q63.6252 445.112 63.6252 443.437 Q63.6252 441.472 65.5253 440.345 Q67.3932 439.218 70.5494 439.218 Q73.9632 439.218 77.1194 440.603 Q80.3078 441.988 81.8215 443.34 Q83.3351 444.693 83.3351 445.241 Q83.3351 445.885 82.6266 445.885 Q82.369 445.885 81.8859 445.434 Q76.7974 440.699 70.5494 440.667 Q69.551 440.667 69.551 440.796 L69.6799 440.957 Q70.6138 442.084 70.6138 443.437 Q70.6138 445.079 69.551 446.013 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M42.1116 390.449 Q42.3371 390.449 43.3033 390.997 Q44.2372 391.512 46.5883 393.412 Q48.9393 395.312 51.6768 398.147 Q52.7396 399.209 54.221 400.82 Q55.7025 402.43 56.6687 403.525 L57.6349 404.62 Q61.1775 408.807 65.1388 412.478 Q65.0422 412.22 65.01 411.77 Q64.9456 411.319 64.9456 410.997 L64.9456 410.675 Q64.9456 409 66.0728 406.069 Q66.9102 403.493 66.9102 402.172 Q66.9102 400.884 66.4593 399.467 Q66.0084 398.05 64.688 396.504 Q63.3675 394.958 61.3708 394.25 Q61.0487 394.121 60.9521 394.056 Q60.8233 393.992 60.6944 393.799 Q60.5334 393.605 60.5334 393.348 Q60.5334 392.994 60.7266 392.768 Q60.9199 392.543 61.1775 392.543 Q61.7572 392.543 62.9166 392.994 Q64.076 393.412 65.5253 394.346 Q66.9746 395.248 68.295 396.44 Q69.5832 397.599 70.485 399.338 Q71.3546 401.077 71.3546 402.913 Q71.3546 404.233 70.7105 405.2 Q70.0985 406.166 68.9069 407.132 Q67.3932 408.452 66.9102 409.161 Q66.3949 409.869 66.3949 410.964 Q66.3949 413.895 70.485 416.568 Q71.0647 416.858 71.1935 417.051 Q71.3546 417.212 71.3546 417.599 Q71.3224 418.404 70.6782 418.404 Q70.4206 418.404 69.2934 417.695 Q68.134 416.955 66.105 415.312 Q64.076 413.638 62.0471 411.609 L56.5077 405.683 Q50.9683 399.113 47.8443 396.504 Q47.8443 397.599 47.8121 398.082 Q47.7799 398.533 47.5866 399.435 Q47.3612 400.337 46.8781 401.593 Q45.8797 404.523 45.8797 405.747 Q45.8797 406.069 45.9119 406.423 Q45.9441 406.778 46.1052 407.583 Q46.2662 408.356 46.5883 409 Q46.8781 409.644 47.5222 410.32 Q48.1341 410.997 48.9715 411.351 Q49.2291 411.448 49.358 411.512 Q49.4868 411.576 49.6156 411.77 Q49.7122 411.931 49.7122 412.188 Q49.7122 412.575 49.4868 412.8 Q49.2613 412.993 48.9715 412.993 Q48.3918 412.993 47.2002 412.414 Q46.0086 411.834 44.7203 410.868 Q43.3999 409.902 42.4337 408.324 Q41.4675 406.745 41.4675 405.006 Q41.4675 403.976 41.9184 403.106 Q42.3693 402.204 42.8524 401.754 Q43.3033 401.27 44.3016 400.465 Q45.0746 399.789 45.3966 399.467 Q45.7187 399.145 46.073 398.501 Q46.395 397.824 46.395 397.084 Q46.395 395.86 45.4611 394.733 Q44.4949 393.605 42.1761 392.156 Q41.4675 391.77 41.4675 391.158 Q41.4675 390.449 42.1116 390.449 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M86.4591 384.078 Q86.1371 384.078 85.3319 383.24 Q74.5107 372.613 54.1244 372.613 Q33.6737 372.613 23.3356 382.822 Q22.144 384.078 21.7897 384.078 Q21.1456 384.078 21.1456 383.434 Q21.1456 382.983 22.4661 381.405 Q23.7865 379.794 26.8139 377.379 Q29.8412 374.931 33.5449 373.128 Q42.5303 368.78 54.1244 368.78 Q65.2677 368.78 74.2531 372.935 Q78.0212 374.706 81.1774 377.186 Q84.3335 379.666 85.7184 381.308 Q87.1032 382.951 87.1032 383.434 Q87.1032 384.078 86.4591 384.078 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip142)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="327.242,184.625 343.024,180.028 358.805,175.864 374.587,172.059 390.369,168.558 406.15,165.316 421.932,162.299 437.714,159.478 453.496,156.829 469.277,154.332 485.059,151.972 500.841,149.734 516.622,147.607 532.404,145.58 548.186,143.644 563.967,141.791 579.749,140.015 595.531,138.31 611.312,136.67 627.094,135.09 642.876,133.566 658.657,132.094 674.439,130.671 690.221,129.294 706.003,127.959 721.784,126.665 737.566,125.409 753.348,124.188 769.129,123.001 784.911,121.846 800.693,120.722 816.474,119.626 832.256,118.557 848.038,117.514 863.819,116.496 879.601,115.501 895.383,114.528 911.164,113.578 926.946,112.647 942.728,111.736 958.51,110.845 974.291,109.971 990.073,109.114 1005.85,108.274 1021.64,107.45 1037.42,106.642 1053.2,105.848 1068.98,105.069 1084.76,104.303 1100.54,103.55 1116.33,102.811 1132.11,102.083 1147.89,101.368 1163.67,100.664 1179.45,99.972 1195.23,99.2903 1211.02,98.6191 1226.8,97.9581 1242.58,97.3069 1258.36,96.6653 1274.14,96.033 1289.92,95.4097 1305.71,94.7951 1321.49,94.189 1337.27,93.5912 1353.05,93.0015 1368.83,92.4195 1384.62,91.8452 1400.4,91.2783 1416.18,90.7186 1431.96,90.1659 1447.74,89.6201 1463.52,89.0809 1479.31,88.5483 1495.09,88.022 1510.87,87.5019 1526.65,86.9879 1542.43,86.4798 1558.21,85.9774 1574,85.4807 1589.78,84.9895 1605.56,84.5036 1621.34,84.0231 1637.12,83.5476 1652.9,83.0773 1668.69,82.6118 1684.47,82.1511 1700.25,81.6952 1716.03,81.2439 1731.81,80.7971 1747.59,80.3548 1763.38,79.9167 1779.16,79.483 1794.94,79.0534 1810.72,78.6279 1826.5,78.2064 1842.28,77.7888 1858.07,77.3751 1873.85,76.9652 1889.63,76.559 1905.41,76.1564 "></polyline>
<polyline clip-path="url(#clip142)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="327.242,377.453 343.024,371.495 358.805,365.99 374.587,360.887 390.369,356.13 406.15,351.677 421.932,347.489 437.714,343.537 453.496,339.794 469.277,336.239 485.059,332.852 500.841,329.617 516.622,326.522 532.404,323.556 548.186,320.705 563.967,317.962 579.749,315.32 595.531,312.768 611.312,310.303 627.094,307.917 642.876,305.606 658.657,303.366 674.439,301.207 690.221,299.131 706.003,297.132 721.784,295.205 737.566,293.345 753.348,291.546 769.129,289.806 784.911,288.121 800.693,286.487 816.474,284.902 832.256,283.362 848.038,281.866 863.819,280.41 879.601,278.992 895.383,277.612 911.164,276.266 926.946,274.953 942.728,273.672 958.51,272.42 974.291,271.198 990.073,270.003 1005.85,268.833 1021.64,267.689 1037.42,266.569 1053.2,265.472 1068.98,264.397 1084.76,263.344 1100.54,262.31 1116.33,261.296 1132.11,260.301 1147.89,259.325 1163.67,258.365 1179.45,257.423 1195.23,256.497 1211.02,255.587 1226.8,254.691 1242.58,253.811 1258.36,252.945 1274.14,252.092 1289.92,251.253 1305.71,250.427 1321.49,249.613 1337.27,248.812 1353.05,248.022 1368.83,247.244 1384.62,246.476 1400.4,245.72 1416.18,244.974 1431.96,244.238 1447.74,243.512 1463.52,242.796 1479.31,242.089 1495.09,241.391 1510.87,240.702 1526.65,240.022 1542.43,239.35 1558.21,238.687 1574,238.031 1589.78,237.383 1605.56,236.743 1621.34,236.111 1637.12,235.485 1652.9,234.867 1668.69,234.256 1684.47,233.652 1700.25,233.054 1716.03,232.462 1731.81,231.878 1747.59,231.299 1763.38,230.726 1779.16,230.159 1794.94,229.599 1810.72,229.043 1826.5,228.494 1842.28,227.95 1858.07,227.411 1873.85,226.877 1889.63,226.349 1905.41,225.826 "></polyline>
<polyline clip-path="url(#clip142)" style="stroke:#3da44d; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="327.242,595.397 343.024,588.133 358.805,581.377 374.587,575.068 390.369,569.158 406.15,563.574 421.932,558.296 437.714,553.281 453.496,548.509 469.277,543.945 485.059,539.584 500.841,535.389 516.622,531.366 532.404,527.49 548.186,523.747 563.967,520.136 579.749,516.642 595.531,513.255 611.312,509.974 627.094,506.79 642.876,503.691 658.657,500.678 674.439,497.747 690.221,494.892 706.003,492.11 721.784,489.39 737.566,486.737 753.348,484.153 769.129,481.631 784.911,479.171 800.693,476.77 816.474,474.424 832.256,472.129 848.038,469.883 863.819,467.685 879.601,465.533 895.383,463.425 911.164,461.358 926.946,459.333 942.728,457.345 958.51,455.395 974.291,453.481 990.073,451.601 1005.85,449.753 1021.64,447.934 1037.42,446.148 1053.2,444.392 1068.98,442.663 1084.76,440.963 1100.54,439.289 1116.33,437.641 1132.11,436.016 1147.89,434.415 1163.67,432.839 1179.45,431.285 1195.23,429.754 1211.02,428.244 1226.8,426.752 1242.58,425.281 1258.36,423.83 1274.14,422.398 1289.92,420.986 1305.71,419.59 1321.49,418.21 1337.27,416.849 1353.05,415.504 1368.83,414.177 1384.62,412.876 1400.4,411.6 1416.18,410.348 1431.96,409.118 1447.74,407.911 1463.52,406.724 1479.31,405.559 1495.09,404.413 1510.87,403.286 1526.65,402.178 1542.43,401.088 1558.21,400.015 1574,398.959 1589.78,397.92 1605.56,396.896 1621.34,395.888 1637.12,394.895 1652.9,393.916 1668.69,392.951 1684.47,392 1700.25,391.062 1716.03,390.137 1731.81,389.225 1747.59,388.325 1763.38,387.437 1779.16,386.56 1794.94,385.695 1810.72,384.84 1826.5,383.997 1842.28,383.164 1858.07,382.341 1873.85,381.528 1889.63,380.725 1905.41,379.931 "></polyline>
<polyline clip-path="url(#clip142)" style="stroke:#c271d2; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="327.242,823.75 343.024,815.092 358.805,807.008 374.587,799.426 390.369,792.275 406.15,785.487 421.932,779.023 437.714,772.863 453.496,766.973 469.277,761.328 485.059,755.906 500.841,750.689 516.622,745.66 532.404,740.805 548.186,736.11 563.967,731.567 579.749,727.166 595.531,722.897 611.312,718.746 627.094,714.709 642.876,710.782 658.657,706.95 674.439,703.211 690.221,699.564 706.003,696.003 721.784,692.526 737.566,689.127 753.348,685.8 769.129,682.544 784.911,679.356 800.693,676.234 816.474,673.166 832.256,670.154 848.038,667.201 863.819,664.3 879.601,661.453 895.383,658.655 911.164,655.907 926.946,653.205 942.728,650.541 958.51,647.922 974.291,645.341 990.073,642.803 1005.85,640.305 1021.64,637.847 1037.42,635.418 1053.2,633.026 1068.98,630.665 1084.76,628.338 1100.54,626.046 1116.33,623.787 1132.11,621.551 1147.89,619.346 1163.67,617.17 1179.45,615.023 1195.23,612.908 1211.02,610.812 1226.8,608.741 1242.58,606.698 1258.36,604.684 1274.14,602.693 1289.92,600.724 1305.71,598.778 1321.49,596.864 1337.27,594.966 1353.05,593.094 1368.83,591.245 1384.62,589.418 1400.4,587.605 1416.18,585.817 1431.96,584.055 1447.74,582.306 1463.52,580.573 1479.31,578.863 1495.09,577.174 1510.87,575.497 1526.65,573.839 1542.43,572.2 1558.21,570.576 1574,568.968 1589.78,567.378 1605.56,565.804 1621.34,564.239 1637.12,562.692 1652.9,561.166 1668.69,559.648 1684.47,558.143 1700.25,556.654 1716.03,555.179 1731.81,553.714 1747.59,552.265 1763.38,550.83 1779.16,549.403 1794.94,547.99 1810.72,546.593 1826.5,545.204 1842.28,543.824 1858.07,542.459 1873.85,541.106 1889.63,539.762 1905.41,538.429 "></polyline>
<polyline clip-path="url(#clip142)" style="stroke:#ac8d18; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="327.242,1039.9 343.024,1029.56 358.805,1019.89 374.587,1010.7 390.369,1002.01 406.15,993.788 421.932,985.985 437.714,978.529 453.496,971.417 469.277,964.51 485.059,957.892 500.841,951.542 516.622,945.434 532.404,939.529 548.186,933.749 563.967,928.171 579.749,922.785 595.531,917.579 611.312,912.479 627.094,907.499 642.876,902.66 658.657,897.963 674.439,893.378 690.221,888.871 706.003,884.48 721.784,880.194 737.566,876.015 753.348,871.883 769.129,867.854 784.911,863.924 800.693,860.071 816.474,856.256 832.256,852.528 848.038,848.886 863.819,845.31 879.601,841.774 895.383,838.298 911.164,834.894 926.946,831.548 942.728,828.239 958.51,824.994 974.291,821.804 990.073,818.656 1005.85,815.542 1021.64,812.49 1037.42,809.492 1053.2,806.515 1068.98,803.576 1084.76,800.69 1100.54,797.852 1116.33,795.027 1132.11,792.248 1147.89,789.51 1163.67,786.808 1179.45,784.13 1195.23,781.492 1211.02,778.889 1226.8,776.308 1242.58,773.751 1258.36,771.235 1274.14,768.754 1289.92,766.287 1305.71,763.85 1321.49,761.445 1337.27,759.063 1353.05,756.701 1368.83,754.371 1384.62,752.07 1400.4,749.779 1416.18,747.52 1431.96,745.287 1447.74,743.073 1463.52,740.87 1479.31,738.696 1495.09,736.554 1510.87,734.417 1526.65,732.308 1542.43,730.22 1558.21,728.149 1574,726.092 1589.78,724.065 1605.56,722.055 1621.34,720.053 1637.12,718.075 1652.9,716.123 1668.69,714.175 1684.47,712.253 1700.25,710.345 1716.03,708.45 1731.81,706.573 1747.59,704.723 1763.38,702.879 1779.16,701.048 1794.94,699.233 1810.72,697.437 1826.5,695.65 1842.28,693.888 1858.07,692.137 1873.85,690.388 1889.63,688.662 1905.41,686.953 "></polyline>
<path clip-path="url(#clip140)" d="M1684.6 1034.76 L1896.99 1034.76 L1896.99 723.719 L1684.6 723.719  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<polyline clip-path="url(#clip140)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1684.6,1034.76 1896.99,1034.76 1896.99,723.719 1684.6,723.719 1684.6,1034.76 "></polyline>
<polyline clip-path="url(#clip140)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1703.19,775.559 1814.71,775.559 "></polyline>
<path clip-path="url(#clip140)" d="M1853.63 758.049 Q1853.63 758.213 1853.23 758.916 Q1852.86 759.595 1851.47 761.305 Q1850.09 763.015 1848.03 765.006 Q1847.26 765.779 1846.09 766.856 Q1844.92 767.934 1844.12 768.636 L1843.32 769.339 Q1840.28 771.915 1837.61 774.796 Q1837.8 774.726 1838.12 774.703 Q1838.45 774.656 1838.69 774.656 L1838.92 774.656 Q1840.14 774.656 1842.27 775.476 Q1844.14 776.085 1845.1 776.085 Q1846.04 776.085 1847.07 775.757 Q1848.1 775.429 1849.23 774.468 Q1850.35 773.508 1850.86 772.056 Q1850.96 771.822 1851.01 771.751 Q1851.05 771.658 1851.19 771.564 Q1851.33 771.447 1851.52 771.447 Q1851.78 771.447 1851.94 771.587 Q1852.11 771.728 1852.11 771.915 Q1852.11 772.337 1851.78 773.18 Q1851.47 774.023 1850.79 775.077 Q1850.14 776.131 1849.27 777.092 Q1848.43 778.029 1847.16 778.684 Q1845.9 779.317 1844.56 779.317 Q1843.6 779.317 1842.9 778.848 Q1842.2 778.403 1841.5 777.537 Q1840.54 776.436 1840.02 776.085 Q1839.51 775.71 1838.71 775.71 Q1836.58 775.71 1834.63 778.684 Q1834.42 779.106 1834.28 779.2 Q1834.16 779.317 1833.88 779.317 Q1833.3 779.293 1833.3 778.825 Q1833.3 778.638 1833.81 777.818 Q1834.35 776.975 1835.55 775.499 Q1836.76 774.023 1838.24 772.548 L1842.55 768.519 Q1847.33 764.49 1849.23 762.219 Q1848.43 762.219 1848.08 762.195 Q1847.75 762.172 1847.09 762.031 Q1846.44 761.867 1845.52 761.516 Q1843.39 760.79 1842.5 760.79 Q1842.27 760.79 1842.01 760.813 Q1841.75 760.837 1841.17 760.954 Q1840.61 761.071 1840.14 761.305 Q1839.67 761.516 1839.18 761.984 Q1838.69 762.429 1838.43 763.038 Q1838.36 763.226 1838.31 763.319 Q1838.26 763.413 1838.12 763.507 Q1838.01 763.577 1837.82 763.577 Q1837.54 763.577 1837.37 763.413 Q1837.23 763.249 1837.23 763.038 Q1837.23 762.617 1837.65 761.75 Q1838.08 760.883 1838.78 759.947 Q1839.48 758.986 1840.63 758.284 Q1841.78 757.581 1843.04 757.581 Q1843.79 757.581 1844.42 757.909 Q1845.08 758.237 1845.41 758.588 Q1845.76 758.916 1846.34 759.642 Q1846.84 760.204 1847.07 760.438 Q1847.3 760.673 1847.77 760.93 Q1848.27 761.165 1848.8 761.165 Q1849.69 761.165 1850.51 760.485 Q1851.33 759.783 1852.39 758.096 Q1852.67 757.581 1853.11 757.581 Q1853.63 757.581 1853.63 758.049 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M1858.55 787.191 Q1858.55 786.19 1859.09 785.813 Q1859.63 785.42 1860.2 785.42 Q1860.97 785.42 1861.42 785.912 Q1861.88 786.387 1861.88 787.059 Q1861.88 787.732 1861.42 788.223 Q1860.97 788.699 1860.2 788.699 Q1859.83 788.699 1859.63 788.633 Q1860.07 790.175 1861.42 791.289 Q1862.78 792.404 1864.57 792.404 Q1866.81 792.404 1868.16 790.224 Q1868.96 788.814 1868.96 785.617 Q1868.96 782.796 1868.35 781.386 Q1867.42 779.239 1865.5 779.239 Q1862.78 779.239 1861.17 781.583 Q1860.97 781.878 1860.75 781.895 Q1860.42 781.895 1860.34 781.714 Q1860.27 781.518 1860.27 781.009 L1860.27 771.074 Q1860.27 770.27 1860.6 770.27 Q1860.73 770.27 1861.01 770.369 Q1863.12 771.303 1865.47 771.319 Q1867.88 771.319 1870.04 770.336 Q1870.21 770.237 1870.3 770.237 Q1870.63 770.237 1870.65 770.614 Q1870.65 770.746 1870.37 771.139 Q1870.11 771.516 1869.53 772.024 Q1868.96 772.516 1868.22 772.992 Q1867.48 773.467 1866.4 773.795 Q1865.34 774.107 1864.16 774.107 Q1862.75 774.107 1861.3 773.664 L1861.3 780.206 Q1863.04 778.501 1865.57 778.501 Q1868.25 778.501 1870.11 780.665 Q1871.96 782.829 1871.96 785.846 Q1871.96 789.01 1869.76 791.175 Q1867.58 793.339 1864.63 793.339 Q1861.94 793.339 1860.24 791.421 Q1858.55 789.502 1858.55 787.191 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip140)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1703.19,827.399 1814.71,827.399 "></polyline>
<path clip-path="url(#clip140)" d="M1853.63 810.142 Q1853.63 810.306 1853.23 811.008 Q1852.86 811.688 1851.47 813.398 Q1850.09 815.107 1848.03 817.098 Q1847.26 817.871 1846.09 818.949 Q1844.92 820.026 1844.12 820.729 L1843.32 821.431 Q1840.28 824.008 1837.61 826.889 Q1837.8 826.819 1838.12 826.795 Q1838.45 826.748 1838.69 826.748 L1838.92 826.748 Q1840.14 826.748 1842.27 827.568 Q1844.14 828.177 1845.1 828.177 Q1846.04 828.177 1847.07 827.849 Q1848.1 827.521 1849.23 826.561 Q1850.35 825.601 1850.86 824.148 Q1850.96 823.914 1851.01 823.844 Q1851.05 823.75 1851.19 823.657 Q1851.33 823.539 1851.52 823.539 Q1851.78 823.539 1851.94 823.68 Q1852.11 823.82 1852.11 824.008 Q1852.11 824.429 1851.78 825.273 Q1851.47 826.116 1850.79 827.17 Q1850.14 828.224 1849.27 829.184 Q1848.43 830.121 1847.16 830.777 Q1845.9 831.409 1844.56 831.409 Q1843.6 831.409 1842.9 830.941 Q1842.2 830.496 1841.5 829.629 Q1840.54 828.528 1840.02 828.177 Q1839.51 827.802 1838.71 827.802 Q1836.58 827.802 1834.63 830.777 Q1834.42 831.199 1834.28 831.292 Q1834.16 831.409 1833.88 831.409 Q1833.3 831.386 1833.3 830.917 Q1833.3 830.73 1833.81 829.91 Q1834.35 829.067 1835.55 827.592 Q1836.76 826.116 1838.24 824.64 L1842.55 820.612 Q1847.33 816.583 1849.23 814.311 Q1848.43 814.311 1848.08 814.288 Q1847.75 814.264 1847.09 814.124 Q1846.44 813.96 1845.52 813.608 Q1843.39 812.882 1842.5 812.882 Q1842.27 812.882 1842.01 812.906 Q1841.75 812.929 1841.17 813.046 Q1840.61 813.163 1840.14 813.398 Q1839.67 813.608 1839.18 814.077 Q1838.69 814.522 1838.43 815.131 Q1838.36 815.318 1838.31 815.412 Q1838.26 815.506 1838.12 815.599 Q1838.01 815.669 1837.82 815.669 Q1837.54 815.669 1837.37 815.506 Q1837.23 815.342 1837.23 815.131 Q1837.23 814.709 1837.65 813.843 Q1838.08 812.976 1838.78 812.039 Q1839.48 811.079 1840.63 810.376 Q1841.78 809.673 1843.04 809.673 Q1843.79 809.673 1844.42 810.001 Q1845.08 810.329 1845.41 810.681 Q1845.76 811.008 1846.34 811.735 Q1846.84 812.297 1847.07 812.531 Q1847.3 812.765 1847.77 813.023 Q1848.27 813.257 1848.8 813.257 Q1849.69 813.257 1850.51 812.578 Q1851.33 811.875 1852.39 810.189 Q1852.67 809.673 1853.11 809.673 Q1853.63 809.673 1853.63 810.142 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M1858.55 839.376 L1858.55 838.343 L1868.86 822.587 Q1869.12 822.177 1869.53 822.193 Q1869.91 822.193 1869.99 822.341 Q1870.07 822.488 1870.07 823.062 L1870.07 838.343 L1873.44 838.343 L1873.44 839.376 L1870.07 839.376 L1870.07 842.294 Q1870.07 843.262 1870.47 843.573 Q1870.88 843.885 1872.62 843.885 L1873.32 843.885 L1873.32 844.918 Q1871.94 844.819 1868.76 844.819 Q1865.6 844.819 1864.22 844.918 L1864.22 843.885 L1864.93 843.885 Q1866.66 843.885 1867.07 843.59 Q1867.48 843.278 1867.48 842.294 L1867.48 839.376 L1858.55 839.376 M1859.5 838.343 L1867.68 838.343 L1867.68 825.817 L1859.5 838.343 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip140)" style="stroke:#3da44d; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1703.19,879.239 1814.71,879.239 "></polyline>
<path clip-path="url(#clip140)" d="M1853.63 861.729 Q1853.63 861.893 1853.23 862.596 Q1852.86 863.275 1851.47 864.985 Q1850.09 866.695 1848.03 868.686 Q1847.26 869.459 1846.09 870.536 Q1844.92 871.614 1844.12 872.316 L1843.32 873.019 Q1840.28 875.595 1837.61 878.476 Q1837.8 878.406 1838.12 878.383 Q1838.45 878.336 1838.69 878.336 L1838.92 878.336 Q1840.14 878.336 1842.27 879.156 Q1844.14 879.765 1845.1 879.765 Q1846.04 879.765 1847.07 879.437 Q1848.1 879.109 1849.23 878.148 Q1850.35 877.188 1850.86 875.736 Q1850.96 875.502 1851.01 875.431 Q1851.05 875.338 1851.19 875.244 Q1851.33 875.127 1851.52 875.127 Q1851.78 875.127 1851.94 875.267 Q1852.11 875.408 1852.11 875.595 Q1852.11 876.017 1851.78 876.86 Q1851.47 877.703 1850.79 878.757 Q1850.14 879.811 1849.27 880.772 Q1848.43 881.709 1847.16 882.364 Q1845.9 882.997 1844.56 882.997 Q1843.6 882.997 1842.9 882.528 Q1842.2 882.083 1841.5 881.217 Q1840.54 880.116 1840.02 879.765 Q1839.51 879.39 1838.71 879.39 Q1836.58 879.39 1834.63 882.364 Q1834.42 882.786 1834.28 882.88 Q1834.16 882.997 1833.88 882.997 Q1833.3 882.973 1833.3 882.505 Q1833.3 882.318 1833.81 881.498 Q1834.35 880.655 1835.55 879.179 Q1836.76 877.703 1838.24 876.228 L1842.55 872.199 Q1847.33 868.17 1849.23 865.899 Q1848.43 865.899 1848.08 865.875 Q1847.75 865.852 1847.09 865.711 Q1846.44 865.547 1845.52 865.196 Q1843.39 864.47 1842.5 864.47 Q1842.27 864.47 1842.01 864.493 Q1841.75 864.517 1841.17 864.634 Q1840.61 864.751 1840.14 864.985 Q1839.67 865.196 1839.18 865.664 Q1838.69 866.109 1838.43 866.718 Q1838.36 866.906 1838.31 866.999 Q1838.26 867.093 1838.12 867.187 Q1838.01 867.257 1837.82 867.257 Q1837.54 867.257 1837.37 867.093 Q1837.23 866.929 1837.23 866.718 Q1837.23 866.297 1837.65 865.43 Q1838.08 864.563 1838.78 863.627 Q1839.48 862.666 1840.63 861.964 Q1841.78 861.261 1843.04 861.261 Q1843.79 861.261 1844.42 861.589 Q1845.08 861.917 1845.41 862.268 Q1845.76 862.596 1846.34 863.322 Q1846.84 863.884 1847.07 864.118 Q1847.3 864.353 1847.77 864.61 Q1848.27 864.845 1848.8 864.845 Q1849.69 864.845 1850.51 864.165 Q1851.33 863.463 1852.39 861.776 Q1852.67 861.261 1853.11 861.261 Q1853.63 861.261 1853.63 861.729 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M1858.55 891.756 Q1858.55 890.756 1859.12 890.28 Q1859.7 889.805 1860.43 889.805 Q1861.2 889.805 1861.75 890.313 Q1862.3 890.805 1862.3 891.674 Q1862.3 892.608 1861.65 893.133 Q1861.01 893.658 1860.09 893.527 Q1860.89 894.871 1862.37 895.478 Q1863.86 896.084 1865.24 896.084 Q1866.68 896.084 1867.84 894.838 Q1869.03 893.592 1869.03 890.543 Q1869.03 887.952 1868.01 886.46 Q1867.01 884.968 1865.02 884.968 L1863.55 884.968 Q1863.04 884.968 1862.89 884.919 Q1862.75 884.87 1862.75 884.591 Q1862.75 884.263 1863.25 884.197 Q1863.76 884.197 1864.57 884.099 Q1866.52 884.033 1867.55 882.345 Q1868.48 880.771 1868.48 878.525 Q1868.48 876.475 1867.5 875.623 Q1866.53 874.754 1865.27 874.754 Q1864.09 874.754 1862.79 875.245 Q1861.5 875.737 1860.79 876.836 Q1862.88 876.836 1862.88 878.525 Q1862.88 879.262 1862.4 879.754 Q1861.94 880.23 1861.17 880.23 Q1860.43 880.23 1859.94 879.771 Q1859.45 879.295 1859.45 878.492 Q1859.45 876.573 1861.16 875.245 Q1862.88 873.917 1865.4 873.917 Q1867.89 873.917 1869.73 875.229 Q1871.58 876.541 1871.58 878.557 Q1871.58 880.541 1870.27 882.164 Q1868.96 883.788 1866.88 884.46 Q1869.44 884.968 1870.96 886.706 Q1872.48 888.428 1872.48 890.543 Q1872.48 893.166 1870.42 895.101 Q1868.35 897.019 1865.34 897.019 Q1862.55 897.019 1860.55 895.51 Q1858.55 894.002 1858.55 891.756 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip140)" style="stroke:#c271d2; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1703.19,931.079 1814.71,931.079 "></polyline>
<path clip-path="url(#clip140)" d="M1853.63 913.934 Q1853.63 914.098 1853.23 914.801 Q1852.86 915.48 1851.47 917.19 Q1850.09 918.899 1848.03 920.89 Q1847.26 921.663 1846.09 922.741 Q1844.92 923.818 1844.12 924.521 L1843.32 925.224 Q1840.28 927.8 1837.61 930.681 Q1837.8 930.611 1838.12 930.587 Q1838.45 930.54 1838.69 930.54 L1838.92 930.54 Q1840.14 930.54 1842.27 931.36 Q1844.14 931.969 1845.1 931.969 Q1846.04 931.969 1847.07 931.641 Q1848.1 931.313 1849.23 930.353 Q1850.35 929.393 1850.86 927.941 Q1850.96 927.706 1851.01 927.636 Q1851.05 927.542 1851.19 927.449 Q1851.33 927.332 1851.52 927.332 Q1851.78 927.332 1851.94 927.472 Q1852.11 927.613 1852.11 927.8 Q1852.11 928.222 1851.78 929.065 Q1851.47 929.908 1850.79 930.962 Q1850.14 932.016 1849.27 932.976 Q1848.43 933.913 1847.16 934.569 Q1845.9 935.201 1844.56 935.201 Q1843.6 935.201 1842.9 934.733 Q1842.2 934.288 1841.5 933.421 Q1840.54 932.321 1840.02 931.969 Q1839.51 931.594 1838.71 931.594 Q1836.58 931.594 1834.63 934.569 Q1834.42 934.991 1834.28 935.084 Q1834.16 935.201 1833.88 935.201 Q1833.3 935.178 1833.3 934.71 Q1833.3 934.522 1833.81 933.702 Q1834.35 932.859 1835.55 931.384 Q1836.76 929.908 1838.24 928.432 L1842.55 924.404 Q1847.33 920.375 1849.23 918.103 Q1848.43 918.103 1848.08 918.08 Q1847.75 918.056 1847.09 917.916 Q1846.44 917.752 1845.52 917.4 Q1843.39 916.674 1842.5 916.674 Q1842.27 916.674 1842.01 916.698 Q1841.75 916.721 1841.17 916.838 Q1840.61 916.955 1840.14 917.19 Q1839.67 917.4 1839.18 917.869 Q1838.69 918.314 1838.43 918.923 Q1838.36 919.11 1838.31 919.204 Q1838.26 919.298 1838.12 919.391 Q1838.01 919.462 1837.82 919.462 Q1837.54 919.462 1837.37 919.298 Q1837.23 919.134 1837.23 918.923 Q1837.23 918.501 1837.65 917.635 Q1838.08 916.768 1838.78 915.831 Q1839.48 914.871 1840.63 914.168 Q1841.78 913.465 1843.04 913.465 Q1843.79 913.465 1844.42 913.793 Q1845.08 914.121 1845.41 914.473 Q1845.76 914.801 1846.34 915.527 Q1846.84 916.089 1847.07 916.323 Q1847.3 916.557 1847.77 916.815 Q1848.27 917.049 1848.8 917.049 Q1849.69 917.049 1850.51 916.37 Q1851.33 915.667 1852.39 913.981 Q1852.67 913.465 1853.11 913.465 Q1853.63 913.465 1853.63 913.934 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M1858.55 948.486 Q1858.55 947.879 1858.6 947.699 Q1858.66 947.518 1858.93 947.24 L1865.37 940.058 Q1868.89 936.091 1868.89 932.631 Q1868.89 930.385 1867.71 928.778 Q1866.55 927.171 1864.4 927.171 Q1862.93 927.171 1861.68 928.073 Q1860.43 928.975 1859.86 930.582 Q1859.96 930.549 1860.3 930.549 Q1861.14 930.549 1861.6 931.073 Q1862.07 931.598 1862.07 932.303 Q1862.07 933.205 1861.48 933.648 Q1860.91 934.074 1860.34 934.074 Q1860.11 934.074 1859.79 934.025 Q1859.5 933.975 1859.02 933.516 Q1858.55 933.041 1858.55 932.205 Q1858.55 929.86 1860.32 927.991 Q1862.11 926.122 1864.83 926.122 Q1867.91 926.122 1869.93 927.958 Q1871.96 929.778 1871.96 932.631 Q1871.96 933.631 1871.65 934.549 Q1871.35 935.451 1870.94 936.156 Q1870.55 936.861 1869.47 937.992 Q1868.39 939.124 1867.52 939.927 Q1866.65 940.731 1864.7 942.436 L1861.14 945.895 L1867.19 945.895 Q1870.14 945.895 1870.37 945.633 Q1870.7 945.157 1871.11 942.649 L1871.96 942.649 L1871.01 948.486 L1858.55 948.486 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip140)" style="stroke:#ac8d18; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1703.19,982.919 1814.71,982.919 "></polyline>
<path clip-path="url(#clip140)" d="M1853.63 965.774 Q1853.63 965.938 1853.23 966.641 Q1852.86 967.32 1851.47 969.03 Q1850.09 970.739 1848.03 972.73 Q1847.26 973.503 1846.09 974.581 Q1844.92 975.658 1844.12 976.361 L1843.32 977.064 Q1840.28 979.64 1837.61 982.521 Q1837.8 982.451 1838.12 982.427 Q1838.45 982.38 1838.69 982.38 L1838.92 982.38 Q1840.14 982.38 1842.27 983.2 Q1844.14 983.809 1845.1 983.809 Q1846.04 983.809 1847.07 983.481 Q1848.1 983.153 1849.23 982.193 Q1850.35 981.233 1850.86 979.781 Q1850.96 979.546 1851.01 979.476 Q1851.05 979.382 1851.19 979.289 Q1851.33 979.172 1851.52 979.172 Q1851.78 979.172 1851.94 979.312 Q1852.11 979.453 1852.11 979.64 Q1852.11 980.062 1851.78 980.905 Q1851.47 981.748 1850.79 982.802 Q1850.14 983.856 1849.27 984.816 Q1848.43 985.753 1847.16 986.409 Q1845.9 987.041 1844.56 987.041 Q1843.6 987.041 1842.9 986.573 Q1842.2 986.128 1841.5 985.261 Q1840.54 984.161 1840.02 983.809 Q1839.51 983.434 1838.71 983.434 Q1836.58 983.434 1834.63 986.409 Q1834.42 986.831 1834.28 986.924 Q1834.16 987.041 1833.88 987.041 Q1833.3 987.018 1833.3 986.55 Q1833.3 986.362 1833.81 985.542 Q1834.35 984.699 1835.55 983.224 Q1836.76 981.748 1838.24 980.272 L1842.55 976.244 Q1847.33 972.215 1849.23 969.943 Q1848.43 969.943 1848.08 969.92 Q1847.75 969.896 1847.09 969.756 Q1846.44 969.592 1845.52 969.24 Q1843.39 968.514 1842.5 968.514 Q1842.27 968.514 1842.01 968.538 Q1841.75 968.561 1841.17 968.678 Q1840.61 968.795 1840.14 969.03 Q1839.67 969.24 1839.18 969.709 Q1838.69 970.154 1838.43 970.763 Q1838.36 970.95 1838.31 971.044 Q1838.26 971.138 1838.12 971.231 Q1838.01 971.302 1837.82 971.302 Q1837.54 971.302 1837.37 971.138 Q1837.23 970.974 1837.23 970.763 Q1837.23 970.341 1837.65 969.475 Q1838.08 968.608 1838.78 967.671 Q1839.48 966.711 1840.63 966.008 Q1841.78 965.305 1843.04 965.305 Q1843.79 965.305 1844.42 965.633 Q1845.08 965.961 1845.41 966.313 Q1845.76 966.641 1846.34 967.367 Q1846.84 967.929 1847.07 968.163 Q1847.3 968.397 1847.77 968.655 Q1848.27 968.889 1848.8 968.889 Q1849.69 968.889 1850.51 968.21 Q1851.33 967.507 1852.39 965.821 Q1852.67 965.305 1853.11 965.305 Q1853.63 965.305 1853.63 965.774 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M1858.55 981.159 L1858.55 980.11 Q1862.58 980.11 1864.66 977.962 Q1865.24 977.962 1865.34 978.093 Q1865.43 978.224 1865.43 978.831 L1865.43 997.67 Q1865.43 998.67 1865.93 998.981 Q1866.42 999.293 1868.57 999.293 L1869.63 999.293 L1869.63 1000.33 Q1868.45 1000.23 1864.19 1000.23 Q1859.93 1000.23 1858.76 1000.33 L1858.76 999.293 L1859.83 999.293 Q1861.94 999.293 1862.45 998.998 Q1862.96 998.686 1862.96 997.67 L1862.96 980.274 Q1861.2 981.159 1858.55 981.159 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path></svg>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-model-stochastic-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7: Value Function of Stochastic Model.
</figcaption>
</figure>
</div>
</div>
<div class="{refs}">

</div>


<!-- -->


</section>
</section>


<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-tauchen1986" class="csl-entry" role="listitem">
Tauchen, George. 1986. <span>“Finite State Markov-Chain Approximations to Univariate and Vector Autoregressions.”</span> <em>Economics Letters</em> 20 (2): 177–81. <a href="https://doi.org/10.1016/0165-1765(86)90168-0">https://doi.org/10.1016/0165-1765(86)90168-0</a>.
</div>
<div id="ref-kitao2024" class="csl-entry" role="listitem">
北尾早霧, 砂川武貴, and 山田知明. 2024. <em><span>定量的マクロ経済学と数値計算</span></em>. 日本評論社.
</div>
</div></section><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>線形補間では一階微分までしかとれませんが, スプライン補間を用いれば二階微分が取れるので, derivative-based な最適化手法も使えます. ここでは1変数関数なので, bracketing method のような微分のいらない手法を用いています.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/kazuyanagimoto\.github\.io\/course-kobe-macro4-2025\/");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb34" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> 動学モデルの基礎</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> 2025-10-20</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="an">engine:</span><span class="co"> julia</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a><span class="in">```{julia}</span></span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: setup</span></span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: false</span></span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Plots</span></span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">LaTeXStrings</span></span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Distributions</span></span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> <span class="bu">Random</span></span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Roots</span></span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Optim</span></span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">LinearAlgebra</span></span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Interpolations</span></span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">SpecialFunctions</span></span>
<span id="cb34-24"><a href="#cb34-24" aria-hidden="true" tabindex="-1"></a><span class="fu">default</span>(size<span class="op">=</span>(<span class="fl">500</span>, <span class="fl">309</span>), titlefontsize<span class="op">=</span><span class="fl">10</span>, fmt<span class="op">=:</span>svg)</span>
<span id="cb34-25"><a href="#cb34-25" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb34-26"><a href="#cb34-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-27"><a href="#cb34-27" aria-hidden="true" tabindex="-1"></a><span class="fu">## グリッドと補完</span></span>
<span id="cb34-28"><a href="#cb34-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-29"><a href="#cb34-29" aria-hidden="true" tabindex="-1"></a>未知なる関数 $f(x)$ の一般形が分からないが, 具体的な $x$ に関しては $f(x)$ の値が計算できる状況というのがよくあります. ちょっと極端な例を考えてみましょう. 次の効用最大化問題を考えます.</span>
<span id="cb34-30"><a href="#cb34-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-31"><a href="#cb34-31" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb34-32"><a href="#cb34-32" aria-hidden="true" tabindex="-1"></a>\max_{n} \log c - \Phi(n) \text{ s.t.　}　c = w n.</span>
<span id="cb34-33"><a href="#cb34-33" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb34-34"><a href="#cb34-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-35"><a href="#cb34-35" aria-hidden="true" tabindex="-1"></a>ここで, 労働供給の不効用 $\Phi(n) = \phi \log (n!)$ とします. この時の最適な $n^*$ を求めてみましょう.</span>
<span id="cb34-36"><a href="#cb34-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-39"><a href="#cb34-39" aria-hidden="true" tabindex="-1"></a><span class="in">```{julia}</span></span>
<span id="cb34-40"><a href="#cb34-40" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: define-profit-integer</span></span>
<span id="cb34-41"><a href="#cb34-41" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: false</span></span>
<span id="cb34-42"><a href="#cb34-42" aria-hidden="true" tabindex="-1"></a><span class="fu">Φ</span>(n<span class="op">::</span><span class="dt">Int</span>; ϕ<span class="op">=</span><span class="fl">0.1</span>) <span class="op">=</span> ϕ <span class="op">*</span> <span class="fu">sum</span>(<span class="fu">log</span>(i) <span class="cf">for</span> i <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span>n)</span>
<span id="cb34-43"><a href="#cb34-43" aria-hidden="true" tabindex="-1"></a><span class="fu">u</span>(n<span class="op">::</span><span class="dt">Int</span>; w<span class="op">=</span><span class="fl">1</span>.) <span class="op">=</span> <span class="fu">log</span>(n) <span class="op">-</span> <span class="fu">Φ</span>(n)</span>
<span id="cb34-44"><a href="#cb34-44" aria-hidden="true" tabindex="-1"></a><span class="ss">```</span></span>
<span id="cb34-45"><a href="#cb34-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-46"><a href="#cb34-46" aria-hidden="true" tabindex="-1"></a><span class="ss">**Grid Search**</span></span>
<span id="cb34-47"><a href="#cb34-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-48"><a href="#cb34-48" aria-hidden="true" tabindex="-1"></a><span class="ss">最も単純な方法は, $n = 1, \dots, 10$ ぐらいまで試してみて, 最も効用 $u(c, n)$ が大きくなる $n$ を選ぶ方法です. これをグリッドサーチと呼びます.</span></span>
<span id="cb34-49"><a href="#cb34-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-52"><a href="#cb34-52" aria-hidden="true" tabindex="-1"></a><span class="in">```{julia}</span></span>
<span id="cb34-53"><a href="#cb34-53" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-grid-search</span></span>
<span id="cb34-54"><a href="#cb34-54" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Grid Search for Optimal n. $ϕ = 0.1$."</span></span>
<span id="cb34-55"><a href="#cb34-55" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb34-56"><a href="#cb34-56" aria-hidden="true" tabindex="-1"></a><span class="fu">scatter</span>(<span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, u, label<span class="op">=</span><span class="cn">false</span>, xlabel<span class="op">=</span>L<span class="st">"n"</span>, ylabel<span class="op">=</span>L<span class="st">"u(c, n)"</span>)</span>
<span id="cb34-57"><a href="#cb34-57" aria-hidden="true" tabindex="-1"></a><span class="ss">```</span></span>
<span id="cb34-58"><a href="#cb34-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-61"><a href="#cb34-61" aria-hidden="true" tabindex="-1"></a><span class="in">```{julia}</span></span>
<span id="cb34-62"><a href="#cb34-62" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: grid-search</span></span>
<span id="cb34-63"><a href="#cb34-63" aria-hidden="true" tabindex="-1"></a><span class="fu">argmax</span>(u, <span class="fl">1</span><span class="op">:</span><span class="fl">10</span>)</span>
<span id="cb34-64"><a href="#cb34-64" aria-hidden="true" tabindex="-1"></a><span class="ss">```</span></span>
<span id="cb34-65"><a href="#cb34-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-66"><a href="#cb34-66" aria-hidden="true" tabindex="-1"></a><span class="ss">**補完 (Interpolation)**</span></span>
<span id="cb34-67"><a href="#cb34-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-68"><a href="#cb34-68" aria-hidden="true" tabindex="-1"></a><span class="ss">これを実数の世界に拡張してみましょう. もし, $n$ が実数の時の $\Phi(n)$ の値が計算できれば, 通常の一変数関数の最大化問題として解くことができます. そのために, $\Phi(n)$ を補完 (interpolation) してみましょう. Juliaでは `Interpolations.jl` パッケージを用います.</span></span>
<span id="cb34-69"><a href="#cb34-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-72"><a href="#cb34-72" aria-hidden="true" tabindex="-1"></a><span class="in">```{julia}</span></span>
<span id="cb34-73"><a href="#cb34-73" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: define-profit-interp</span></span>
<span id="cb34-74"><a href="#cb34-74" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: false</span></span>
<span id="cb34-75"><a href="#cb34-75" aria-hidden="true" tabindex="-1"></a>n_grid <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span></span>
<span id="cb34-76"><a href="#cb34-76" aria-hidden="true" tabindex="-1"></a>Φ_grid <span class="op">=</span> <span class="fu">Φ</span>.(n_grid)</span>
<span id="cb34-77"><a href="#cb34-77" aria-hidden="true" tabindex="-1"></a>Φ_interp <span class="op">=</span> <span class="fu">linear_interpolation</span>(n_grid, Φ_grid)</span>
<span id="cb34-78"><a href="#cb34-78" aria-hidden="true" tabindex="-1"></a>Φ_spline <span class="op">=</span> Interpolations.<span class="fu">scale</span>(</span>
<span id="cb34-79"><a href="#cb34-79" aria-hidden="true" tabindex="-1"></a>    <span class="fu">interpolate</span>(Φ_grid, <span class="fu">BSpline</span>(<span class="fu">Cubic</span>(<span class="fu">Line</span>(<span class="fu">OnGrid</span>())))),</span>
<span id="cb34-80"><a href="#cb34-80" aria-hidden="true" tabindex="-1"></a>    n_grid</span>
<span id="cb34-81"><a href="#cb34-81" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb34-82"><a href="#cb34-82" aria-hidden="true" tabindex="-1"></a><span class="ss">```</span></span>
<span id="cb34-83"><a href="#cb34-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-86"><a href="#cb34-86" aria-hidden="true" tabindex="-1"></a><span class="in">```{julia}</span></span>
<span id="cb34-87"><a href="#cb34-87" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-interpolation</span></span>
<span id="cb34-88"><a href="#cb34-88" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Linear and Spline Interpolation of Cost Function $\\Phi(n)$."</span></span>
<span id="cb34-89"><a href="#cb34-89" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb34-90"><a href="#cb34-90" aria-hidden="true" tabindex="-1"></a><span class="fu">scatter</span>(<span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, Φ, label<span class="op">=</span><span class="st">"Grid Points"</span>, xlabel<span class="op">=</span>L<span class="st">"n"</span>, ylabel<span class="op">=</span>L<span class="st">"\Phi(n)"</span>)</span>
<span id="cb34-91"><a href="#cb34-91" aria-hidden="true" tabindex="-1"></a><span class="fu">plot!</span>(<span class="fl">1</span><span class="op">:</span><span class="fl">0.1</span><span class="op">:</span><span class="fl">10</span>, n <span class="op">-&gt;</span> <span class="fu">Φ_interp</span>(n), label<span class="op">=</span><span class="st">"Linear Interpolation"</span>, legend<span class="op">=:</span>topleft)</span>
<span id="cb34-92"><a href="#cb34-92" aria-hidden="true" tabindex="-1"></a><span class="fu">plot!</span>(<span class="fl">1</span><span class="op">:</span><span class="fl">0.1</span><span class="op">:</span><span class="fl">10</span>, n <span class="op">-&gt;</span> <span class="fu">Φ_spline</span>(n), label<span class="op">=</span><span class="st">"Cubic Spline"</span>, linestyle<span class="op">=:</span>dash)</span>
<span id="cb34-93"><a href="#cb34-93" aria-hidden="true" tabindex="-1"></a><span class="ss">```</span></span>
<span id="cb34-94"><a href="#cb34-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-95"><a href="#cb34-95" aria-hidden="true" tabindex="-1"></a><span class="ss">ここでは線形補間 (linear interpolation) と3次スプライン補間 (cubic spline interpolation) の両方を定義しました. 線形補間は2点間を直線で結ぶだけですが, スプライン補間はより滑らかな曲線で補間します. 詳細は @kitao2024 の付録Bが参考になります.</span></span>
<span id="cb34-96"><a href="#cb34-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-97"><a href="#cb34-97" aria-hidden="true" tabindex="-1"></a><span class="ss">このように実数上に定義された関数を用いれば, 通常の最適化問題のように解くことができます.^[線形補間では一階微分までしかとれませんが, スプライン補間を用いれば二階微分が取れるので, derivative-based な最適化手法も使えます. ここでは1変数関数なので, bracketing method のような微分のいらない手法を用いています.]</span></span>
<span id="cb34-98"><a href="#cb34-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-101"><a href="#cb34-101" aria-hidden="true" tabindex="-1"></a><span class="in">```{julia}</span></span>
<span id="cb34-102"><a href="#cb34-102" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: optimization-comparison</span></span>
<span id="cb34-103"><a href="#cb34-103" aria-hidden="true" tabindex="-1"></a><span class="fu">u_interp</span>(n) <span class="op">=</span> <span class="fu">log</span>(n) <span class="op">-</span> <span class="fu">Φ_interp</span>(n)</span>
<span id="cb34-104"><a href="#cb34-104" aria-hidden="true" tabindex="-1"></a><span class="fu">u_spline</span>(n) <span class="op">=</span> <span class="fu">log</span>(n) <span class="op">-</span> <span class="fu">Φ_spline</span>(n)</span>
<span id="cb34-105"><a href="#cb34-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-106"><a href="#cb34-106" aria-hidden="true" tabindex="-1"></a>sol_interp <span class="op">=</span> <span class="fu">optimize</span>(n <span class="op">-&gt;</span> <span class="fu">-u_interp</span>(n), <span class="fl">1.0</span>, <span class="fl">10.0</span>)</span>
<span id="cb34-107"><a href="#cb34-107" aria-hidden="true" tabindex="-1"></a>sol_spline <span class="op">=</span> <span class="fu">optimize</span>(n <span class="op">-&gt;</span> <span class="fu">-u_spline</span>(n), <span class="fl">1.0</span>, <span class="fl">10.0</span>)</span>
<span id="cb34-108"><a href="#cb34-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-109"><a href="#cb34-109" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>(<span class="st">"Linear Interpolation: n = </span><span class="sc">$</span>(<span class="fu">round</span>(sol_interp.minimizer, digits<span class="op">=</span><span class="fl">4</span>))<span class="st">"</span>)</span>
<span id="cb34-110"><a href="#cb34-110" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>(<span class="st">"Cubic Spline: n = </span><span class="sc">$</span>(<span class="fu">round</span>(sol_spline.minimizer, digits<span class="op">=</span><span class="fl">4</span>))<span class="st">"</span>)</span>
<span id="cb34-111"><a href="#cb34-111" aria-hidden="true" tabindex="-1"></a><span class="ss">```</span></span>
<span id="cb34-112"><a href="#cb34-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-113"><a href="#cb34-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-114"><a href="#cb34-114" aria-hidden="true" tabindex="-1"></a><span class="ss">今回の例では, 階乗は[ガンマ関数](https://ja.wikipedia.org/wiki/%E3%82%AC%E3%83%B3%E3%83%9E%E9%96%A2%E6%95%B0) を用いて実数に拡張できるので, より厳密な解を求めることもできます.</span></span>
<span id="cb34-115"><a href="#cb34-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-118"><a href="#cb34-118" aria-hidden="true" tabindex="-1"></a><span class="in">```{julia}</span></span>
<span id="cb34-119"><a href="#cb34-119" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: analytical-solution</span></span>
<span id="cb34-120"><a href="#cb34-120" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb34-121"><a href="#cb34-121" aria-hidden="true" tabindex="-1"></a><span class="fu">Φ</span>(n<span class="op">::</span><span class="dt">Real</span>; ϕ<span class="op">=</span><span class="fl">0.1</span>) <span class="op">=</span> ϕ <span class="op">*</span> <span class="fu">loggamma</span>(n <span class="op">+</span> <span class="fl">1</span>)</span>
<span id="cb34-122"><a href="#cb34-122" aria-hidden="true" tabindex="-1"></a><span class="fu">u_exact</span>(n) <span class="op">=</span> <span class="fu">log</span>(n) <span class="op">-</span> <span class="fu">Φ</span>(n)</span>
<span id="cb34-123"><a href="#cb34-123" aria-hidden="true" tabindex="-1"></a>sol_exact <span class="op">=</span> <span class="fu">optimize</span>(n <span class="op">-&gt;</span> <span class="fu">-u_exact</span>(n), <span class="fl">1.0</span>, <span class="fl">10.0</span>)</span>
<span id="cb34-124"><a href="#cb34-124" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>(<span class="st">"Exact Solution: n = </span><span class="sc">$</span>(<span class="fu">round</span>(sol_exact.minimizer, digits<span class="op">=</span><span class="fl">4</span>))<span class="st">"</span>)</span>
<span id="cb34-125"><a href="#cb34-125" aria-hidden="true" tabindex="-1"></a><span class="ss">```</span></span>
<span id="cb34-126"><a href="#cb34-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-127"><a href="#cb34-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-128"><a href="#cb34-128" aria-hidden="true" tabindex="-1"></a><span class="ss">## ベルマン方程式の数値解法</span></span>
<span id="cb34-129"><a href="#cb34-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-130"><a href="#cb34-130" aria-hidden="true" tabindex="-1"></a><span class="ss">以下の無限期間代表的個人のモデルを考えます.</span></span>
<span id="cb34-131"><a href="#cb34-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-132"><a href="#cb34-132" aria-hidden="true" tabindex="-1"></a><span class="ss">$$</span></span>
<span id="cb34-133"><a href="#cb34-133" aria-hidden="true" tabindex="-1"></a><span class="ss">\max_{\{c_t, k_{t+1}\}_{t=0}^{\infty}} \sum_{t=0}^{\infty} </span><span class="sc">\b</span><span class="ss">eta^t u(c_t) \quad </span><span class="sc">\t</span><span class="ss">ext{s.t.} \quad c_t + k_{t+1} = f(k_t) + (1-\delta)k_t.</span></span>
<span id="cb34-134"><a href="#cb34-134" aria-hidden="true" tabindex="-1"></a><span class="ss">$$</span></span>
<span id="cb34-135"><a href="#cb34-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-136"><a href="#cb34-136" aria-hidden="true" tabindex="-1"></a><span class="ss">これをベルマン方程式 $V(k)$ に書き換えた時の数値解法を考えます.</span></span>
<span id="cb34-137"><a href="#cb34-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-138"><a href="#cb34-138" aria-hidden="true" tabindex="-1"></a><span class="ss">$$</span></span>
<span id="cb34-139"><a href="#cb34-139" aria-hidden="true" tabindex="-1"></a><span class="ss">V(k) = \max_{k'} \left\{u(f(k) + (1-\delta)k - k') + </span><span class="sc">\b</span><span class="ss">eta V(k')</span><span class="sc">\r</span><span class="ss">ight\}</span></span>
<span id="cb34-140"><a href="#cb34-140" aria-hidden="true" tabindex="-1"></a><span class="ss">$$</span></span>
<span id="cb34-141"><a href="#cb34-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-142"><a href="#cb34-142" aria-hidden="true" tabindex="-1"></a><span class="ss">大きく分けて, 2つの方法があります.</span></span>
<span id="cb34-143"><a href="#cb34-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-144"><a href="#cb34-144" aria-hidden="true" tabindex="-1"></a><span class="ss">1. **Value Function Iteration**</span></span>
<span id="cb34-145"><a href="#cb34-145" aria-hidden="true" tabindex="-1"></a><span class="ss">    - ベルマン方程式の不動点を直接求める方法</span></span>
<span id="cb34-146"><a href="#cb34-146" aria-hidden="true" tabindex="-1"></a><span class="ss">    - 収束性が保証されているが, 収束速度は比較的遅い</span></span>
<span id="cb34-147"><a href="#cb34-147" aria-hidden="true" tabindex="-1"></a><span class="ss">2. **Policy Function Iteration**</span></span>
<span id="cb34-148"><a href="#cb34-148" aria-hidden="true" tabindex="-1"></a><span class="ss">    - 政策関数の不動点を求める方法</span></span>
<span id="cb34-149"><a href="#cb34-149" aria-hidden="true" tabindex="-1"></a><span class="ss">    - 収束性は保証されていないが, 収束速度は比較的速い</span></span>
<span id="cb34-150"><a href="#cb34-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-151"><a href="#cb34-151" aria-hidden="true" tabindex="-1"></a><span class="ss">数値計算に用いるために, 以下の関数形とパラメータを仮定します.</span></span>
<span id="cb34-152"><a href="#cb34-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-153"><a href="#cb34-153" aria-hidden="true" tabindex="-1"></a><span class="ss">- $u(c) = \log c$</span></span>
<span id="cb34-154"><a href="#cb34-154" aria-hidden="true" tabindex="-1"></a><span class="ss">- $f(k) = k^</span><span class="sc">\a</span><span class="ss">lpha$</span></span>
<span id="cb34-155"><a href="#cb34-155" aria-hidden="true" tabindex="-1"></a><span class="ss">- $</span><span class="sc">\b</span><span class="ss">eta = 0.96$</span></span>
<span id="cb34-156"><a href="#cb34-156" aria-hidden="true" tabindex="-1"></a><span class="ss">- $\delta = 0.1$</span></span>
<span id="cb34-157"><a href="#cb34-157" aria-hidden="true" tabindex="-1"></a><span class="ss">- $</span><span class="sc">\a</span><span class="ss">lpha = 0.36$</span></span>
<span id="cb34-158"><a href="#cb34-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-161"><a href="#cb34-161" aria-hidden="true" tabindex="-1"></a><span class="in">```{julia}</span></span>
<span id="cb34-162"><a href="#cb34-162" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: model-deterministic</span></span>
<span id="cb34-163"><a href="#cb34-163" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: false</span></span>
<span id="cb34-164"><a href="#cb34-164" aria-hidden="true" tabindex="-1"></a><span class="pp">@kwdef</span> <span class="kw">struct</span> Model{TF<span class="op">&lt;:</span><span class="dt">AbstractFloat</span>,TI<span class="op">&lt;:</span><span class="dt">Integer</span>}</span>
<span id="cb34-165"><a href="#cb34-165" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Parameters</span></span>
<span id="cb34-166"><a href="#cb34-166" aria-hidden="true" tabindex="-1"></a>    α<span class="op">::</span><span class="dt">TF </span><span class="op">=</span> <span class="fl">0.4</span></span>
<span id="cb34-167"><a href="#cb34-167" aria-hidden="true" tabindex="-1"></a>    β<span class="op">::</span><span class="dt">TF </span><span class="op">=</span> <span class="fl">0.96</span></span>
<span id="cb34-168"><a href="#cb34-168" aria-hidden="true" tabindex="-1"></a>    δ<span class="op">::</span><span class="dt">TF </span><span class="op">=</span> <span class="fl">0.1</span></span>
<span id="cb34-169"><a href="#cb34-169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-170"><a href="#cb34-170" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Value Function</span></span>
<span id="cb34-171"><a href="#cb34-171" aria-hidden="true" tabindex="-1"></a>    n_k<span class="op">::</span><span class="dt">TI </span><span class="op">=</span> <span class="fl">101</span></span>
<span id="cb34-172"><a href="#cb34-172" aria-hidden="true" tabindex="-1"></a>    k_min<span class="op">::</span><span class="dt">TF </span><span class="op">=</span> <span class="fl">0.05</span></span>
<span id="cb34-173"><a href="#cb34-173" aria-hidden="true" tabindex="-1"></a>    k_max<span class="op">::</span><span class="dt">TF </span><span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb34-174"><a href="#cb34-174" aria-hidden="true" tabindex="-1"></a>    k_grid<span class="op">::</span><span class="dt">Vector{TF} </span><span class="op">=</span> <span class="fu">collect</span>(<span class="fu">range</span>(k_min, k_max, length<span class="op">=</span>n_k))</span>
<span id="cb34-175"><a href="#cb34-175" aria-hidden="true" tabindex="-1"></a>    V<span class="op">::</span><span class="dt">Vector{TF} </span><span class="op">=</span> <span class="fu">zeros</span>(n_k)</span>
<span id="cb34-176"><a href="#cb34-176" aria-hidden="true" tabindex="-1"></a>    h<span class="op">::</span><span class="dt">Vector{TF} </span><span class="op">=</span> <span class="fu">copy</span>(k_grid)</span>
<span id="cb34-177"><a href="#cb34-177" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb34-178"><a href="#cb34-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-179"><a href="#cb34-179" aria-hidden="true" tabindex="-1"></a><span class="fu">u</span>(c; m) <span class="op">=</span> <span class="fu">log</span>(c)</span>
<span id="cb34-180"><a href="#cb34-180" aria-hidden="true" tabindex="-1"></a><span class="fu">u′</span>(c; m) <span class="op">=</span> <span class="fl">1</span> <span class="op">/</span> c</span>
<span id="cb34-181"><a href="#cb34-181" aria-hidden="true" tabindex="-1"></a><span class="fu">f</span>(k; m) <span class="op">=</span> k<span class="op">^</span>m.α</span>
<span id="cb34-182"><a href="#cb34-182" aria-hidden="true" tabindex="-1"></a><span class="fu">f′</span>(k; m) <span class="op">=</span> m.α <span class="op">*</span> k<span class="op">^</span>(m.α <span class="op">-</span> <span class="fl">1</span>)</span>
<span id="cb34-183"><a href="#cb34-183" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb34-184"><a href="#cb34-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-185"><a href="#cb34-185" aria-hidden="true" tabindex="-1"></a><span class="fu">### Value Function Iteration</span></span>
<span id="cb34-186"><a href="#cb34-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-187"><a href="#cb34-187" aria-hidden="true" tabindex="-1"></a>::: {.callout-note}</span>
<span id="cb34-188"><a href="#cb34-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-189"><a href="#cb34-189" aria-hidden="true" tabindex="-1"></a><span class="fu">## Value Function Iteration</span></span>
<span id="cb34-190"><a href="#cb34-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-191"><a href="#cb34-191" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>$k$ の定義域を $<span class="co">[</span><span class="ot">k_{\min}, k_{\max}</span><span class="co">]</span>$ を $n$ 個のグリッドポイントに分割する.</span>
<span id="cb34-192"><a href="#cb34-192" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>$V(k)$ の初期値 $V^0$ を適当に設定する. つまり, $V^0 = (V_0^0, V_1^0, \dots, V_n^0)$ に適当な値を設定する.</span>
<span id="cb34-193"><a href="#cb34-193" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>$V^0$ をベルマン方程式の右辺に代入し, 各 $k_i$ に対して $V_i^1$ を計算する.</span>
<span id="cb34-194"><a href="#cb34-194" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>2-3を繰り返す. 収束条件は以下のように設定する.</span>
<span id="cb34-195"><a href="#cb34-195" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>$|V^N - V^{N-1}| &lt; \varepsilon$</span>
<span id="cb34-196"><a href="#cb34-196" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>$|V^N - V^{N-1}|$ はベクトルのノルム</span>
<span id="cb34-197"><a href="#cb34-197" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>$\varepsilon$ は十分小さな値を設定する. 例えば, $\epsilon = 10^{-6}$ とする</span>
<span id="cb34-198"><a href="#cb34-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-199"><a href="#cb34-199" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb34-200"><a href="#cb34-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-201"><a href="#cb34-201" aria-hidden="true" tabindex="-1"></a>なおこのような収束の閾値 $\varepsilon$ を tolerance と呼ぶことがあります.</span>
<span id="cb34-202"><a href="#cb34-202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-205"><a href="#cb34-205" aria-hidden="true" tabindex="-1"></a><span class="in">```{julia}</span></span>
<span id="cb34-206"><a href="#cb34-206" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: value-function-iteration</span></span>
<span id="cb34-207"><a href="#cb34-207" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: false</span></span>
<span id="cb34-208"><a href="#cb34-208" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">vfi!</span>(m<span class="op">::</span><span class="dt">Model</span>; tol<span class="op">=</span><span class="fl">1e-6</span>, max_iter<span class="op">=</span><span class="fl">1000</span>, verbose<span class="op">=</span><span class="cn">true</span>)</span>
<span id="cb34-209"><a href="#cb34-209" aria-hidden="true" tabindex="-1"></a>    (; k_grid, β, δ) <span class="op">=</span> m</span>
<span id="cb34-210"><a href="#cb34-210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-211"><a href="#cb34-211" aria-hidden="true" tabindex="-1"></a>    iter, dist <span class="op">=</span> <span class="fl">0</span>, <span class="cn">Inf</span></span>
<span id="cb34-212"><a href="#cb34-212" aria-hidden="true" tabindex="-1"></a>    V_new <span class="op">=</span> <span class="fu">similar</span>(m.V)</span>
<span id="cb34-213"><a href="#cb34-213" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> dist <span class="op">&gt;</span> tol <span class="op">&amp;&amp;</span> iter <span class="op">&lt;</span> max_iter</span>
<span id="cb34-214"><a href="#cb34-214" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> (i_k, k) <span class="kw">in</span> <span class="fu">enumerate</span>(k_grid)</span>
<span id="cb34-215"><a href="#cb34-215" aria-hidden="true" tabindex="-1"></a>            c_min <span class="op">=</span> <span class="fl">1e-9</span> <span class="co"># consumption cannot be negative</span></span>
<span id="cb34-216"><a href="#cb34-216" aria-hidden="true" tabindex="-1"></a>            V_new[i_k] <span class="op">=</span> <span class="fu">maximum</span>(</span>
<span id="cb34-217"><a href="#cb34-217" aria-hidden="true" tabindex="-1"></a>                <span class="fu">log</span>(<span class="fu">max</span>(<span class="fu">f</span>(k; m) <span class="op">+</span> (<span class="fl">1</span> <span class="op">-</span> δ) <span class="op">*</span> k <span class="op">-</span> k′, c_min)) <span class="op">+</span> β <span class="op">*</span> m.V[i_k′]</span>
<span id="cb34-218"><a href="#cb34-218" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> (i_k′, k′) <span class="kw">in</span> <span class="fu">enumerate</span>(k_grid)</span>
<span id="cb34-219"><a href="#cb34-219" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb34-220"><a href="#cb34-220" aria-hidden="true" tabindex="-1"></a>        <span class="cf">end</span></span>
<span id="cb34-221"><a href="#cb34-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-222"><a href="#cb34-222" aria-hidden="true" tabindex="-1"></a>        dist <span class="op">=</span> <span class="fu">maximum</span>(abs, V_new <span class="op">-</span> m.V)</span>
<span id="cb34-223"><a href="#cb34-223" aria-hidden="true" tabindex="-1"></a>        m.V <span class="op">.=</span> V_new</span>
<span id="cb34-224"><a href="#cb34-224" aria-hidden="true" tabindex="-1"></a>        iter <span class="op">+=</span> <span class="fl">1</span></span>
<span id="cb34-225"><a href="#cb34-225" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb34-226"><a href="#cb34-226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-227"><a href="#cb34-227" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> verbose</span>
<span id="cb34-228"><a href="#cb34-228" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> iter <span class="op">==</span> max_iter</span>
<span id="cb34-229"><a href="#cb34-229" aria-hidden="true" tabindex="-1"></a>            <span class="fu">println</span>(<span class="st">"Warning: Maximum iterations reached."</span>)</span>
<span id="cb34-230"><a href="#cb34-230" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span></span>
<span id="cb34-231"><a href="#cb34-231" aria-hidden="true" tabindex="-1"></a>            <span class="fu">println</span>(<span class="st">"Converged in </span><span class="sc">$</span>iter<span class="st"> iterations."</span>)</span>
<span id="cb34-232"><a href="#cb34-232" aria-hidden="true" tabindex="-1"></a>        <span class="cf">end</span></span>
<span id="cb34-233"><a href="#cb34-233" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb34-234"><a href="#cb34-234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-235"><a href="#cb34-235" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="cn">nothing</span></span>
<span id="cb34-236"><a href="#cb34-236" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb34-237"><a href="#cb34-237" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb34-238"><a href="#cb34-238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-241"><a href="#cb34-241" aria-hidden="true" tabindex="-1"></a><span class="in">```{julia}</span></span>
<span id="cb34-242"><a href="#cb34-242" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-vfi</span></span>
<span id="cb34-243"><a href="#cb34-243" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: Value Function Iteration</span></span>
<span id="cb34-244"><a href="#cb34-244" aria-hidden="true" tabindex="-1"></a>m <span class="op">=</span> <span class="fu">Model</span>()</span>
<span id="cb34-245"><a href="#cb34-245" aria-hidden="true" tabindex="-1"></a><span class="fu">vfi!</span>(m)</span>
<span id="cb34-246"><a href="#cb34-246" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(m.k_grid, m.V, label<span class="op">=</span><span class="cn">false</span>, xlabel<span class="op">=</span>L<span class="st">"Capital </span><span class="sc">$</span>k<span class="sc">$</span><span class="st">", </span>ylabel<span class="st">=L"</span>Value <span class="op">$</span><span class="fu">V</span>(k)<span class="op">$</span><span class="st">")</span></span>
<span id="cb34-247"><a href="#cb34-247" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb34-248"><a href="#cb34-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-249"><a href="#cb34-249" aria-hidden="true" tabindex="-1"></a>なお, 各イタレーションでは, $k$ に対する最適な $k'$ や $c$ を求めています. それらを記録しておくことで, 政策関数 $c = h(k)$ や $k' = g(k)$ を求めることができます.</span>
<span id="cb34-250"><a href="#cb34-250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-251"><a href="#cb34-251" aria-hidden="true" tabindex="-1"></a><span class="fu">### Policy Function Iteration</span></span>
<span id="cb34-252"><a href="#cb34-252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-253"><a href="#cb34-253" aria-hidden="true" tabindex="-1"></a>上記のベルマン方程式から, 以下のオイラー方程式が導出されます.</span>
<span id="cb34-254"><a href="#cb34-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-255"><a href="#cb34-255" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb34-256"><a href="#cb34-256" aria-hidden="true" tabindex="-1"></a>u'(c) = \beta u'(c')\left(f'(k') + (1-\delta)\right).</span>
<span id="cb34-257"><a href="#cb34-257" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb34-258"><a href="#cb34-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-259"><a href="#cb34-259" aria-hidden="true" tabindex="-1"></a>ここで, 政策関数 $c' = h(k')$ と予算制約 $k' = f(k) + (1-\delta)k - c$ を導入すると, 上記のオイラー方程式は以下のように書き換えられます.</span>
<span id="cb34-260"><a href="#cb34-260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-261"><a href="#cb34-261" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb34-262"><a href="#cb34-262" aria-hidden="true" tabindex="-1"></a>u'(c) = \beta u'(h(f(k) + (1-\delta)k - c))\left(f'(f(k) + (1-\delta)k - c) + (1-\delta)\right).</span>
<span id="cb34-263"><a href="#cb34-263" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb34-264"><a href="#cb34-264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-265"><a href="#cb34-265" aria-hidden="true" tabindex="-1"></a>この時, $h(k)$ を所与とした時に $c$ について解くと新しい政策関数 $h(k)$ が得られます. この政策関数繰り返し更新することで, 政策関数の不動点を求めることができます.</span>
<span id="cb34-266"><a href="#cb34-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-267"><a href="#cb34-267" aria-hidden="true" tabindex="-1"></a>::: {.callout-note}</span>
<span id="cb34-268"><a href="#cb34-268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-269"><a href="#cb34-269" aria-hidden="true" tabindex="-1"></a><span class="fu">## Policy Function Iteration</span></span>
<span id="cb34-270"><a href="#cb34-270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-271"><a href="#cb34-271" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>$k$ の定義域を $<span class="co">[</span><span class="ot">k_{\min}, k_{\max}</span><span class="co">]</span>$ を $n$ 個のグリッドポイントに分割する</span>
<span id="cb34-272"><a href="#cb34-272" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>$h(k)$ の初期値 $h^0$ を適当に設定する. つまり, $h^0 = (h_0^0, h_1^0, \dots, h_n^0)$ に適当な値を設定する.</span>
<span id="cb34-273"><a href="#cb34-273" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>$h^0$ をオイラー方程式の右辺に代入し, 各 $k_i$ に対して $h_i^1$ を計算する.</span>
<span id="cb34-274"><a href="#cb34-274" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>2-3を繰り返す. 収束条件は以下のように設定する.</span>
<span id="cb34-275"><a href="#cb34-275" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>$|h^N - h^{N-1}| &lt; \varepsilon$</span>
<span id="cb34-276"><a href="#cb34-276" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>$|h^N - h^{N-1}|$ はベクトルのノルム</span>
<span id="cb34-277"><a href="#cb34-277" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>$\varepsilon$ は十分小さな値を設定する. 例えば, $\epsilon = 10^{-6}$ とする</span>
<span id="cb34-278"><a href="#cb34-278" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb34-279"><a href="#cb34-279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-282"><a href="#cb34-282" aria-hidden="true" tabindex="-1"></a><span class="in">```{julia}</span></span>
<span id="cb34-283"><a href="#cb34-283" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-pfi</span></span>
<span id="cb34-284"><a href="#cb34-284" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: Policy Function Iteration.</span></span>
<span id="cb34-285"><a href="#cb34-285" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">euler_eq</span>(c, k, h; m)</span>
<span id="cb34-286"><a href="#cb34-286" aria-hidden="true" tabindex="-1"></a>    (; β, δ, k_grid) <span class="op">=</span> m</span>
<span id="cb34-287"><a href="#cb34-287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-288"><a href="#cb34-288" aria-hidden="true" tabindex="-1"></a>    k′ <span class="op">=</span> <span class="fu">max</span>(<span class="fu">f</span>(k; m) <span class="op">+</span> (<span class="fl">1</span> <span class="op">-</span> δ) <span class="op">*</span> k <span class="op">-</span> c, k_grid[begin])</span>
<span id="cb34-289"><a href="#cb34-289" aria-hidden="true" tabindex="-1"></a>    h_interp <span class="op">=</span> <span class="fu">linear_interpolation</span>(k_grid, h)</span>
<span id="cb34-290"><a href="#cb34-290" aria-hidden="true" tabindex="-1"></a>    c′ <span class="op">=</span> <span class="fu">h_interp</span>(k′)</span>
<span id="cb34-291"><a href="#cb34-291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-292"><a href="#cb34-292" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fu">u′</span>(c; m) <span class="op">-</span> β <span class="op">*</span> <span class="fu">u′</span>(c′; m) <span class="op">*</span> (<span class="fu">f′</span>(k′; m) <span class="op">+</span> <span class="fl">1</span> <span class="op">-</span> δ)</span>
<span id="cb34-293"><a href="#cb34-293" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb34-294"><a href="#cb34-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-295"><a href="#cb34-295" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">pfi!</span>(m<span class="op">::</span><span class="dt">Model</span>; tol<span class="op">=</span><span class="fl">1e-6</span>, max_iter<span class="op">=</span><span class="fl">1000</span>, verbose<span class="op">=</span><span class="cn">true</span>)</span>
<span id="cb34-296"><a href="#cb34-296" aria-hidden="true" tabindex="-1"></a>    (; k_min, k_max, k_grid, α, β, δ) <span class="op">=</span> m</span>
<span id="cb34-297"><a href="#cb34-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-298"><a href="#cb34-298" aria-hidden="true" tabindex="-1"></a>    h_new <span class="op">=</span> <span class="fu">similar</span>(m.h)</span>
<span id="cb34-299"><a href="#cb34-299" aria-hidden="true" tabindex="-1"></a>    iter, dist <span class="op">=</span> <span class="fl">0</span>, <span class="cn">Inf</span></span>
<span id="cb34-300"><a href="#cb34-300" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> dist <span class="op">&gt;</span> tol <span class="op">&amp;&amp;</span> iter <span class="op">&lt;</span> max_iter</span>
<span id="cb34-301"><a href="#cb34-301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-302"><a href="#cb34-302" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> (i_k, k) <span class="kw">in</span> <span class="fu">enumerate</span>(k_grid)</span>
<span id="cb34-303"><a href="#cb34-303" aria-hidden="true" tabindex="-1"></a>            c_min <span class="op">=</span> <span class="fu">max</span>(<span class="fl">1e-9</span>, <span class="fu">f</span>(k; m) <span class="op">+</span> (<span class="fl">1</span> <span class="op">-</span> δ) <span class="op">*</span> k <span class="op">-</span> k_grid[<span class="kw">end</span>])</span>
<span id="cb34-304"><a href="#cb34-304" aria-hidden="true" tabindex="-1"></a>            c_max <span class="op">=</span> <span class="fu">f</span>(k; m) <span class="op">+</span> (<span class="fl">1</span> <span class="op">-</span> δ) <span class="op">*</span> k <span class="op">-</span> k_grid[begin]</span>
<span id="cb34-305"><a href="#cb34-305" aria-hidden="true" tabindex="-1"></a>            ee_left <span class="op">=</span> <span class="fu">euler_eq</span>(c_min, k, m.h; m)</span>
<span id="cb34-306"><a href="#cb34-306" aria-hidden="true" tabindex="-1"></a>            ee_right <span class="op">=</span> <span class="fu">euler_eq</span>(c_max, k, m.h; m)</span>
<span id="cb34-307"><a href="#cb34-307" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> ee_left <span class="op">&gt;</span> <span class="fl">0</span> <span class="op">&amp;&amp;</span> ee_right <span class="op">&gt;</span> <span class="fl">0</span></span>
<span id="cb34-308"><a href="#cb34-308" aria-hidden="true" tabindex="-1"></a>                h_new[i_k] <span class="op">=</span> c_max</span>
<span id="cb34-309"><a href="#cb34-309" aria-hidden="true" tabindex="-1"></a>            <span class="cf">elseif</span> ee_left <span class="op">&lt;</span> <span class="fl">0</span> <span class="op">&amp;&amp;</span> ee_right <span class="op">&lt;</span> <span class="fl">0</span></span>
<span id="cb34-310"><a href="#cb34-310" aria-hidden="true" tabindex="-1"></a>                h_new[i_k] <span class="op">=</span> c_min</span>
<span id="cb34-311"><a href="#cb34-311" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span></span>
<span id="cb34-312"><a href="#cb34-312" aria-hidden="true" tabindex="-1"></a>                h_new[i_k] <span class="op">=</span> <span class="fu">find_zero</span>(c <span class="op">-&gt;</span> <span class="fu">euler_eq</span>(c, k, m.h; m), (c_min, c_max))</span>
<span id="cb34-313"><a href="#cb34-313" aria-hidden="true" tabindex="-1"></a>            <span class="cf">end</span></span>
<span id="cb34-314"><a href="#cb34-314" aria-hidden="true" tabindex="-1"></a>        <span class="cf">end</span></span>
<span id="cb34-315"><a href="#cb34-315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-316"><a href="#cb34-316" aria-hidden="true" tabindex="-1"></a>        dist <span class="op">=</span> <span class="fu">maximum</span>(abs, h_new <span class="op">.-</span> m.h)</span>
<span id="cb34-317"><a href="#cb34-317" aria-hidden="true" tabindex="-1"></a>        m.h <span class="op">.=</span> h_new</span>
<span id="cb34-318"><a href="#cb34-318" aria-hidden="true" tabindex="-1"></a>        iter <span class="op">+=</span> <span class="fl">1</span></span>
<span id="cb34-319"><a href="#cb34-319" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb34-320"><a href="#cb34-320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-321"><a href="#cb34-321" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> verbose</span>
<span id="cb34-322"><a href="#cb34-322" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> iter <span class="op">==</span> max_iter</span>
<span id="cb34-323"><a href="#cb34-323" aria-hidden="true" tabindex="-1"></a>            <span class="fu">println</span>(<span class="st">"Warning: Maximum iterations reached."</span>)</span>
<span id="cb34-324"><a href="#cb34-324" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span></span>
<span id="cb34-325"><a href="#cb34-325" aria-hidden="true" tabindex="-1"></a>            <span class="fu">println</span>(<span class="st">"Converged in </span><span class="sc">$</span>iter<span class="st"> iterations."</span>)</span>
<span id="cb34-326"><a href="#cb34-326" aria-hidden="true" tabindex="-1"></a>        <span class="cf">end</span></span>
<span id="cb34-327"><a href="#cb34-327" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb34-328"><a href="#cb34-328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-329"><a href="#cb34-329" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="cn">nothing</span></span>
<span id="cb34-330"><a href="#cb34-330" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb34-331"><a href="#cb34-331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-332"><a href="#cb34-332" aria-hidden="true" tabindex="-1"></a>m <span class="op">=</span> <span class="fu">Model</span>()</span>
<span id="cb34-333"><a href="#cb34-333" aria-hidden="true" tabindex="-1"></a><span class="fu">pfi!</span>(m)</span>
<span id="cb34-334"><a href="#cb34-334" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(m.k_grid, m.h, label<span class="op">=</span><span class="cn">false</span>, xlabel<span class="op">=</span>L<span class="st">"Capital </span><span class="sc">$</span>k<span class="sc">$</span><span class="st">", </span>ylabel<span class="st">=L"</span>Policy <span class="op">$</span><span class="fu">h</span>(k)<span class="op">$</span><span class="st">")</span></span>
<span id="cb34-335"><a href="#cb34-335" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb34-336"><a href="#cb34-336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-337"><a href="#cb34-337" aria-hidden="true" tabindex="-1"></a>ここから $k' := g(k) = f(k) + (1-\delta)k - h(k)$ が求められます. さらに, $h(k), g(k)$ から価値関数 $V(k)$ を求める方法は主に2つあります.</span>
<span id="cb34-338"><a href="#cb34-338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-339"><a href="#cb34-339" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>$V(k) \leftarrow u(h(k)) + \beta V(g(k))$ を用いて $V(k)$ の不動点を求める方法 (VFI)</span>
<span id="cb34-340"><a href="#cb34-340" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>線形方程式</span>
<span id="cb34-341"><a href="#cb34-341" aria-hidden="true" tabindex="-1"></a><span class="ss">    1. </span>離散化された $k$ から $k'$ への遷移行列 $P$ を求める. グリッド $k_i$ が $k_j$ と $k_{j+1}$ の間に遷移する場合, 以下のように定義します.</span>
<span id="cb34-342"><a href="#cb34-342" aria-hidden="true" tabindex="-1"></a><span class="ss">        - </span>$P_{i, j} = \frac{k_{j+1} - g(k_i)}{k_{j+1} - k_j}$</span>
<span id="cb34-343"><a href="#cb34-343" aria-hidden="true" tabindex="-1"></a><span class="ss">        - </span>$P_{i, j+1} = \frac{g(k_i) - k_j}{k_{j+1} - k_j}$</span>
<span id="cb34-344"><a href="#cb34-344" aria-hidden="true" tabindex="-1"></a><span class="ss">        - </span>$P_{i, k} = 0$, $k \neq j, j+1$</span>
<span id="cb34-345"><a href="#cb34-345" aria-hidden="true" tabindex="-1"></a><span class="ss">    1. </span>$u, V$ を $u(h(k)), V(k)$ からなる離散化されたベクトルとすると, $V = u + \beta P V$ となる</span>
<span id="cb34-346"><a href="#cb34-346" aria-hidden="true" tabindex="-1"></a><span class="ss">    1. </span>$V = (I - \beta P)^{-1} u$ により $V$ を求めることができる</span>
<span id="cb34-347"><a href="#cb34-347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-348"><a href="#cb34-348" aria-hidden="true" tabindex="-1"></a>ここでは, より高速な線型方程式を用いる方法を実装します. より速度を求める場合, 遷移行列はほとんどの要素がゼロであるため, 疎行列 (Sparse Matrix) を用いることで高速化する可能性があります. Juliaの場合, <span class="in">`SparseArrays.jl`</span> で実装されています.</span>
<span id="cb34-349"><a href="#cb34-349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-352"><a href="#cb34-352" aria-hidden="true" tabindex="-1"></a><span class="in">```{julia}</span></span>
<span id="cb34-353"><a href="#cb34-353" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-pfi-vf</span></span>
<span id="cb34-354"><a href="#cb34-354" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: Value Function from PFI and Linear Equation</span></span>
<span id="cb34-355"><a href="#cb34-355" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">compute_vf!</span>(m<span class="op">::</span><span class="dt">Model</span>)</span>
<span id="cb34-356"><a href="#cb34-356" aria-hidden="true" tabindex="-1"></a>    (; h, n_k, k_grid, h, β, δ) <span class="op">=</span> m</span>
<span id="cb34-357"><a href="#cb34-357" aria-hidden="true" tabindex="-1"></a>    P <span class="op">=</span> <span class="fu">zeros</span>(n_k, n_k)</span>
<span id="cb34-358"><a href="#cb34-358" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i_k, k) <span class="kw">in</span> <span class="fu">enumerate</span>(k_grid)</span>
<span id="cb34-359"><a href="#cb34-359" aria-hidden="true" tabindex="-1"></a>        g <span class="op">=</span> <span class="fu">f</span>(k; m) <span class="op">+</span> (<span class="fl">1</span> <span class="op">-</span> δ) <span class="op">*</span> k <span class="op">-</span> h[i_k]</span>
<span id="cb34-360"><a href="#cb34-360" aria-hidden="true" tabindex="-1"></a>        j <span class="op">=</span> <span class="fu">searchsortedlast</span>(k_grid, g)</span>
<span id="cb34-361"><a href="#cb34-361" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> j <span class="op">==</span> <span class="fl">1</span> <span class="op">||</span> j <span class="op">==</span> n_k</span>
<span id="cb34-362"><a href="#cb34-362" aria-hidden="true" tabindex="-1"></a>            P[i_k, j] <span class="op">=</span> <span class="fl">1.0</span></span>
<span id="cb34-363"><a href="#cb34-363" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span></span>
<span id="cb34-364"><a href="#cb34-364" aria-hidden="true" tabindex="-1"></a>            P[i_k, j] <span class="op">=</span> (k_grid[j<span class="op">+</span><span class="fl">1</span>] <span class="op">-</span> g) <span class="op">/</span> (k_grid[j<span class="op">+</span><span class="fl">1</span>] <span class="op">-</span> k_grid[j])</span>
<span id="cb34-365"><a href="#cb34-365" aria-hidden="true" tabindex="-1"></a>            P[i_k, j<span class="op">+</span><span class="fl">1</span>] <span class="op">=</span> (g <span class="op">-</span> k_grid[j]) <span class="op">/</span> (k_grid[j<span class="op">+</span><span class="fl">1</span>] <span class="op">-</span> k_grid[j])</span>
<span id="cb34-366"><a href="#cb34-366" aria-hidden="true" tabindex="-1"></a>        <span class="cf">end</span></span>
<span id="cb34-367"><a href="#cb34-367" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb34-368"><a href="#cb34-368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-369"><a href="#cb34-369" aria-hidden="true" tabindex="-1"></a>    m.V <span class="op">.=</span> (I <span class="op">-</span> β <span class="op">*</span> P) <span class="op">\</span> (<span class="fu">u</span>.(h; m))</span>
<span id="cb34-370"><a href="#cb34-370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-371"><a href="#cb34-371" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="cn">nothing</span></span>
<span id="cb34-372"><a href="#cb34-372" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb34-373"><a href="#cb34-373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-374"><a href="#cb34-374" aria-hidden="true" tabindex="-1"></a><span class="fu">compute_vf!</span>(m)</span>
<span id="cb34-375"><a href="#cb34-375" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(m.k_grid, m.V, label<span class="op">=</span><span class="cn">false</span>, xlabel<span class="op">=</span>L<span class="st">"Capital </span><span class="sc">$</span>k<span class="sc">$</span><span class="st">", </span>ylabel<span class="st">=L"</span>Value <span class="op">$</span><span class="fu">V</span>(k)<span class="op">$</span><span class="st">")</span></span>
<span id="cb34-376"><a href="#cb34-376" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb34-377"><a href="#cb34-377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-378"><a href="#cb34-378" aria-hidden="true" tabindex="-1"></a>また, VFIよりもPFIの方が収束速度が速いことも確認できますが, 実行速度も速いことも確認できます.</span>
<span id="cb34-379"><a href="#cb34-379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-382"><a href="#cb34-382" aria-hidden="true" tabindex="-1"></a><span class="in">```{julia}</span></span>
<span id="cb34-383"><a href="#cb34-383" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: bm-vfi</span></span>
<span id="cb34-384"><a href="#cb34-384" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">BenchmarkTools</span></span>
<span id="cb34-385"><a href="#cb34-385" aria-hidden="true" tabindex="-1"></a><span class="pp">@benchmark</span> <span class="fu">vfi!</span>(m, verbose<span class="op">=</span><span class="cn">false</span>) setup <span class="op">=</span> (m <span class="op">=</span> <span class="fu">Model</span>())</span>
<span id="cb34-386"><a href="#cb34-386" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb34-387"><a href="#cb34-387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-390"><a href="#cb34-390" aria-hidden="true" tabindex="-1"></a><span class="in">```{julia}</span></span>
<span id="cb34-391"><a href="#cb34-391" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: bm-pfi</span></span>
<span id="cb34-392"><a href="#cb34-392" aria-hidden="true" tabindex="-1"></a><span class="pp">@benchmark</span> (<span class="fu">pfi!</span>(m, verbose<span class="op">=</span><span class="cn">false</span>); <span class="fu">compute_vf!</span>(m)) setup <span class="op">=</span> (m <span class="op">=</span> <span class="fu">Model</span>())</span>
<span id="cb34-393"><a href="#cb34-393" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb34-394"><a href="#cb34-394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-395"><a href="#cb34-395" aria-hidden="true" tabindex="-1"></a><span class="fu">## 確率的動学モデル</span></span>
<span id="cb34-396"><a href="#cb34-396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-397"><a href="#cb34-397" aria-hidden="true" tabindex="-1"></a>この節では確率的な不確実性を導入する. 生産関数 $f(k, z) = z k^\alpha$ とし, 生産性 $z$ が確率的に変化するモデルを考えます. 生産性 $z$ は以下のような AR(1) 過程に従うとします.</span>
<span id="cb34-398"><a href="#cb34-398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-399"><a href="#cb34-399" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb34-400"><a href="#cb34-400" aria-hidden="true" tabindex="-1"></a>\log z' = (1 - \rho) \mu + \rho \log z + \sigma \varepsilon, \quad \varepsilon \sim \mathcal{N}(0, 1).</span>
<span id="cb34-401"><a href="#cb34-401" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb34-402"><a href="#cb34-402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-403"><a href="#cb34-403" aria-hidden="true" tabindex="-1"></a>この時, ベルマン方程式は以下のように書き換えられます.</span>
<span id="cb34-404"><a href="#cb34-404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-405"><a href="#cb34-405" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb34-406"><a href="#cb34-406" aria-hidden="true" tabindex="-1"></a>V(k, z) = \max_{k'} \left<span class="sc">\{</span>u(f(k, z) + (1-\delta)k - k') + \beta \mathbb{E}<span class="co">[</span><span class="ot">V(k', z')| z</span><span class="co">]</span>\right<span class="sc">\}</span>.</span>
<span id="cb34-407"><a href="#cb34-407" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb34-408"><a href="#cb34-408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-409"><a href="#cb34-409" aria-hidden="true" tabindex="-1"></a>この $V(k, z)$ の数値計算するためには, $z$ の状態空間を離散化する必要があります. ここでは, Tauchen Method <span class="co">[</span><span class="ot">@tauchen1986</span><span class="co">]</span> を用いて $z$ の状態空間を離散化します.</span>
<span id="cb34-410"><a href="#cb34-410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-411"><a href="#cb34-411" aria-hidden="true" tabindex="-1"></a><span class="fu">### Tauchen Method</span></span>
<span id="cb34-412"><a href="#cb34-412" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-413"><a href="#cb34-413" aria-hidden="true" tabindex="-1"></a>実数列 $x_t$ が以下のAR(1)過程に従うとします.</span>
<span id="cb34-414"><a href="#cb34-414" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-415"><a href="#cb34-415" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb34-416"><a href="#cb34-416" aria-hidden="true" tabindex="-1"></a>x_{t+1} = (1 - \rho) \mu + \rho x_t + \sigma \varepsilon_{t+1}, \quad \varepsilon_{t+1} \sim \mathcal{N}(0, 1).</span>
<span id="cb34-417"><a href="#cb34-417" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb34-418"><a href="#cb34-418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-419"><a href="#cb34-419" aria-hidden="true" tabindex="-1"></a>これを $n$ 個のグリッドポイント $<span class="sc">\{</span>x_1, \dots, x_n<span class="sc">\}</span>$ におけるマルコフ過程として離散化することを考えます. すなわち, 以下のような遷移確率行列 $\Lambda$ を考えます.</span>
<span id="cb34-420"><a href="#cb34-420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-421"><a href="#cb34-421" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb34-422"><a href="#cb34-422" aria-hidden="true" tabindex="-1"></a>\begin{pmatrix}</span>
<span id="cb34-423"><a href="#cb34-423" aria-hidden="true" tabindex="-1"></a>x_{1, t+1} <span class="sc">\\</span></span>
<span id="cb34-424"><a href="#cb34-424" aria-hidden="true" tabindex="-1"></a>\vdots <span class="sc">\\</span></span>
<span id="cb34-425"><a href="#cb34-425" aria-hidden="true" tabindex="-1"></a>x_{n, t+1}</span>
<span id="cb34-426"><a href="#cb34-426" aria-hidden="true" tabindex="-1"></a>\end{pmatrix} =</span>
<span id="cb34-427"><a href="#cb34-427" aria-hidden="true" tabindex="-1"></a>\begin{pmatrix}</span>
<span id="cb34-428"><a href="#cb34-428" aria-hidden="true" tabindex="-1"></a>\lambda_{1, 1} &amp; \cdots &amp; \lambda_{1, n} <span class="sc">\\</span></span>
<span id="cb34-429"><a href="#cb34-429" aria-hidden="true" tabindex="-1"></a>\vdots &amp; \ddots &amp; \vdots <span class="sc">\\</span></span>
<span id="cb34-430"><a href="#cb34-430" aria-hidden="true" tabindex="-1"></a>\lambda_{n, 1} &amp; \cdots &amp; \lambda_{n, n}</span>
<span id="cb34-431"><a href="#cb34-431" aria-hidden="true" tabindex="-1"></a>\end{pmatrix}</span>
<span id="cb34-432"><a href="#cb34-432" aria-hidden="true" tabindex="-1"></a>\begin{pmatrix}</span>
<span id="cb34-433"><a href="#cb34-433" aria-hidden="true" tabindex="-1"></a>x_{1, t} <span class="sc">\\</span></span>
<span id="cb34-434"><a href="#cb34-434" aria-hidden="true" tabindex="-1"></a>\vdots <span class="sc">\\</span></span>
<span id="cb34-435"><a href="#cb34-435" aria-hidden="true" tabindex="-1"></a>x_{n, t}</span>
<span id="cb34-436"><a href="#cb34-436" aria-hidden="true" tabindex="-1"></a>\end{pmatrix}</span>
<span id="cb34-437"><a href="#cb34-437" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb34-438"><a href="#cb34-438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-439"><a href="#cb34-439" aria-hidden="true" tabindex="-1"></a>ここで, $\lambda_{i, j} = \Pr(x_{t+1} = x_j \mid x_t = x_i)$ であり, $\sum_{j=1}^{n} \lambda_{i, j} = 1$ が成り立ちます.</span>
<span id="cb34-440"><a href="#cb34-440" aria-hidden="true" tabindex="-1"></a>この遷移確率行列を求める方法として, Tauchen Method が知られています.</span>
<span id="cb34-441"><a href="#cb34-441" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-442"><a href="#cb34-442" aria-hidden="true" tabindex="-1"></a>::: {.callout-note}</span>
<span id="cb34-443"><a href="#cb34-443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-444"><a href="#cb34-444" aria-hidden="true" tabindex="-1"></a><span class="fu">## Tauchen Method</span></span>
<span id="cb34-445"><a href="#cb34-445" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-446"><a href="#cb34-446" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>$x$ の定義域 を $<span class="co">[</span><span class="ot">x_{\min}, x_{\max}</span><span class="co">]</span>$ を $n$ 個のグリッドポイントに分割する. 通常は $x$ が従う分布の $3\sigma$ 程度の範囲を考える.</span>
<span id="cb34-447"><a href="#cb34-447" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>グリッドポイント $x_i$ から $x_j$ に遷移する確率を以下のように定義する.</span>
<span id="cb34-448"><a href="#cb34-448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-449"><a href="#cb34-449" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb34-450"><a href="#cb34-450" aria-hidden="true" tabindex="-1"></a>\begin{aligned}</span>
<span id="cb34-451"><a href="#cb34-451" aria-hidden="true" tabindex="-1"></a>\lambda_{i, 1} &amp;= \Phi\left(\frac{x_1 + \frac{d}{2} - (1 - \rho) \mu - \rho x_i}{\sigma}\right) <span class="sc">\\</span></span>
<span id="cb34-452"><a href="#cb34-452" aria-hidden="true" tabindex="-1"></a>\lambda_{i, j} &amp;= \Phi\left(\frac{x_j + \frac{d}{2} - (1 - \rho) \mu - \rho x_i}{\sigma}\right) - \Phi\left(\frac{x_{j} - \frac{d}{2} - (1 - \rho) \mu - \rho x_i}{\sigma}\right) &amp; (2 \leq j \leq n-1) <span class="sc">\\</span></span>
<span id="cb34-453"><a href="#cb34-453" aria-hidden="true" tabindex="-1"></a>\lambda_{i, n} &amp;= 1 - \Phi\left(\frac{x_{n} - \frac{d}{2} - (1 - \rho) \mu - \rho x_i}{\sigma}\right)</span>
<span id="cb34-454"><a href="#cb34-454" aria-hidden="true" tabindex="-1"></a>\end{aligned}</span>
<span id="cb34-455"><a href="#cb34-455" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb34-456"><a href="#cb34-456" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-457"><a href="#cb34-457" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb34-458"><a href="#cb34-458" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-459"><a href="#cb34-459" aria-hidden="true" tabindex="-1"></a><span class="al">![**Visualization of Tauchen Method**. $\mu = 0$.](/static/cetz/tauchen_method.svg)</span>{#fig-tauchen-method width=100%}</span>
<span id="cb34-460"><a href="#cb34-460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-463"><a href="#cb34-463" aria-hidden="true" tabindex="-1"></a><span class="in">```{julia}</span></span>
<span id="cb34-464"><a href="#cb34-464" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tauchen-method</span></span>
<span id="cb34-465"><a href="#cb34-465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-466"><a href="#cb34-466" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">tauchen_method</span>(; n_std<span class="op">=</span><span class="fl">3.0</span>, n<span class="op">=</span><span class="fl">5</span>, ρ<span class="op">=</span><span class="fl">0.9</span>, μ<span class="op">=</span><span class="fl">0.1</span>, σ<span class="op">=</span><span class="fl">1.0</span>)</span>
<span id="cb34-467"><a href="#cb34-467" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-468"><a href="#cb34-468" aria-hidden="true" tabindex="-1"></a>    x_min <span class="op">=</span> μ <span class="op">-</span> n_std <span class="op">*</span> <span class="fu">sqrt</span>(σ<span class="op">^</span><span class="fl">2</span> <span class="op">/</span> (<span class="fl">1</span> <span class="op">-</span> ρ<span class="op">^</span><span class="fl">2</span>))</span>
<span id="cb34-469"><a href="#cb34-469" aria-hidden="true" tabindex="-1"></a>    x_max <span class="op">=</span> μ <span class="op">+</span> n_std <span class="op">*</span> <span class="fu">sqrt</span>(σ<span class="op">^</span><span class="fl">2</span> <span class="op">/</span> (<span class="fl">1</span> <span class="op">-</span> ρ<span class="op">^</span><span class="fl">2</span>))</span>
<span id="cb34-470"><a href="#cb34-470" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> <span class="fu">range</span>(x_min, x_max, length<span class="op">=</span>n)</span>
<span id="cb34-471"><a href="#cb34-471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-472"><a href="#cb34-472" aria-hidden="true" tabindex="-1"></a>    d <span class="op">=</span> (x_max <span class="op">-</span> x_min) <span class="op">/</span> (n <span class="op">-</span> <span class="fl">1</span>)</span>
<span id="cb34-473"><a href="#cb34-473" aria-hidden="true" tabindex="-1"></a>    Λ <span class="op">=</span> <span class="fu">zeros</span>(n, n)</span>
<span id="cb34-474"><a href="#cb34-474" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span>n</span>
<span id="cb34-475"><a href="#cb34-475" aria-hidden="true" tabindex="-1"></a>        Λ[i, <span class="fl">1</span>] <span class="op">=</span> <span class="fu">cdf</span>(<span class="fu">Normal</span>(<span class="fl">0.0</span>, σ), x[<span class="fl">1</span>] <span class="op">+</span> d <span class="op">/</span> <span class="fl">2</span> <span class="op">-</span> (<span class="fl">1</span> <span class="op">-</span> ρ) <span class="op">*</span> μ <span class="op">-</span> ρ <span class="op">*</span> x[i])</span>
<span id="cb34-476"><a href="#cb34-476" aria-hidden="true" tabindex="-1"></a>        Λ[i, n] <span class="op">=</span> <span class="fl">1</span> <span class="op">-</span> <span class="fu">cdf</span>(<span class="fu">Normal</span>(<span class="fl">0.0</span>, σ), x[n] <span class="op">-</span> d <span class="op">/</span> <span class="fl">2</span> <span class="op">-</span> (<span class="fl">1</span> <span class="op">-</span> ρ) <span class="op">*</span> μ <span class="op">-</span> ρ <span class="op">*</span> x[i])</span>
<span id="cb34-477"><a href="#cb34-477" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="fl">2</span><span class="op">:</span>n<span class="op">-</span><span class="fl">1</span></span>
<span id="cb34-478"><a href="#cb34-478" aria-hidden="true" tabindex="-1"></a>            Λ[i, j] <span class="op">=</span> <span class="fu">cdf</span>(<span class="fu">Normal</span>(<span class="fl">0.0</span>, σ), x[j] <span class="op">+</span> d <span class="op">/</span> <span class="fl">2</span> <span class="op">-</span> (<span class="fl">1</span> <span class="op">-</span> ρ) <span class="op">*</span> μ <span class="op">-</span> ρ <span class="op">*</span> x[i]) <span class="op">-</span></span>
<span id="cb34-479"><a href="#cb34-479" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">cdf</span>(<span class="fu">Normal</span>(<span class="fl">0.0</span>, σ), x[j] <span class="op">-</span> d <span class="op">/</span> <span class="fl">2</span> <span class="op">-</span> (<span class="fl">1</span> <span class="op">-</span> ρ) <span class="op">*</span> μ <span class="op">-</span> ρ <span class="op">*</span> x[i])</span>
<span id="cb34-480"><a href="#cb34-480" aria-hidden="true" tabindex="-1"></a>        <span class="cf">end</span></span>
<span id="cb34-481"><a href="#cb34-481" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb34-482"><a href="#cb34-482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-483"><a href="#cb34-483" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> x, Λ</span>
<span id="cb34-484"><a href="#cb34-484" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb34-485"><a href="#cb34-485" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-486"><a href="#cb34-486" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-487"><a href="#cb34-487" aria-hidden="true" tabindex="-1"></a>x, Λ <span class="op">=</span> <span class="fu">tauchen_method</span>()</span>
<span id="cb34-488"><a href="#cb34-488" aria-hidden="true" tabindex="-1"></a><span class="pp">@show</span> x</span>
<span id="cb34-489"><a href="#cb34-489" aria-hidden="true" tabindex="-1"></a>Λ</span>
<span id="cb34-490"><a href="#cb34-490" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb34-491"><a href="#cb34-491" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-492"><a href="#cb34-492" aria-hidden="true" tabindex="-1"></a>実用上は <span class="in">`QuantEcon.jl`</span> の <span class="in">`tauchen`</span> 関数を利用するのがいいでしょう.</span>
<span id="cb34-493"><a href="#cb34-493" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-496"><a href="#cb34-496" aria-hidden="true" tabindex="-1"></a><span class="in">```{julia}</span></span>
<span id="cb34-497"><a href="#cb34-497" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">QuantEcon</span></span>
<span id="cb34-498"><a href="#cb34-498" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-499"><a href="#cb34-499" aria-hidden="true" tabindex="-1"></a>mc <span class="op">=</span> <span class="fu">tauchen</span>(<span class="fl">5</span>, <span class="fl">0.9</span>, <span class="fl">1.0</span>, <span class="fl">0.1</span>) <span class="co"># tauchen(N, ρ, σ, μ)</span></span>
<span id="cb34-500"><a href="#cb34-500" aria-hidden="true" tabindex="-1"></a><span class="pp">@show</span> mc.state_values</span>
<span id="cb34-501"><a href="#cb34-501" aria-hidden="true" tabindex="-1"></a>mc.p</span>
<span id="cb34-502"><a href="#cb34-502" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb34-503"><a href="#cb34-503" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-504"><a href="#cb34-504" aria-hidden="true" tabindex="-1"></a>ただし, ここでは AR(1) process が以下のように定義されていることに注意してください.</span>
<span id="cb34-505"><a href="#cb34-505" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-506"><a href="#cb34-506" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb34-507"><a href="#cb34-507" aria-hidden="true" tabindex="-1"></a>y_{t+1} = \mu + \rho y_{t} + \varepsilon_{t+1}, \quad \varepsilon_{t+1} \sim \mathcal{N}(0, \sigma^2).</span>
<span id="cb34-508"><a href="#cb34-508" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb34-509"><a href="#cb34-509" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-510"><a href="#cb34-510" aria-hidden="true" tabindex="-1"></a>そのため, $\mathbb{E}<span class="co">[</span><span class="ot">y_{t}</span><span class="co">]</span> = \frac{\mu}{1-\rho}$ となります.</span>
<span id="cb34-511"><a href="#cb34-511" aria-hidden="true" tabindex="-1"></a>上の例では, $\mu = 0.1$, $\rho = 0.9$, $\sigma = 1.0$ としているため, $\mathbb{E}<span class="co">[</span><span class="ot">y_{t}</span><span class="co">]</span> = 1.0$ となります.</span>
<span id="cb34-512"><a href="#cb34-512" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-515"><a href="#cb34-515" aria-hidden="true" tabindex="-1"></a><span class="in">```{julia}</span></span>
<span id="cb34-516"><a href="#cb34-516" aria-hidden="true" tabindex="-1"></a>ps <span class="op">=</span> <span class="fu">vcat</span>(<span class="fu">stationary_distributions</span>(mc)<span class="op">...</span>)</span>
<span id="cb34-517"><a href="#cb34-517" aria-hidden="true" tabindex="-1"></a>ps<span class="op">'</span> <span class="op">*</span> <span class="fu">collect</span>(mc.state_values)</span>
<span id="cb34-518"><a href="#cb34-518" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb34-519"><a href="#cb34-519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-520"><a href="#cb34-520" aria-hidden="true" tabindex="-1"></a>AR(1) processの期待値を任意の値 $\tilde{\mu}$ に設定するためには, $\mu = (1-\rho)\tilde{\mu}$ とすればよいです.</span>
<span id="cb34-521"><a href="#cb34-521" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-524"><a href="#cb34-524" aria-hidden="true" tabindex="-1"></a><span class="in">```{julia}</span></span>
<span id="cb34-525"><a href="#cb34-525" aria-hidden="true" tabindex="-1"></a>mc <span class="op">=</span> <span class="fu">tauchen</span>(<span class="fl">5</span>, <span class="fl">0.9</span>, <span class="fl">1.0</span>, <span class="fl">0.01</span>)</span>
<span id="cb34-526"><a href="#cb34-526" aria-hidden="true" tabindex="-1"></a><span class="pp">@show</span> mc.state_values</span>
<span id="cb34-527"><a href="#cb34-527" aria-hidden="true" tabindex="-1"></a>mc.p</span>
<span id="cb34-528"><a href="#cb34-528" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb34-529"><a href="#cb34-529" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-530"><a href="#cb34-530" aria-hidden="true" tabindex="-1"></a><span class="fu">### Value Function Iteration</span></span>
<span id="cb34-531"><a href="#cb34-531" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-532"><a href="#cb34-532" aria-hidden="true" tabindex="-1"></a>AR(1) process を $\Lambda$ で離散化した後のベルマン方程式は以下のようになります.</span>
<span id="cb34-533"><a href="#cb34-533" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-534"><a href="#cb34-534" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb34-535"><a href="#cb34-535" aria-hidden="true" tabindex="-1"></a>V(k, z) = \max_{k'} \left<span class="sc">\{</span>u(f(k, z) + (1-\delta)k - k') + \beta \sum_{z'} \Lambda(z, z') V(k', z')\right<span class="sc">\}</span>.</span>
<span id="cb34-536"><a href="#cb34-536" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb34-537"><a href="#cb34-537" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-538"><a href="#cb34-538" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">VFIを用いる場合, 実装は価値関数 $V$ の次元を $z$ のために1つ増やし, ベルマン方程式の通り実装するだけです.</span><span class="co">]</span>{.noindent}</span>
<span id="cb34-539"><a href="#cb34-539" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-540"><a href="#cb34-540" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-543"><a href="#cb34-543" aria-hidden="true" tabindex="-1"></a><span class="in">```{julia}</span></span>
<span id="cb34-544"><a href="#cb34-544" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-model-stochastic</span></span>
<span id="cb34-545"><a href="#cb34-545" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: Value Function of Stochastic Model.</span></span>
<span id="cb34-546"><a href="#cb34-546" aria-hidden="true" tabindex="-1"></a><span class="pp">@kwdef</span> <span class="kw">struct</span> StochasticModel{TF<span class="op">&lt;:</span><span class="dt">AbstractFloat</span>,TI<span class="op">&lt;:</span><span class="dt">Integer</span>}</span>
<span id="cb34-547"><a href="#cb34-547" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Parameters</span></span>
<span id="cb34-548"><a href="#cb34-548" aria-hidden="true" tabindex="-1"></a>    α<span class="op">::</span><span class="dt">TF </span><span class="op">=</span> <span class="fl">0.4</span></span>
<span id="cb34-549"><a href="#cb34-549" aria-hidden="true" tabindex="-1"></a>    β<span class="op">::</span><span class="dt">TF </span><span class="op">=</span> <span class="fl">0.96</span></span>
<span id="cb34-550"><a href="#cb34-550" aria-hidden="true" tabindex="-1"></a>    δ<span class="op">::</span><span class="dt">TF </span><span class="op">=</span> <span class="fl">0.1</span></span>
<span id="cb34-551"><a href="#cb34-551" aria-hidden="true" tabindex="-1"></a>    <span class="co"># AR(1) process</span></span>
<span id="cb34-552"><a href="#cb34-552" aria-hidden="true" tabindex="-1"></a>    ρ<span class="op">::</span><span class="dt">TF </span><span class="op">=</span> <span class="fl">0.6</span></span>
<span id="cb34-553"><a href="#cb34-553" aria-hidden="true" tabindex="-1"></a>    μ<span class="op">::</span><span class="dt">TF </span><span class="op">=</span> <span class="fl">0.0</span></span>
<span id="cb34-554"><a href="#cb34-554" aria-hidden="true" tabindex="-1"></a>    σ<span class="op">::</span><span class="dt">TF </span><span class="op">=</span> <span class="fl">0.4</span></span>
<span id="cb34-555"><a href="#cb34-555" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-556"><a href="#cb34-556" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Value Function</span></span>
<span id="cb34-557"><a href="#cb34-557" aria-hidden="true" tabindex="-1"></a>    n_k<span class="op">::</span><span class="dt">TI </span><span class="op">=</span> <span class="fl">101</span></span>
<span id="cb34-558"><a href="#cb34-558" aria-hidden="true" tabindex="-1"></a>    n_z<span class="op">::</span><span class="dt">TI </span><span class="op">=</span> <span class="fl">5</span></span>
<span id="cb34-559"><a href="#cb34-559" aria-hidden="true" tabindex="-1"></a>    k_min<span class="op">::</span><span class="dt">TF </span><span class="op">=</span> <span class="fl">0.05</span></span>
<span id="cb34-560"><a href="#cb34-560" aria-hidden="true" tabindex="-1"></a>    k_max<span class="op">::</span><span class="dt">TF </span><span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb34-561"><a href="#cb34-561" aria-hidden="true" tabindex="-1"></a>    k_grid<span class="op">::</span><span class="dt">Vector{TF} </span><span class="op">=</span> <span class="fu">collect</span>(<span class="fu">range</span>(k_min, k_max, length<span class="op">=</span>n_k))</span>
<span id="cb34-562"><a href="#cb34-562" aria-hidden="true" tabindex="-1"></a>    mc<span class="op">::</span><span class="dt">MarkovChain </span><span class="op">=</span> <span class="fu">tauchen</span>(n_z, ρ, σ, μ)</span>
<span id="cb34-563"><a href="#cb34-563" aria-hidden="true" tabindex="-1"></a>    z_grid<span class="op">::</span><span class="dt">Vector{TF} </span><span class="op">=</span> <span class="fu">collect</span>(<span class="fu">exp</span>.(mc.state_values))</span>
<span id="cb34-564"><a href="#cb34-564" aria-hidden="true" tabindex="-1"></a>    Λ<span class="op">::</span><span class="dt">Matrix{TF} </span><span class="op">=</span> mc.p</span>
<span id="cb34-565"><a href="#cb34-565" aria-hidden="true" tabindex="-1"></a>    V<span class="op">::</span><span class="dt">Matrix{TF} </span><span class="op">=</span> <span class="fu">zeros</span>(n_k, n_z)</span>
<span id="cb34-566"><a href="#cb34-566" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb34-567"><a href="#cb34-567" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-568"><a href="#cb34-568" aria-hidden="true" tabindex="-1"></a><span class="fu">f</span>(k, z; m) <span class="op">=</span> z <span class="op">*</span> k<span class="op">^</span>m.α</span>
<span id="cb34-569"><a href="#cb34-569" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">vfi!</span>(m<span class="op">::</span><span class="dt">StochasticModel</span>; tol<span class="op">=</span><span class="fl">1e-6</span>, max_iter<span class="op">=</span><span class="fl">1000</span>)</span>
<span id="cb34-570"><a href="#cb34-570" aria-hidden="true" tabindex="-1"></a>    (; k_grid, z_grid, β, δ, Λ) <span class="op">=</span> m</span>
<span id="cb34-571"><a href="#cb34-571" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-572"><a href="#cb34-572" aria-hidden="true" tabindex="-1"></a>    iter, dist <span class="op">=</span> <span class="fl">0</span>, <span class="cn">Inf</span></span>
<span id="cb34-573"><a href="#cb34-573" aria-hidden="true" tabindex="-1"></a>    V_new <span class="op">=</span> <span class="fu">similar</span>(m.V)</span>
<span id="cb34-574"><a href="#cb34-574" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> dist <span class="op">&gt;</span> tol <span class="op">&amp;&amp;</span> iter <span class="op">&lt;</span> max_iter</span>
<span id="cb34-575"><a href="#cb34-575" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> (i_z, z) <span class="kw">in</span> <span class="fu">enumerate</span>(z_grid), (i_k, k) <span class="kw">in</span> <span class="fu">enumerate</span>(k_grid)</span>
<span id="cb34-576"><a href="#cb34-576" aria-hidden="true" tabindex="-1"></a>            c_min <span class="op">=</span> <span class="fl">1e-9</span> <span class="co"># consumption cannot be negative</span></span>
<span id="cb34-577"><a href="#cb34-577" aria-hidden="true" tabindex="-1"></a>            V_new[i_k, i_z] <span class="op">=</span> <span class="fu">maximum</span>(</span>
<span id="cb34-578"><a href="#cb34-578" aria-hidden="true" tabindex="-1"></a>                <span class="fu">log</span>(<span class="fu">max</span>(<span class="fu">f</span>(k, z; m) <span class="op">+</span> (<span class="fl">1</span> <span class="op">-</span> δ) <span class="op">*</span> k <span class="op">-</span> k′, c_min)) <span class="op">+</span></span>
<span id="cb34-579"><a href="#cb34-579" aria-hidden="true" tabindex="-1"></a>                β <span class="op">*</span> <span class="fu">sum</span>(Λ[i_z, i_z′] <span class="op">*</span> m.V[i_k′, i_z′]</span>
<span id="cb34-580"><a href="#cb34-580" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">for</span> (i_z′, z′) <span class="kw">in</span> <span class="fu">enumerate</span>(z_grid))</span>
<span id="cb34-581"><a href="#cb34-581" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> (i_k′, k′) <span class="kw">in</span> <span class="fu">enumerate</span>(k_grid)</span>
<span id="cb34-582"><a href="#cb34-582" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb34-583"><a href="#cb34-583" aria-hidden="true" tabindex="-1"></a>        <span class="cf">end</span></span>
<span id="cb34-584"><a href="#cb34-584" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-585"><a href="#cb34-585" aria-hidden="true" tabindex="-1"></a>        dist <span class="op">=</span> <span class="fu">maximum</span>(abs, V_new <span class="op">.-</span> m.V)</span>
<span id="cb34-586"><a href="#cb34-586" aria-hidden="true" tabindex="-1"></a>        m.V <span class="op">.=</span> V_new</span>
<span id="cb34-587"><a href="#cb34-587" aria-hidden="true" tabindex="-1"></a>        iter <span class="op">+=</span> <span class="fl">1</span></span>
<span id="cb34-588"><a href="#cb34-588" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb34-589"><a href="#cb34-589" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-590"><a href="#cb34-590" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> iter <span class="op">==</span> max_iter</span>
<span id="cb34-591"><a href="#cb34-591" aria-hidden="true" tabindex="-1"></a>        <span class="fu">println</span>(<span class="st">"Warning: Maximum iterations reached."</span>)</span>
<span id="cb34-592"><a href="#cb34-592" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span></span>
<span id="cb34-593"><a href="#cb34-593" aria-hidden="true" tabindex="-1"></a>        <span class="fu">println</span>(<span class="st">"Converged in </span><span class="sc">$</span>iter<span class="st"> iterations."</span>)</span>
<span id="cb34-594"><a href="#cb34-594" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb34-595"><a href="#cb34-595" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-596"><a href="#cb34-596" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="cn">nothing</span></span>
<span id="cb34-597"><a href="#cb34-597" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb34-598"><a href="#cb34-598" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-599"><a href="#cb34-599" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-600"><a href="#cb34-600" aria-hidden="true" tabindex="-1"></a>m <span class="op">=</span> <span class="fu">StochasticModel</span>()</span>
<span id="cb34-601"><a href="#cb34-601" aria-hidden="true" tabindex="-1"></a><span class="fu">vfi!</span>(m)</span>
<span id="cb34-602"><a href="#cb34-602" aria-hidden="true" tabindex="-1"></a>p <span class="op">=</span> <span class="fu">plot</span>(m.k_grid, m.V[<span class="op">:</span>, <span class="fl">5</span>], label<span class="op">=</span>L<span class="st">"z_5"</span>, xlabel<span class="op">=</span>L<span class="st">"Capital </span><span class="sc">$</span>k<span class="sc">$</span><span class="st">", </span>ylabel<span class="st">=L"</span>Value <span class="op">$</span><span class="fu">V</span>(k, z)<span class="op">$</span><span class="st">")</span></span>
<span id="cb34-603"><a href="#cb34-603" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="fl">4</span><span class="op">:-</span><span class="fl">1</span><span class="op">:</span><span class="fl">1</span></span>
<span id="cb34-604"><a href="#cb34-604" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot!</span>(m.k_grid, m.V[<span class="op">:</span>, i], label<span class="op">=</span>L<span class="st">"z_%</span><span class="sc">$</span>i<span class="st">"</span>)</span>
<span id="cb34-605"><a href="#cb34-605" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb34-606"><a href="#cb34-606" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-607"><a href="#cb34-607" aria-hidden="true" tabindex="-1"></a>p</span>
<span id="cb34-608"><a href="#cb34-608" aria-hidden="true" tabindex="-1"></a><span class="ss">```</span></span>
<span id="cb34-609"><a href="#cb34-609" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-610"><a href="#cb34-610" aria-hidden="true" tabindex="-1"></a><span class="ss">:::{refs}</span></span>
<span id="cb34-611"><a href="#cb34-611" aria-hidden="true" tabindex="-1"></a><span class="ss">:::</span></span>
</code></pre></div><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>